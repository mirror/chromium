{
  "comments": [
    {
      "key": {
        "uuid": "98fec1a9_9bd14164",
        "filename": "ui/base/clipboard/clipboard_util_win.cc",
        "patchSetId": 1
      },
      "lineNbr": 460,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-10T00:34:12Z",
      "side": 1,
      "message": "How about using constexpr StringPiece?",
      "revId": "e333c00b7eac4033d6b298506cdcf3adb5f216df",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ca548e8_87f60727",
        "filename": "ui/base/clipboard/clipboard_util_win.cc",
        "patchSetId": 1
      },
      "lineNbr": 460,
      "author": {
        "id": 1128439
      },
      "writtenOn": "2017-10-10T04:38:32Z",
      "side": 1,
      "message": "Fair question. There isn\u0027t a constexpr StringPiece yet but the variable could just be a normal local, so that\u0027s not a real obstacle (and constexpr StringPiece will probably land tomorrow).\n\nUsing StringPiece makes the length() call simpler but seems to make the cf_html.find() call less elegant - the best I could find is cf_html.find(src_url_str.data()), which just seems ugly in a different way.\n\nI\u0027m torn.",
      "parentUuid": "98fec1a9_9bd14164",
      "revId": "e333c00b7eac4033d6b298506cdcf3adb5f216df",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e4fff8d6_4155fb94",
        "filename": "ui/base/clipboard/clipboard_util_win.cc",
        "patchSetId": 1
      },
      "lineNbr": 460,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-10T07:05:25Z",
      "side": 1,
      "message": "StringPiece(cf_html).find(src_url_str) would work as well, right? It\u0027s not quite as concise, but it will become unnecessary in C++17 as well. I think it\u0027s worth experimenting to see if we can get it to work: I\u0027m not fond of arraysize(src_url_str) - 1.",
      "parentUuid": "6ca548e8_87f60727",
      "revId": "e333c00b7eac4033d6b298506cdcf3adb5f216df",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36839e3c_2b6f3dca",
        "filename": "ui/base/clipboard/clipboard_util_win.cc",
        "patchSetId": 1
      },
      "lineNbr": 460,
      "author": {
        "id": 1128439
      },
      "writtenOn": "2017-10-10T17:14:57Z",
      "side": 1,
      "message": "I share your lack of fondness for arraysize(src_url_str) - 1 (although it\u0027s better than the sizeof(src_url_str) - 1 I started with).\n\nI\u0027m going to wait for the constexpr StringPiece change to land before updating the patch, but quick tests show that these two variants work nicely. The .data() one is \"discouraged\" because it assumes that the string is null-terminated - but we know that it is so I\u0027m inclined to prefer it.\n\n    const base::StringPiece src_url_str(\"SourceURL:\");\n    size_t line_start \u003d cf_html.find(src_url_str.data());\n\n    const base::StringPiece src_url_str(\"SourceURL:\");\n    size_t line_start \u003d base::StringPiece(cf_html).find(src_url_str);",
      "parentUuid": "e4fff8d6_4155fb94",
      "revId": "e333c00b7eac4033d6b298506cdcf3adb5f216df",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}