{
  "comments": [
    {
      "key": {
        "uuid": "18cf030e_2c16aea2",
        "filename": "content/browser/gpu/gpu_client.cc",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-11-29T14:52:11Z",
      "side": 1,
      "message": "You are getting a WeakPtr on the UI thread here, and posting a task on the IO thread. This would not work (WeakPtr cannot be checked/validated only on the thread it\u0027s created on).",
      "revId": "b7ada056d91a800e98facb98d55718da83117025",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a272a00_e82619f3",
        "filename": "content/browser/gpu/gpu_client.cc",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1003154
      },
      "writtenOn": "2017-11-29T17:34:29Z",
      "side": 1,
      "message": "This is fine because We create the GpuClient in RenderProcessHostImpl constructor, and destroys it in RenderProcessHostImpl destructor by posting a task to IO thread. So it\u0027s guaranteed the weak pointer is valid.",
      "parentUuid": "18cf030e_2c16aea2",
      "revId": "b7ada056d91a800e98facb98d55718da83117025",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e32ed5fb_a7e5ce19",
        "filename": "content/browser/gpu/gpu_client.cc",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1148065
      },
      "writtenOn": "2017-11-29T18:24:22Z",
      "side": 1,
      "message": "Correct, the use case is valid (the condition is that the WeakPtr must be dereferenced/checked on the same thread as where the factory is invalidated/destroyed, in this case the IO thread for both).\n\nThat said it is true that the WeakPtr is technically not needed, so we could Unretained(this) instead. We can add a DCHECK_CURRENTLY_ON(BrowserThread::IO) in the destructor to help clarifying lifetime/threading.",
      "parentUuid": "2a272a00_e82619f3",
      "revId": "b7ada056d91a800e98facb98d55718da83117025",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c8a7cd5_d005ee5d",
        "filename": "content/browser/gpu/gpu_client.cc",
        "patchSetId": 9
      },
      "lineNbr": 47,
      "author": {
        "id": 1003154
      },
      "writtenOn": "2017-11-29T19:24:53Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e32ed5fb_a7e5ce19",
      "revId": "b7ada056d91a800e98facb98d55718da83117025",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}