<!DOCTYPE html>
<div id="container" style="position: relative;"></div>
<script>

function configureUAShadowRoot(shadow) {
  const slot = shadow.querySelector('slot');
  const div = document.createElement('div');
  div.style = 'position: relative;';
  div.appendChild(slot);
  shadow.appendChild(div);
  shadow.positionedElement = shadow.querySelector('#x');
}

var container = document.querySelector('#container');

// Test that when the offsetParent is in user agent Shadow DOM, it is
// not exposed to script, but its shadow host or the host's ancestor
// which is appropriate as an offsetParent is returned.
host = document.createElement('summary');
container.appendChild(host);
host.setAttribute('open', 'open');
host.appendChild(child);
var shadow = window.internals.youngestShadowRoot(host);  // this is a UA shadow root
configureUAShadowRoot(shadow);
shouldBe('child.offsetParent', 'container');

// Test that offsetParent works 'through' user agent Shadow DOM when there is no
// positioned ancestor in user agent Shadow DOM
shadow.positionedElement.removeAttribute('style');
shouldBe('child.offsetParent', 'container');

container.remove();

successfullyParsed = true;
</script>
