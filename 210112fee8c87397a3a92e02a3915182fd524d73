{
  "comments": [
    {
      "key": {
        "uuid": "2a7ee0dd_1b64f835",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.cc",
        "patchSetId": 5
      },
      "lineNbr": 198,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-11-20T19:10:08Z",
      "side": 1,
      "message": "What I dislike about this approach is that it assumes that an XEventDispatcher would be associated with a ui::PlatformEventDispatcher, which happens to be the case for the specific issue, but is implicit in the API. Can we make it more explicit? e.g. there could be an XEventDispatcher::GetPlatformEventDispatcher() method, which we would automatically add as a platform-event dispatcher in AddXEventDispatcher(). That way, there\u0027s a more explicit/direct association between the two.",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b318b1fc_94811cd3",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.cc",
        "patchSetId": 5
      },
      "lineNbr": 198,
      "author": {
        "id": 1228974
      },
      "writtenOn": "2017-11-22T12:12:36Z",
      "side": 1,
      "message": "Actually, it would mean dispatchers are added twice.\nhttps://cs.chromium.org/chromium/src/ui/platform_window/x11/x11_window_ozone.cc?sq\u003dpackage:chromium\u0026l\u003d26\n\nAn additional step of checking if a dispatcher is already in the list will be needed. Wouldn\u0027t it be more confusing then? The main idea of the current implementation is that XEventDispatcher can be also a PlatformEventDispatcher. If it is not like that, we don\u0027t care.",
      "parentUuid": "2a7ee0dd_1b64f835",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "496875d4_80532871",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.cc",
        "patchSetId": 5
      },
      "lineNbr": 198,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-11-22T15:53:18Z",
      "side": 1,
      "message": "Right. My point was, you shouldn\u0027t need to explicitly add the PED from there.",
      "parentUuid": "b318b1fc_94811cd3",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e0efe660_a5e69a14",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.cc",
        "patchSetId": 5
      },
      "lineNbr": 198,
      "author": {
        "id": 1146978
      },
      "writtenOn": "2017-11-22T16:23:41Z",
      "side": 1,
      "message": "Gotcha, you can get rid of the call to add \"event_source-\u003eAddPlatformEventDispatcher(this);\" which makes things more clear.",
      "parentUuid": "496875d4_80532871",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edf19b41_24e34ee6",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.cc",
        "patchSetId": 5
      },
      "lineNbr": 198,
      "author": {
        "id": 1228974
      },
      "writtenOn": "2017-11-22T16:25:25Z",
      "side": 1,
      "message": "Ok. Got it. Will do it as you proposed.",
      "parentUuid": "e0efe660_a5e69a14",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57576068_3c8a4eca",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.h",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-11-20T19:10:08Z",
      "side": 1,
      "message": "How about WillDispatchXEvent() and DidDispatchXEvent()?",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e3e0969c_3acba747",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.h",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1228974
      },
      "writtenOn": "2017-11-22T12:12:36Z",
      "side": 1,
      "message": "But it\u0027s not actually an XEvent. It\u0027s a translated event based on the XEvent.",
      "parentUuid": "57576068_3c8a4eca",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d9eee262_90bcb895",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.h",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-11-22T15:53:18Z",
      "side": 1,
      "message": "Oh? Why is the input an XEvent, in that case?",
      "parentUuid": "e3e0969c_3acba747",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c80b1110_2ba062cd",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.h",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1146978
      },
      "writtenOn": "2017-11-22T16:23:41Z",
      "side": 1,
      "message": "It\u0027s more like CheckCanDispatchNextPlatformEventThatWasTranslatedFromXEvent(XEvent*) but that\u0027s a bit of a mouthful. :)",
      "parentUuid": "d9eee262_90bcb895",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f12a206b_ee8fcbc0",
        "filename": "ui/events/platform/x11/x11_event_source_libevent.h",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1228974
      },
      "writtenOn": "2017-11-22T16:25:25Z",
      "side": 1,
      "message": "This method is needed because PlatformEventDispatcher::CanDispatch can\u0027t say for sure if it can send an event or not. The translated event (ui::Event) just doesn\u0027t contain a native xevent, which has XID target. That XID target must be used to identify where the event must go to.\n\nThat\u0027s why XEvent is sent here.\n\n1)Send xevent to XEventDispatchers, which can be PlatformEventDispatchers as well.\n2)XEventDispatchers check if XEventDispatcher::XID \u003d\u003d XEvent::XID.\n3) If so, XEventDispatchers, which can also be PlatformEventDispatchers, set a flag, which\nis used by PlatformEventDispatchers::CanDispatch and receive an event, which is for that dispatcher.",
      "parentUuid": "d9eee262_90bcb895",
      "revId": "210112fee8c87397a3a92e02a3915182fd524d73",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}