{
  "comments": [
    {
      "key": {
        "uuid": "346519f6_95a326d2",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 52,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Check that |dest| has an expected number of frames?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c0f052ec_97f11763",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 52,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "I merged this class with TestSourceLaggy as it wasn\u0027t used directly. Most tests use SineWaveAudioSource which would be the right place to add these checks. Maybe in a separate CL?",
      "parentUuid": "346519f6_95a326d2",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2dde468b_5639b1d2",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 52,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "I\u0027m not sure  SineWaveAudioSource is the right place, since simple source classes are not advertised or built as \"for tests only\" (though they seem to be used exclusively for tests now).\nSo I would do the opposite: cleanup SineWaveAudioSource to hide\nvoid CapSamples(int cap);\nvoid Reset();\nint callbacks();\nint errors();\nfrom the interface: they are used for SinceWaveAudioSource unittests only; and I would have a helper TestSource class which aggregates SineWaveAudioSource and does all the calculations.\nExposing the four methods above is also dangerous because they are not thread-safe.",
      "parentUuid": "c0f052ec_97f11763",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d85138c_b93eaf7a",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 52,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T18:18:39Z",
      "side": 1,
      "message": "IMO there is no reason any production code should need SineWaveAudioSource, it should be test-only code.",
      "parentUuid": "2dde468b_5639b1d2",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1542027e_bfec4ad5",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 52,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-11T12:27:15Z",
      "side": 1,
      "message": "Simple sources produce sounds, and if some verification of how callbacks are called is required - it\u0027s a different problem to be handled in a different class, for the sake of separation of concerns.",
      "parentUuid": "6d85138c_b93eaf7a",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58be7876_ddac18b7",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 59,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Both OnMoreData() and OnError() are called on audio device thread, wheres callback_count() and had_error() are called on the main thread, so it\u0027s a data race. Use atomics?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c02db42b_95a0ce9a",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 59,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Updated the tests to call these functions only after Stop(), so there is no race.",
      "parentUuid": "58be7876_ddac18b7",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4992df2b_180be762",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 59,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Could you add a comment that they should be called after Stop() only?",
      "parentUuid": "c02db42b_95a0ce9a",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0751a7ef_7bd798f2",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "const",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26509838_1deff6c5",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 87,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0751a7ef_7bd798f2",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "27e742e8_8421e6c2",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 132,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Great that you added this, surprising that we have not had one.\nLooks like it belongs to audio_manager_unittest.cc? (Up to you though, that file is scary)",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db3d4162_cbafad82",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 132,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Yeah, I\u0027d prefer to avoid adding more tests audio_manager_unittest.cc - that file is a mess. This test verifies that we can create system-specific AudioOutputStream with various parameters, so I think this file is good place to put it. Also it\u0027s where it lives on Windows (see media/audio/win/audio_output_win_unittest.cc)",
      "parentUuid": "27e742e8_8421e6c2",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2aad9923_3c009b65",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 132,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "db3d4162_cbafad82",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d7636f1_45299f88",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 136,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Would be good to add a case for default-created AudioParams as well.",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "889848e6_86efe2e5",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 136,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Many other tests already do that, so I don\u0027t think we need it here.",
      "parentUuid": "7d7636f1_45299f88",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b803e663_82fc2a4c",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 136,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Not sure what \"many other tests\" you mean. Default-created AudioParameters are quite common to be passed around and can end up in MakeAudioOutputStream() if upper layers missed a check.\nSince these unit tests are for both current and future implementations of AudioOutputStream, we want to make sure this case is covered.",
      "parentUuid": "889848e6_86efe2e5",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "add0e7f8_bad9bb38",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 139,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Close a stream in case expectation fails? Otherwise the system is left in a funny state.",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "721496cb_6ede78bb",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 139,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "I don\u0027t think we can really guarantee that failed tests leave the process in a clean state, so I don\u0027t think it\u0027s worth to worry about here. Also checking it would make the test code much more complicated, which we want to avoid.\n\nIMO the right thing to do would be to update MakeAudioOutputStream() to return unique_ptr\u003c\u003e. That would require updating AudioOutputStream to remove Close() method and allow the owner to simply delete the thing.",
      "parentUuid": "add0e7f8_bad9bb38",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dd0f132e_4b0e77c3",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 139,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Right, we have crbug/768515 for that.",
      "parentUuid": "721496cb_6ede78bb",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d0f1828b_49f079a7",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 140,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Would be good to add a comment on why each case is insane.",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f47f4a4b_dd7e25b6",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 140,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Done. IMO, some of these should really be replaced with (D)CHECKs in AudioParameters (e.g. for negative period size).",
      "parentUuid": "d0f1828b_49f079a7",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3f63379c_ae1e2499",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 140,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Thanks! Things like that should be covered in AudioParameters::IsValid() - feel free to add whatever you feel is missing (in a separate CL :) )\nhttps://cs.chromium.org/chromium/src/media/base/audio_parameters.cc?type\u003dcs\u0026sq\u003dpackage:chromium\u0026l\u003d91",
      "parentUuid": "f47f4a4b_dd7e25b6",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c116a9d_d2e9e973",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 184,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "(again, looks like a part of AudioManager testing)\nCould you add a comment on why do we test it?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "747a3a99_04497953",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 184,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Same as above. This test tests creation of system-specific audio output stream. It has to call audio manager because that\u0027s the right way to create output streams.",
      "parentUuid": "8c116a9d_d2e9e973",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bca159bd_9d521d60",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 189,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Could you add a comment on why the numbers are chosen this way? Do you want to pass max int into it? Use numeric_limits\u003cint\u003e then?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "399dc0c2_5c585ab6",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 189,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "I have no idea how this number was chosen. This logic was copied from WinAudioTest.PCMWaveStreamOpenLimit. Removed this check, since we have similar one in SanityOnMakeParams",
      "parentUuid": "bca159bd_9d521d60",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cb6f6b8e_683c4ff2",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 189,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "399dc0c2_5c585ab6",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "109fdc05_9875badd",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 196,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Could you elaborate on how this potential deadlock situation looks like?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "624c0858_64f868b8",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 196,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "This was some windows-specific issue, see CL that added this tests: https://codereview.chromium.org/67154/#ps1\n\nI think this test may still be useful. Just cleaned up the comment to remove deadlock reference.",
      "parentUuid": "109fdc05_9875badd",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "12eb2e58_7a645cc6",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 196,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "624c0858_64f868b8",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0824d235_44820ea1",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "For all \"play\" tests add expectation (some interval) on the number of received callbacks?\nAnd an expectation about no errors?\n(For that you may need a test source which owns a since wave source)",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33ed6358_e7cc305c",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "IMO it\u0027s better to test for stream position instead of number of callbacks. Also the problem is that the stream may take some time to initialize, which means that even if we run it for .2 seconds, it doesn\u0027t mean that the system will request .2 worth of samples. I just added basic checks that verify that stream position moves past 0.",
      "parentUuid": "0824d235_44820ea1",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "44be687f_21030ff3",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-10T10:41:45Z",
      "side": 1,
      "message": "But we know when the first callback is received, right? So we can run the test for a specific period of time after the stream is actually started.\nWhat we want is to test that the physical stream is open at the sample rate/buffer size we passed to it.",
      "parentUuid": "33ed6358_e7cc305c",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f02eb302_cb2338ff",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 372,
      "author": {
        "id": 1153409
      },
      "writtenOn": "2017-10-06T10:07:56Z",
      "side": 1,
      "message": "Add Set/GetVolume tests?",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ff8fa112_0d3cb004",
        "filename": "media/audio/audio_output_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 372,
      "author": {
        "id": 1116023
      },
      "writtenOn": "2017-10-10T00:03:27Z",
      "side": 1,
      "message": "Play200HzTone22kHz calls these. I don\u0027t think we need any other tests beside that.",
      "parentUuid": "f02eb302_cb2338ff",
      "revId": "39b2208b8628848d7c3445c5d8ed18a3daf967ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}