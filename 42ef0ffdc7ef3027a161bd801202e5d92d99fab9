{
  "comments": [
    {
      "key": {
        "uuid": "9c634483_4ee8c9fc",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2017-09-14T15:21:29Z",
      "side": 1,
      "message": "Seconding what Mike already commented, a quick search on the subject confirms what he just mentioned. Please check \"Data alignment for speed: myth or reality?\": \nhttps://lemire.me/blog/2012/05/31/data-alignment-for-speed-myth-or-reality/.\n\nIt seems that starting from 2010 onwards, Intel processors have improved remarkably on the way they handle unaligned memory access. I don\u0027t see much of a benefit of having to support legacy CPUs that are older than 7  years (as we get trapped in the legacy issue that is a curse in zlib).\n\nSo unless we have compelling data to prove its benefits, it is better to just simplify the code and remove this block.",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dad9be41_ef20651c",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1193769
      },
      "writtenOn": "2017-09-14T15:27:32Z",
      "side": 1,
      "message": "For the record, I don\u0027t want to delete this blindly, but I do think it\u0027s worth timing to see if it\u0027s necessary sooner rather than later.  If we leave it until later it\u0027ll become part of the furniture, maybe with no real benefit.",
      "parentUuid": "9c634483_4ee8c9fc",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b967406d_161056ed",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-14T16:21:33Z",
      "side": 1,
      "message": "\u003e I don\u0027t see much of a benefit of having to support legacy CPUs that are older than 7  years (as we get trapped in the legacy issue that is a curse in zlib).\n\n[noel: edited, assumed this comment added by calvalcanti@ later was meant to be here] \n\u003e Actually, older than 7 years (more like 9 years), as Nehalem was introduced in 2008:\nhttps://en.wikipedia.org/wiki/Nehalem_(microarchitecture)\n\n\u003e So unless we have compelling data to prove its benefits, it is better to just simplify the code and remove this block.\n\nYou might be forgetting that chrome has minimum support requirements. Last I spoke to robert.bradford about this subject, he reminded me that we did not need to run-time check SSE2, we could assume it because of our support requirements [1], and SSE2 is 2001.  Have our minimum support requirements changed?\n\n[1] https://codereview.chromium.org/1215793004\n\n\u003eFor the record, I don\u0027t want to delete this blindly, but I do think it\u0027s worth timing to see if it\u0027s necessary sooner rather than later.  If we leave it until later it\u0027ll become part of the furniture, maybe with no real benefit.\n\nOne problem therein, anyone got an old machine to measure on?  I certainly don\u0027t.",
      "parentUuid": "dad9be41_ef20651c",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "951fe8b2_1fc5e90d",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-14T16:27:28Z",
      "side": 1,
      "message": "Have our minimum support requirements changed?\n\nhttps://support.google.com/chrome/answer/95346?hl\u003den\u0026visit_id\u003d1-636410030537519305-2788000062\u0026rd\u003d1\n\nTo use Chrome on Windows, you\u0027ll need:\nWindows 7, Windows 8, Windows 8.1, Windows 10 or later\nAn Intel Pentium 4 processor or later that\u0027s SSE2 capable\n\nTo use Chrome on Mac, you\u0027ll need:\nOS X Mavericks 10.9 or later\n\nLinux\nTo use Chrome on Linux, you\u0027ll need:\n64-bit Ubuntu 14.04+, Debian 8+, openSUSE 13.3+, or Fedora Linux 24+\nAn Intel Pentium 4 processor or later that\u0027s SSE2 capable.\n\nRobert (as expected) is correct.",
      "parentUuid": "b967406d_161056ed",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c8592523_c39cd9f5",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1193769
      },
      "writtenOn": "2017-09-14T16:54:08Z",
      "side": 1,
      "message": "Right, last I looked the summary is:\n  - Linux and Windows can assume SSE2.\n  - Mac and x86 Android can assume SSSE3.\n  - ARMv7 Android can assume NEON but not VFPv4 (FMA+F16 support).\n  - No interesting ARMv8 chip beyond the baseline is in users\u0027 hands.\n\nIf we ever bump that Mac minimum to 10.12, that\u0027ll raise the bar to SSE4.1 (but not SSE4.2).",
      "parentUuid": "951fe8b2_1fc5e90d",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "67dbb86f_98796627",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1193769
      },
      "writtenOn": "2017-09-14T16:59:20Z",
      "side": 1,
      "message": "\u003e One problem therein, anyone got an old machine to measure on?  I certainly don\u0027t.\n\nI\u0027m not sure this is a problem so much as an answer in itself.  I for one don\u0027t want to feel obligated to write code that presumably but unverifyably improves performance on machines that are too uncommon to test.  It\u0027s important that we function correctly and reasonably on older spec machines, but I\u0027m not convinced they\u0027re in the set that we need to really tweak out.\n\nIf we\u0027re not able to find an old enough machine, and no performance bot runs on an old enough machine, I would suggest not worrying about it.",
      "parentUuid": "c8592523_c39cd9f5",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c75c5fb_fc9dca7c",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-14T17:16:27Z",
      "side": 1,
      "message": "As in drop the code and instead use an _mm_loadu_si128 for loading the data?",
      "parentUuid": "67dbb86f_98796627",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06bbcfe6_019f5505",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1193769
      },
      "writtenOn": "2017-09-14T17:20:06Z",
      "side": 1,
      "message": "Yeah, instead of\n\n  prelude\n  while ...\n    aligned body\n  tail\n\njust\n\n  while ...\n    unaligned body\n  tail",
      "parentUuid": "0c75c5fb_fc9dca7c",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "089e5999_0e35952c",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2017-09-14T18:22:46Z",
      "side": 1,
      "message": "Yep, makes sense.",
      "parentUuid": "06bbcfe6_019f5505",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e035015d_1d7daa14",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-14T19:42:30Z",
      "side": 1,
      "message": "Ok then, we seem to have agreement to remove the prelude alignment code.  Uploading a patch for that.",
      "parentUuid": "089e5999_0e35952c",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "63c92fa7_7224e334",
        "filename": "third_party/zlib/adler32_simd.c",
        "patchSetId": 18
      },
      "lineNbr": 71,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-15T02:49:54Z",
      "side": 1,
      "message": "patch-set #19 for the record.",
      "parentUuid": "e035015d_1d7daa14",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "25169d7d_33dc329a",
        "filename": "third_party/zlib/adler32_simd.h",
        "patchSetId": 18
      },
      "lineNbr": 10,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2017-09-14T18:04:33Z",
      "side": 1,
      "message": "Maybe a typo? \"ladler\".",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f698d8e0_de0890f6",
        "filename": "third_party/zlib/adler32_simd.h",
        "patchSetId": 18
      },
      "lineNbr": 10,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2017-09-15T02:49:54Z",
      "side": 1,
      "message": "Nah, I copy/pasted the signature from the .c file.  But we can certainly make it adler if that reads easier/better for you ...",
      "parentUuid": "25169d7d_33dc329a",
      "revId": "42ef0ffdc7ef3027a161bd801202e5d92d99fab9",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}