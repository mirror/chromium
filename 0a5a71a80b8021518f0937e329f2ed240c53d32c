{
  "comments": [
    {
      "key": {
        "uuid": "933c8aae_1f619138",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T18:54:26Z",
      "side": 1,
      "message": "Why are we only recording this when the service is shut down? Shouldn\u0027t we be recording it every time it changes?",
      "range": {
        "startLine": 145,
        "startChar": 0,
        "endLine": 145,
        "endChar": 37
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "70cdbc6f_4f04dc14",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1229022
      },
      "writtenOn": "2017-08-02T23:01:36Z",
      "side": 1,
      "message": "I briefly address this in the documentation for RecordFinalTetherTechnologyState:\n\n\"Record to UMA Tether\u0027s last TechnologyState before it was shutdown.\nTether\u0027s TechnologyState at the end of its life is the most likely to\naccurately represent how it has been used by the user.\"\n\nI believe if we *always* emit to this histogram, we will be getting inaccurate metrics for how Tether is being used. There may be intermediate states until the user settles on how they want the system to configured in respect to Tether. For example, they might have turned off Bluetooth, but then re-enabled it upon seeing our prompt to do so, and then decided that Tether was useful enough to keep enabled.\n\nRecording at the end of each chrome session will be consistent across all emitting devices (so we know the individual contributions to this metric all happened on the same event) and most accurately reflects how the user was using Tether.",
      "parentUuid": "933c8aae_1f619138",
      "range": {
        "startLine": 145,
        "startChar": 0,
        "endLine": 145,
        "endChar": 37
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "19011088_b3dc2610",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T23:14:07Z",
      "side": 1,
      "message": "I\u0027m not sure about this.\n\nAs the code currently stands, there is a strong bias towards people with short sessions. For example, if a user without tether hosts logs in and out twice in 10 seconds, we\u0027ll log that twice, but if a user stays logged in for an entire day with the same state, we\u0027ll see only one log for that case.\n\nIs there a way to normalize this?",
      "parentUuid": "70cdbc6f_4f04dc14",
      "range": {
        "startLine": 145,
        "startChar": 0,
        "endLine": 145,
        "endChar": 37
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a56200b_cd518ac5",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1229022
      },
      "writtenOn": "2017-08-02T23:22:13Z",
      "side": 1,
      "message": "Yep, there is a way to normalize it, by only examining unique users on the dashboard (this is also how we\u0027ll do N-DAU analysis). This normalization needs this metric emission to occur on the same event in order for it to mean anything.",
      "parentUuid": "19011088_b3dc2610",
      "range": {
        "startLine": 145,
        "startChar": 0,
        "endLine": 145,
        "endChar": 37
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e59745e_d18c2334",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 145,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T23:31:38Z",
      "side": 1,
      "message": "So, why do you consider what happened at the end of the session more important than what happened at the start? If we can normalize by user, why do we only want to count events at the end? What\u0027s the downside to logging all changes?",
      "parentUuid": "8a56200b_cd518ac5",
      "range": {
        "startLine": 145,
        "startChar": 0,
        "endLine": 145,
        "endChar": 37
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "abbcbf75_cd95ffe1",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 316,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T18:54:26Z",
      "side": 1,
      "message": "This is a race condition. If one of the other callbacks occurs before the adapter is fetched or before the interval is set, the wrong TechnologyState can be set. You need to wait until the Bluetooth stuff is fully initialized before adding any listeners.",
      "range": {
        "startLine": 301,
        "startChar": 0,
        "endLine": 316,
        "endChar": 1
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09e44ac9_43a8f2af",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 316,
      "author": {
        "id": 1229022
      },
      "writtenOn": "2017-08-02T23:01:36Z",
      "side": 1,
      "message": "Good catch, done.",
      "parentUuid": "abbcbf75_cd95ffe1",
      "range": {
        "startLine": 301,
        "startChar": 0,
        "endLine": 316,
        "endChar": 1
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4fb4b1a3_d0dcd8f0",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 316,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T23:14:07Z",
      "side": 1,
      "message": "I don\u0027t see a fix for this.",
      "parentUuid": "09e44ac9_43a8f2af",
      "range": {
        "startLine": 301,
        "startChar": 0,
        "endLine": 316,
        "endChar": 1
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3619d4b4_fab17597",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 316,
      "author": {
        "id": 1229022
      },
      "writtenOn": "2017-08-02T23:22:13Z",
      "side": 1,
      "message": "Are you looking at the most recent patch set? I moved the adapter_ setting to OnBluetoothAdapterAdvertisingIntervalSet.",
      "parentUuid": "4fb4b1a3_d0dcd8f0",
      "range": {
        "startLine": 301,
        "startChar": 0,
        "endLine": 316,
        "endChar": 1
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f68f8e69_8c016b4c",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 316,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T23:31:38Z",
      "side": 1,
      "message": "That doesn\u0027t fix the race condition.\n\nExample:\n(0) is_ble_advertising_supported_ starts as true.\n(1) TetherService starts up, and before the adapter is fetched, OnSyncFinished() is called.\n(2) UpdateTetherTechnologyState() is called, and Tether is ENABLED.\n(3) The adapter is fetched, and it actually doesn\u0027t support advertising.\n(4) UpdateTetherTechnologyState() is called, and Tether is UNAVAILABLE.",
      "parentUuid": "3619d4b4_fab17597",
      "range": {
        "startLine": 301,
        "startChar": 0,
        "endLine": 316,
        "endChar": 1
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "69cbb06d_eddbe2ba",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 331,
      "author": {
        "id": 1001529
      },
      "writtenOn": "2017-08-02T18:54:26Z",
      "side": 1,
      "message": "Shouldn\u0027t this function have the same shut_down_ check as above?",
      "range": {
        "startLine": 331,
        "startChar": 20,
        "endLine": 331,
        "endChar": 62
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "560efdff_8a74e9f8",
        "filename": "chrome/browser/chromeos/tether/tether_service.cc",
        "patchSetId": 3
      },
      "lineNbr": 331,
      "author": {
        "id": 1229022
      },
      "writtenOn": "2017-08-02T23:01:36Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "69cbb06d_eddbe2ba",
      "range": {
        "startLine": 331,
        "startChar": 20,
        "endLine": 331,
        "endChar": 62
      },
      "revId": "0a5a71a80b8021518f0937e329f2ed240c53d32c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}