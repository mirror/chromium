{
  "comments": [
    {
      "key": {
        "uuid": "fcb7e078_8a83054d",
        "filename": "content/browser/media/media_internals.cc",
        "patchSetId": 6
      },
      "lineNbr": 709,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "nit: Maybe we should make PipelineInfo a class, which will automatically call ReportAllMetrics() on destruction.",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cdabe87a_931c31f1",
        "filename": "media/filters/ffmpeg_demuxer.cc",
        "patchSetId": 6
      },
      "lineNbr": 1558,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "This is reported in a for loop, what would happen to our metrics when we have multiple |audio_codec_id| events?",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23c2cdd1_23287bfe",
        "filename": "media/filters/ffmpeg_demuxer.cc",
        "patchSetId": 6
      },
      "lineNbr": 1558,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "Now we have codec ID, do we still need |audio_codec_name| above? You should always be able to call GetCodecName() to get the name from ID.\n\nIf we stop reporting |audio_codec_name|, then we can just s/audio_codec_id/audio_codec.",
      "range": {
        "startLine": 1558,
        "startChar": 25,
        "endLine": 1558,
        "endChar": 39
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6553b14_e185471a",
        "filename": "media/filters/ffmpeg_demuxer.cc",
        "patchSetId": 6
      },
      "lineNbr": 1558,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-19T21:20:47Z",
      "side": 1,
      "message": "AudioCodecName may include codecs we don\u0027t even know about. See how FFmpegDemuxer uses the entirety of the codec list known to ffmpeg for reporting UMA values, where as we only have ids for some of those.",
      "parentUuid": "23c2cdd1_23287bfe",
      "range": {
        "startLine": 1558,
        "startChar": 25,
        "endLine": 1558,
        "endChar": 39
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ef66b4eb_892a6753",
        "filename": "media/filters/ffmpeg_demuxer.cc",
        "patchSetId": 6
      },
      "lineNbr": 1558,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-19T21:20:47Z",
      "side": 1,
      "message": "Yeah, that is a worry. I\u0027m wondering if we need a different finalization mechanism for this. I.e. report aggregate watch time whenever audio codec or video codec changes; that way we can map each UKM entry to set of properties that were valid at the time of record.\n\nI\u0027ll keep thinking about it and see what I can come up with. We have the same problem with the hardware decoding parameter which may vary. If we do this, then MediaInternals needs to start doing its own watch time filtering (\u003c 7 seconds).\n\nI know chcunningham@ has been talking about making some of these codec and decoder name changes more explicit events in the pipeline. If we have that we could use that mechanism to signal to the watch time reporter and let it handle all of this.",
      "parentUuid": "cdabe87a_931c31f1",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b526f76_637c09c5",
        "filename": "media/filters/ffmpeg_demuxer.cc",
        "patchSetId": 6
      },
      "lineNbr": 1575,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "ditto",
      "range": {
        "startLine": 1575,
        "startChar": 13,
        "endLine": 1575,
        "endChar": 23
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc9ac9bc_989a1890",
        "filename": "media/filters/source_buffer_state.cc",
        "patchSetId": 6
      },
      "lineNbr": 599,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "Not related to this CL: Isn\u0027t a non-unknown audio codec equivalent to |found_audio_stream|?",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "27737d5f_e7fa55f0",
        "filename": "media/filters/source_buffer_state.cc",
        "patchSetId": 6
      },
      "lineNbr": 599,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-19T21:20:47Z",
      "side": 1,
      "message": "Yeah good point, we can drop this.",
      "parentUuid": "fc9ac9bc_989a1890",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a49f9ecf_4fa32c0e",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 306,
      "author": {
        "id": 1124674
      },
      "writtenOn": "2017-06-17T00:48:04Z",
      "side": 1,
      "message": "Is each metric here actually only reported once per PageLoad?\nWhat if you have multiple media items with different codecs?",
      "range": {
        "startLine": 306,
        "startChar": 28,
        "endLine": 306,
        "endChar": 44
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b1c8c1a_b03cfc0c",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 306,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-17T01:16:23Z",
      "side": 1,
      "message": "No, I misunderstood this then. I though it was for once per source id. There may be many of these in a given page. Will change with the next upload. Thanks!",
      "parentUuid": "a49f9ecf_4fa32c0e",
      "range": {
        "startLine": 306,
        "startChar": 28,
        "endLine": 306,
        "endChar": 44
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba686315_720502da",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 306,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "How hard is it to add more metrics to this UKM in the future?",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87065f00_facece6c",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 315,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "It seems you can add \u003csummary\u003e for each metric. This would be a great way for readers to understand what each value mean. For example, we need to note WatchTime is in millisecond.",
      "range": {
        "startLine": 315,
        "startChar": 16,
        "endLine": 315,
        "endChar": 26
      },
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "27080284_12b6c30b",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 320,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "Would it be possible to calculate MeanTimeBetweenRebuffers from WatchTime and RebuffersCount?",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51a66932_ca7f3c57",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 320,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-19T21:20:47Z",
      "side": 1,
      "message": "See below.",
      "parentUuid": "27080284_12b6c30b",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "089d51f4_d1d2eaaa",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 329,
      "author": {
        "id": 1002182
      },
      "writtenOn": "2017-06-17T04:41:55Z",
      "side": 1,
      "message": "Should these always be true (or approximately true)?\n\nWatchTime \u003d WatchTime.NativeControlsOn + WatchTime.NativeControlsOff\nWatchTime \u003d WatchTime.AC + WatchTime.Battery\nWatchTime.Background \u003d WatchTime.Background.AC + WatchTime.Background.Battery\n\nIf so, does it make sense to only report metrics like:\nWatchTime\nNativeControlsPercentage\nBackgroundPercetage\nBatteryPercentage\nBackgroundBatteryPercentage",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "32fbf523_0f52710a",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 329,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-06-19T21:20:47Z",
      "side": 1,
      "message": "I thought about that, or at least for MTBR I did, but I think making these calculation based would restrict the ability to perform queries on the data set. Consider if you want to run a query summing watch time for a given type. It\u0027s possible this is trivial with our query tooling, but I\u0027m not sure.\n\nAlso consider that we are logging int64_t values, so reporting percentages with some accuracy would require scaling the percentage by whatever number of decimal points we deem appropriate. Given the size of our values for total watch time even a small precision loss is a ton of missed watch time.",
      "parentUuid": "089d51f4_d1d2eaaa",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc296ebf_702d9e50",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 329,
      "author": {
        "id": 1124674
      },
      "writtenOn": "2017-06-20T18:23:57Z",
      "side": 1,
      "message": "Multiplying or subtracting fields should be do-able.  So you could infer\nWatchTime.AC \u003d WatchTime - WatchTime.Battery",
      "parentUuid": "32fbf523_0f52710a",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e186657b_73418050",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 329,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T19:29:40Z",
      "side": 1,
      "message": "What I expected is a little different from xhwang\u0027s proposal -- rather than use percentages, I expected we would have IsBattery, IsAC, IsBackground, etc... we would then just have one WatchTime with no suffixes. This seems to avoid the precision issue and I would guess its trivial to query (sounds like a simple WHERE clause?)",
      "parentUuid": "cc296ebf_702d9e50",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74b67d8d_8fd159b7",
        "filename": "tools/metrics/ukm/ukm.xml",
        "patchSetId": 6
      },
      "lineNbr": 329,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Doesn\u0027t work since we can have both IsBattery and IsAC in the same report. I prefer not to require us to do calculations on our keys to get values here. Since we have some keys that are tri-state a simple subtraction doesn\u0027t quite work either in all cases. So instead of mixing paradigms I\u0027ve just recorded all cases.",
      "parentUuid": "e186657b_73418050",
      "revId": "0b88b1694574afa8ac0c25d7907090a8511d2cfc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}