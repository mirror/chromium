{
  "comments": [
    {
      "key": {
        "uuid": "cb3dcd8f_3317c33f",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 31,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-10-12T08:13:15Z",
      "side": 1,
      "message": "I think this sentence is now misleading? The second paragraph says it outlives WebServiceWorkerRegistration::Handle.",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79704ccc_19d9f452",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 31,
      "author": {
        "id": 1161621
      },
      "writtenOn": "2017-10-12T14:26:09Z",
      "side": 1,
      "message": "Ack. Yeah currently although |this| is held by WebSWRegistration::Handle, it\u0027s not owned by Handle. Will try to modify the sentence later.",
      "parentUuid": "cb3dcd8f_3317c33f",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0fecdf33_36d00742",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 43,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-10-12T08:13:15Z",
      "side": 1,
      "message": "The second paragraph is seems to say we\u0027re owned by ServiceWorkerRegistrationHandle, while this paragraph is says we try to keep the handle alive?",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8bccaca_6ea9dce4",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 43,
      "author": {
        "id": 1161621
      },
      "writtenOn": "2017-10-12T14:26:09Z",
      "side": 1,
      "message": "// |info_-\u003ehost_ptr_info| holds a Mojo connection end point retaining an\n// reference to the remote content::ServiceWorkerRegistrationHandle to control\n// its lifetime.\nIn normal case, closing |info_-\u003ehost_ptr_info| leads to destruction of remote SWRegistrationHandle, which closes the other end point of |binding_|, then in turn leads to destruction of |this|.",
      "parentUuid": "0fecdf33_36d00742",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ad2c5dbe_f6e61ff0",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 43,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-10-13T04:58:41Z",
      "side": 1,
      "message": "OK I think I\u0027m starting to understand. It might make sense to structure this comment more sequentially to describe the life of a WebServiceWorkerRegistrationImpl. Something like this (which is probably overly verbose...)\n\nI\u0027d also like the documentation to explain why this class is RefCounted.\n\n1. A WebServiceWorkerRegistrationImpl is created when the browser process sends the first ServiceWorkerRegistrationObjectInfo to the renderer process that describes the desired JavaScript object. The instance is created and takes ownership of the object info. The object info has a Mojo connection to a ServiceWorkerRegistrationHandle in the browser process ((|this-\u003einfo_.host_ptr_info|) . In addition, The WebServiceWorkerRegistrationImpl itself is connected with the ServiceWorkerRegistrationHandle (|this-\u003ebinding_|).\n\nCreation always happens in order to create a ServiceWorkerRegistration JavaScript object in Blink. The instance is shared with Blink via WebServiceWorkerRegistration::Handle. As long as a handle is alive in Blink, this instance should not die.\n\n2. During the lifetime of WebServiceWorkerRegistrationImpl, multiple WebServiceWorkerRegistration::Handles may be created and held by Blink. If the browser process sends another ServiceWorkerRegistrationObjectInfo to the renderer process for this same JavaScript object, the renderer reuses the existing WebServiceWorkerRegistrationImpl instance and creates a new WebServiceWorkerRegistration::Handle to share with Blink.\n\n3. If all WebServiceWorkerRegistration::Handles are destroyed, the WebServiceWorkerRegistrationImpl clears |info_|, which informs the ServiceWorkerRegistrationHandle in the browser process that this instance is ready to be destroyed. If there was no ServiceWorkerRegistrationObjectInfo inflight, the browser process destroys the Mojo connection to this instance, which finally destroys it.",
      "parentUuid": "a8bccaca_6ea9dce4",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8f22948_cbfb8091",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 86,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-10-12T08:13:15Z",
      "side": 1,
      "message": "It doesn\u0027t have to do with this patch but can you just delete this `using`? It seems to be only used once and adds unnecessary indirection.",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8073ab9e_0ba65dca",
        "filename": "content/child/service_worker/web_service_worker_registration_impl.h",
        "patchSetId": 11
      },
      "lineNbr": 86,
      "author": {
        "id": 1161621
      },
      "writtenOn": "2017-10-12T14:26:09Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e8f22948_cbfb8091",
      "revId": "f966e254022f6e47f6cc306bec470d709b76d735",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}