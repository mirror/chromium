{
  "comments": [
    {
      "key": {
        "uuid": "6b86cd37_4b82aa79",
        "filename": "content/browser/renderer_host/render_widget_host_view_android.cc",
        "patchSetId": 17
      },
      "lineNbr": 1415,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-06-12T21:51:36Z",
      "side": 1,
      "message": "I just realized that now RWHVA and WCAA each depend on each other.\nIt\u0027s not terrible, but generally it\u0027s cleaner to have dependencies\ngoing in just one direction and to use a delegate or client interface\nthe other way.\n\nRight now we mostly have renderer_host and frame_host depending on\naccessibility and not the other way around. BAM has a delegate\ninterface for communicating back with the RFH that owns it.\n\nMaybe consider doing the same thing, having WebContentsAccessibilityAndroid not directly reference RenderWidgetHostViewAndroid, but instead indirectly through a delegate interface.",
      "revId": "42a4ba17e9e40f834e33327f404d7195c6606e81",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4a20497_f03796e6",
        "filename": "content/browser/renderer_host/render_widget_host_view_android.cc",
        "patchSetId": 17
      },
      "lineNbr": 1415,
      "author": {
        "id": 1149077
      },
      "writtenOn": "2017-06-13T07:47:22Z",
      "side": 1,
      "message": "Agreed. But I presume you\u0027re talking about BrowserAccessibilityManagerAndroid and WebContentsAccessibilityAndroid, right? They are the ones referencing each other. WCAA does not depend on RWHVA. Only its |Connnector| is passed a pointer to RWHVA, but it doesn\u0027t keep the reference either. Or is the point that it doesn\u0027t look desirable for RWHVA to have a direct reference to WCAA for the sake of consistency with the way RFH communicates with BAM? I see RHF inherit BAM delegate. This may work, but not ideal for WCAA/RWHVA as they have different lifetime. |Connector| is a minimum mechanism to replace the way the connection between them is managed, with CVC that was used before.\n\nAnyway I uploaded a new patch that defines WebContentsAccessibility::Delegate interface that BAMA implements. I think it also a part that needs a delegate interface. I defined the delegate on WCAA side since it seems natural to me that WCAA needs a delegate to process the request from Java layer(but it can be easily viewed the other way around too... they were one class that now got split. Who depends who may not be clear). Another reason is that BAM already has a delegate - I\u0027d rather not add another one in there.",
      "parentUuid": "6b86cd37_4b82aa79",
      "revId": "42a4ba17e9e40f834e33327f404d7195c6606e81",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "41d332a4_f0aee548",
        "filename": "content/browser/renderer_host/render_widget_host_view_android.cc",
        "patchSetId": 17
      },
      "lineNbr": 1415,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-06-13T08:09:49Z",
      "side": 1,
      "message": "No, I meant RenderWidgetHostViewAndroid and WebContentsAccessibilityAndroid, but as I look at it some more, it\u0027s limited to the subclass of RenderWidgetHostConnector. I wasn\u0027t really familiar with that before but it seems reasonable.\n\nThanks for adding the Delegate interface to WebContentsAccessibility, but I think I\u0027ve decided I like the previous patch set better. Since WebContentsAccessibility::Delegate still needs the BrowserAccessibility type, it doesn\u0027t really decouple them (since you can easily get from a BrowserAccessibility to a BrowserAccessibilityManager). So I think it\u0027s better to not complicate it.",
      "parentUuid": "b4a20497_f03796e6",
      "revId": "42a4ba17e9e40f834e33327f404d7195c6606e81",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}