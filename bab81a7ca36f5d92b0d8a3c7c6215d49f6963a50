{
  "comments": [
    {
      "key": {
        "uuid": "ed18da10_4dbbce9a",
        "filename": "chrome/browser/safe_browsing/safe_browsing_service.h",
        "patchSetId": 2
      },
      "lineNbr": 143,
      "author": {
        "id": 1144209
      },
      "writtenOn": "2017-09-19T00:35:13Z",
      "side": 1,
      "message": "I just realize safe_browsing_blocking_page.cc is using the wrong request context when it calls StartCollectingThreatDetails(...)  \nhttps://cs.chromium.org/chromium/src/chrome/browser/safe_browsing/safe_browsing_blocking_page.cc?rcl\u003dd0cd2b3c0a15b53fa998cc2000a3fb8fab1d16a8\u0026l\u003d140\n\nIt should be using the url_request_context() here.  The profile-\u003eGetRequestContext() does not have the safe browsing cookie jar.",
      "revId": "bab81a7ca36f5d92b0d8a3c7c6215d49f6963a50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "46aa3d07_0c6aafff",
        "filename": "chrome/browser/safe_browsing/safe_browsing_service.h",
        "patchSetId": 2
      },
      "lineNbr": 143,
      "author": {
        "id": 1168342
      },
      "writtenOn": "2017-09-19T14:50:06Z",
      "side": 1,
      "message": "I created crbug.com/766685 for this, will fix it in a followup CL.",
      "parentUuid": "ed18da10_4dbbce9a",
      "revId": "bab81a7ca36f5d92b0d8a3c7c6215d49f6963a50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7430a5be_b31e6fe6",
        "filename": "components/safe_browsing/triggers/ad_sampler_trigger.cc",
        "patchSetId": 2
      },
      "lineNbr": 171,
      "author": {
        "id": 1144209
      },
      "writtenOn": "2017-09-18T22:36:10Z",
      "side": 1,
      "message": "I guess you changed TriggerManager to RefCounted because of this calling point. \nAlternatively, you can use \"base::Unretained(trigger_manager_)\", such that you don\u0027t need to change TriggerManager into a RefCounted class. \n\nQ: what will happen if user immediately closes browser after this PostDelayedTask(..)? \nYou probably don\u0027t want this to block shutdown. Something like this:\nhttps://cs.chromium.org/chromium/src/base/task_scheduler/post_task.cc?l\u003d67\u0026ct\u003dxref_jump_to_def\u0026gsn\u003dPostDelayedTaskWithTraits",
      "revId": "bab81a7ca36f5d92b0d8a3c7c6215d49f6963a50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8ee2de72_293c4974",
        "filename": "components/safe_browsing/triggers/ad_sampler_trigger.cc",
        "patchSetId": 2
      },
      "lineNbr": 171,
      "author": {
        "id": 1168342
      },
      "writtenOn": "2017-09-19T14:50:06Z",
      "side": 1,
      "message": "Nice, I thought base::unretained was only for params - much cleaner now without having triggermanager refcounted.\n\nAs for specifying traits - if I\u0027m reading correctly, the default shutdown behaviour is SKIP_ON_SHUTDOWN. So if the the user closes the window before this task starts executing it will be skipped (we won\u0027t block shutdown for 5s). If the task is already running it will be allowed to finish (which involves creating the report and sending it, which is consistent with the security interstitial works AFAICT).",
      "parentUuid": "7430a5be_b31e6fe6",
      "revId": "bab81a7ca36f5d92b0d8a3c7c6215d49f6963a50",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}