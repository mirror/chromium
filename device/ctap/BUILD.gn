# Copyright 2017 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/config/features.gni")
import("//testing/libfuzzer/fuzzer_test.gni")

source_set("ctap") {
  sources = [
    "authenticator_get_assertion_response.cc",
    "authenticator_get_assertion_response.h",
    "authenticator_get_info_response.cc",
    "authenticator_get_info_response.h",
    "authenticator_make_credential_response.cc",
    "authenticator_make_credential_response.h",
    "authenticator_options.cc",
    "authenticator_options.h",
    "ctap_authenticator_response.cc",
    "ctap_authenticator_response.h",
    "ctap_constants.cc",
    "ctap_constants.h",
    "ctap_get_assertion_request_param.cc",
    "ctap_get_assertion_request_param.h",
    "ctap_make_credential_request_param.cc",
    "ctap_make_credential_request_param.h",
    "ctap_request_param.cc",
    "ctap_request_param.h",
    "ctap_response.cc",
    "ctap_response.h",
    "device_response_convertor.cc",
    "device_response_convertor.h",
    "public_key_credential_descriptor.cc",
    "public_key_credential_descriptor.h",
    "public_key_credential_params.cc",
    "public_key_credential_params.h",
    "public_key_credential_rp_entity.cc",
    "public_key_credential_rp_entity.h",
    "public_key_credential_user_entity.cc",
    "public_key_credential_user_entity.h",
  ]

  deps = [
    "//base",
    "//components/cbor",
    "//device/u2f",
    "//services/device/public/interfaces",
    "//services/service_manager/public/cpp",
    "//services/service_manager/public/interfaces",
  ]
}

fuzzer_test("ctap_response_fuzzer") {
  sources = [
    "ctap_response_fuzzer.cc",
  ]
  deps = [
    ":ctap",
    "//net",
  ]
  libfuzzer_options = [ "max_len=65537" ]
}
