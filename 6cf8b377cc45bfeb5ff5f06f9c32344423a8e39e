{
  "comments": [
    {
      "key": {
        "uuid": "0309a1c6_bd1dab94",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/partnerbookmarks/PartnerBookmarksReader.java",
        "patchSetId": 6
      },
      "lineNbr": 135,
      "author": {
        "id": 1144344
      },
      "writtenOn": "2017-11-08T22:39:26Z",
      "side": 1,
      "message": "To be really safe, we might use lock. I think this would only decrease the probability of being called multiple times.",
      "range": {
        "startLine": 135,
        "startChar": 8,
        "endLine": 135,
        "endChar": 25
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f221a20f_f83f10d6",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/partnerbookmarks/PartnerBookmarksReader.java",
        "patchSetId": 6
      },
      "lineNbr": 135,
      "author": {
        "id": 1144344
      },
      "writtenOn": "2017-11-09T06:02:53Z",
      "side": 1,
      "message": "Using this flag to guard it is not enough. For example, if one thread calls shutDown, and it is calling the native part. At this time, mShutdown is still false, and another thread can call shutDown, which will call the native part again.",
      "parentUuid": "0309a1c6_bd1dab94",
      "range": {
        "startLine": 135,
        "startChar": 8,
        "endLine": 135,
        "endChar": 25
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0dff8253_0af08319",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/partnerbookmarks/PartnerBookmarksReader.java",
        "patchSetId": 6
      },
      "lineNbr": 135,
      "author": {
        "id": 1230128
      },
      "writtenOn": "2017-11-09T16:39:58Z",
      "side": 1,
      "message": "Added a synchronized block for mShutDown.",
      "parentUuid": "f221a20f_f83f10d6",
      "range": {
        "startLine": 135,
        "startChar": 8,
        "endLine": 135,
        "endChar": 25
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3c7e48b2_0c31c32d",
        "filename": "chrome/browser/android/bookmarks/partner_bookmarks_reader.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1144344
      },
      "writtenOn": "2017-11-09T06:59:11Z",
      "side": 1,
      "message": "I think we should differentiate errors here. For example, FAILURE_CONNECTION_ERROR means the device is offline, and we should retry next time. On the other hand, FAILURE_HTTP_ERROR means the URL doesn\u0027t have a favicon, and we should not try to retrieve it again for a while.\n\nLooks like the chromium favicon code already has throttling built-in, but I guess we still want to have our own safeguard, since the cache there is not persistent.\n\nSee UnableToDownloadFavicon():\nhttps://cs.chromium.org/chromium/src/components/favicon/core/favicon_service_impl.cc?l\u003d261\u0026gs\u003dcpp%253Afavicon%253A%253Aclass-FaviconServiceImpl%253A%253AUnableToDownloadFavicon(const%2BGURL%2B%2526)%2540chromium%252F..%252F..%252Fcomponents%252Ffavicon%252Fcore%252Ffavicon_service_impl.cc%257Cdef\u0026gsn\u003dUnableToDownloadFavicon\u0026ct\u003dxref_usages",
      "range": {
        "startLine": 313,
        "startChar": 6,
        "endLine": 313,
        "endChar": 71
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e77a500b_ad876c97",
        "filename": "chrome/browser/android/bookmarks/partner_bookmarks_reader.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1144344
      },
      "writtenOn": "2017-11-09T07:12:47Z",
      "side": 1,
      "message": "Since we set fallback_to_server \u003d false in this CL, we are free to address this issue in the next CL if you want. This CL looks good to land except the thread safety issue.",
      "parentUuid": "3c7e48b2_0c31c32d",
      "range": {
        "startLine": 313,
        "startChar": 6,
        "endLine": 313,
        "endChar": 71
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d42c807_c0f3c643",
        "filename": "chrome/browser/android/bookmarks/partner_bookmarks_reader.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1230128
      },
      "writtenOn": "2017-11-09T16:39:58Z",
      "side": 1,
      "message": "Ack, I\u0027ll add this shortly in a followup CL.",
      "parentUuid": "e77a500b_ad876c97",
      "range": {
        "startLine": 313,
        "startChar": 6,
        "endLine": 313,
        "endChar": 71
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a24e03fe_67febbe6",
        "filename": "chrome/browser/android/bookmarks/partner_bookmarks_reader.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1230128
      },
      "writtenOn": "2017-11-09T16:50:49Z",
      "side": 1,
      "message": "I added the error condition FAILURE_CONNECTION_ERROR and a check in OnGetFaviconFromServerFinished to handle this instead of adding it in a followup CL.",
      "parentUuid": "0d42c807_c0f3c643",
      "range": {
        "startLine": 313,
        "startChar": 6,
        "endLine": 313,
        "endChar": 71
      },
      "revId": "6cf8b377cc45bfeb5ff5f06f9c32344423a8e39e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}