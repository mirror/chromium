<h1>Design User Interface</h1>

<p>
  The extension user interface should be purposeful and minimal.
  Just like extensions themselves,
  the UI should customize or enhance the browsing experience,
  not distract from it.
</p>

<p>
  This guide explores required and optional UI features.
  Use it to understand how
  and when to implement different elements within an extension.
</p>

<h2 id="browser_action">Activate extension on all pages</h2>
<p>
  Use <a href="/browserAction">browser_action</a> when an extension's
  features are usable in most situations.
</p>
<h3 id="browser">Register browser action</h2>
<p>
  The <code>"browser_action"</code> field is registered in the manifest.
</p>
<pre data-filename="manifest.json">
  {
    "name": "My Awesome browser_action Extension",
    ...
    "browser_action": {

        }
    ...
  }
</pre>
<p>
  Declaring <code>"browser_action"</code> keeps the toolbar icon in full color
  and accessible by users at all times.
</p>
<h3 id="badge">Add a badge</h3>
<p>
  Badges display up to four characters on top of the browser icon.
  They can only be used by extensions that declare <code>browser_action</code>
  in their manifest.
</p>
<p>
  Use badges to indicate the state of the extension.
  The
  <a href="https://developer.chrome.com/extensions/samples#search:drink">
  Drink Water Event</a> sample has no badge when there is not an alarm set,
  but shows "ON" to let the user know they haven't missed the notification.
</p>
<img src="{{static}}/images/user_interface/badge_off_example.png"
  width="72" height="72"
  alt="Badge Off" />
<img src="{{static}}/images/user_interface/badge_on_example.png"
  width="72" height="72"
  alt="Badge On" />
</p>
  Set the text of the badge by calling
  <a href="/browserAction#method-setBadgeText">
    <code>chrome.browserAction.setBadgeText</code>
  </a>
  and the background color by calling
  <a href="/browserAction#method-setBadgeBackgroundColor">
    <code>chrome.browserAction.setBadgeBackgroundColor</code>
  </a>.
</p>
<pre data-filename="background.js">
  chrome.browserAction.setBadgeText({text: 'ON'});
  chrome.browserAction.setBadgeBackgroundColor({color: '#4688F1'});
</pre>


<h2 id="page_action">Activate extension on select pages</h2>
<p>
  Use <a href="/pageAction">page_action</a> when an extension's
  features are only available under certain circumstances.
</p>
<h3 id="page">Declare Page Action</h3>
<p>
  The <code>"page_action"</code> field is registered in the manifest.
</p>
<pre data-filename="manifest.json">
  {
    "name": "My Awesome page_action Extension",
    ...
    "page_action": {

        }
    ...
  }
</pre>
<p>
  Declaring <code>"page_action"</code> will grey out the toolbar icon
  when the extension is unusable.
</p>
<img src="{{static}}/images/user_interface/page_action_inactive.png"
  width="72" height="72"
  alt="Badge On" />
  <img src="{{static}}/images/user_interface/page_action_active.png"
    width="72" height="72"
    alt="Badge On" />

<h3 id="rules">Define rules for activating extension</h3>
<p>
  Declare rules for when the extension is usable by calling
  <a href="/declarativeContent"><code>chrome.declarativeContent</code></a>
  under the
  <a href="/runtime#event-onInstalled"><code>runtime.onInstalled</code></a>
  listener in a <a href="/background_pages">background script</a>.
  The <a href="/samples#search:page%20action%20by%20url">Page action by URL</a>
  sample extension calls <a href="/pageAction#method-show">
  <code>ShowPageAction()</code></a>
  under actions when the current page url contains a 'g':
</p>
<pre data-filename="background.js">
  chrome.runtime.onInstalled.addListener(function() {
    // Replace all rules ...
    chrome.declarativeContent.onPageChanged.removeRules(undefined, function() {
      // With a new rule ...
      chrome.declarativeContent.onPageChanged.addRules([
        {
          // That fires when a page's URL contains a 'g' ...
          conditions: [
            new chrome.declarativeContent.PageStateMatcher({
              pageUrl: { urlContains: 'g' },
            })
          ],
          // And shows the extension's page action.
          actions: [ new chrome.declarativeContent.ShowPageAction() ]
        }
      ]);
    });
  });
</pre>

<h3 id="enable_disable">Enable or disable extension</h3>
<p>
  Page actions can additionally be enabled and disabled by calling
  <a href="/pageAction#method-show"><code>pageAction.show</code></a> and
  <a href="/pageAction#method-hide"><code>pageAction.hide</code></a>.
  <!-- TODO fix mappy extension -->
  The <a href="https://developer.chrome.com/extensions/samples#search:mappy">
    Mappy</a>
  sample extension scans a webpage for an address
  and creates a map of the address in a <a href="#popup">popup</a>.
  Because the extension is dependent on page content,
  it cannot declare rules to predict which pages will be relevant.
</p>
<p>
  Instead, if an address is found on a page it calls
  <code>pageAction.show</code>
  to colorize the icon and signal the extension is usable on that tab.
  If there is no available address on the page,
  it calls <code>pageAction.hide</code> to keep the icon greyed out.

</p>
<pre data-filename="background.js">
  function updateAddress(tabId) {
    chrome.tabs.sendRequest(tabId, {}, function(address) {
      addresses[tabId] = address;
      // If no address is found on a page,
      if (!address) {
        // hide the page action on that tab.
        chrome.pageAction.hide(tabId);
      } else {
        // Show the page action if address is available.
        chrome.pageAction.show(tabId);
        if (selectedId == tabId) {
          updateSelected(tabId);
        }
      }
    });
  }
</pre>

<h2 id="icons">Provide extension icons</h2>
<p>
  Extensions require at least one icon to represent it.
  For the best visual results,
  provide icons in PNG format
  (although be in any format supported by WebKit,
  including BMP, GIF, ICO, and JPEG).
</p>
<h3 id="icons">Designate toolbar icons</h3>
<p>
  Icons specific to the toolbar can be registered under
  <a href="/browserAction"><code>browser_action</code></a> or
  <a href="/pageAction"><code>page_action</code></a> in the manifest.
  Including multiple sizes is encouraged to scale for the 16-dip space.
  At minimum, 16x16 and 32x32 sizes are recommended.
</p>

<pre data-filename="manifest.json">
  {
    "name": "My Awesome page_action Extension",
    ...
    "page_action": {
        "default_icon": {
          "16": "extension_toolbar_icon16.png",
          "32": "extension_toolbar_icon32.png"
          }
        }
    ...
  }
</pre>
<p>
  Ensure all icons are square or they may be distorted.
  Use big and colorful icons with alpha transparency to soften the edges.
  If no icons are supplied, chrome will add a generic one to the toolbar.
</p>
<h3 id="icon_size">Create and register additional icons</h3>
<p>
  Include additional icons in the following sizes
  for uses outside of the toolbar.
</p>
<table>
  <th>Icon Size</th><th>Icon Use</th>
  <tr>
    <td>16x16</td><td>favicon on the extension's pages</td>
  <tr>
  <tr>
    <td>32x32</td>
    <td>Windows computers often require this size.
    Providing this option will prevent size distortion when shrinking
    the 48x48 option.</td>
  <tr>
  <tr>
    <td>48x48</td><td>displays on the extensions management page</td>
  <tr>
  <tr>
    <td>128x128</td><td>displays on installation and in the Chrome Webstore</td>
  <tr>
</table>

<p>
  Register icons in the manifest under the icons field.
</p>

<pre data-filename="manifest.json">

  {
    "name": "My Awesome Extension",
    ...
    "icons": {
      "16": "extension_icon16.png",
      "32": "extension_icon32.png",
      "48": "extension_icon48.png",
      "128": "extension_icon128.png"
    }
    ...
  }
</pre>

<h2 id="additional_features">Additional UI Features</h2>
<h3 id="popup">Popup</h3>
<p>
  A popup is an HTML file that is displayed
  when the user clicks on the toolbar icon.
  A popup works very similarly to a web page;
  it can contain script tags, links to stylesheets and any HTML elements needed.
  However, it does not allow inline JavaScript.
</p>
<p>
  The
  <a href="https://developer.chrome.com/extensions/samples#search:drink">
  Drink Water Event</a>
  example uses a popup to display users available options.
  They stet an alarm by clicking one of the provided buttons.
</p>
<img src="{{static}}/images/user_interface/popup.png"
  height="300"
  alt="Popup" />
<pre data-filename="popup.html">
  &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;Water Popup&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;img src='./stay_hydrated.png' id='hydrateImage'&gt;
        &lt;button id='sampleSecond' value='0.1'&gt;Sample Second&lt;/button&gt;
        &lt;button id='15min' value='15'>15 Minutes&lt;/button&gt;
        &lt;button id='30min' value='30'>30 Minutes&lt;/button&gt;
        &lt;button id='cancelAlarm'>Cancel Alarm&lt;/button&gt;
     &lt;script src="popup.js"&gt;&lt;/script&gt;
    &lt;/body&gt;
  &lt;/html&gt;
</pre>
<p>
The popup can be registered in the manifest, under browser action or page action:
</p>
<pre data-filename="manifest.json">
  {
    "name": "Drink Water Event",
    ...
    "browser_action": {
      "default_popup": "popup.html"
    }
    ...
  }
</pre>
<p>
  Popups can also be set dynamically by calling
  <a href="/browserAction#method-setPopup">
    <code>browserAction.setPopup</code></a> or
  <a href="/pageAction#method-setPopup"><code>pageAction.setPopup</code></a>
</p>

<pre data-filename="background.js">
  chrome.storage.local.get("signed_in", function(data) {
    if (data.signed_in) {
      chrome.browserAction.setPopup({popup: "popup.html"});
    } else {
      chrome.browserAction.setPopup({popup: "popup_sign_in.html"});
    }
  });
</pre>

<!-- TODO talk about tab flipper extension/reference it -->
<h3 id="tooltip">Tooltip</h3>
<p>
 Use the tooltip to give a short description or instructions to the user
 when they hover over the browser icon.
</p>
<img src="{{static}}/images/user_interface/tooltip.png"
  height="100"
  alt="Tooltip" />
<p>
  Tooltips are registered in the <code>default_title</code> field
  under <code>browser_action</code> or <code>page_action</code>.
</p>
<pre data-filename="manifest.json">
  {
  "name": "Tab Flipper",
   ...
    "browser_action": {
      "default_title": "Press Ctrl(Win)/Command(Mac)+Shift+Right/Left to flip tabs"
    }
  ...
 }
</pre>
<p>
  Tooltips can also be set or updated by calling
  <a href="/browserAction#method-setTitle">
  <code>browserAction.setTitle</code></a> and
  <a href="/pageAction#method-setTitle">
  <code>pageAction.setTitle</code></a>.
</p>
<pre data-filename="background.js">
  chrome.browserAction.onClicked.addListener(function(tab) {
    chrome.browserAction.setTitle({tabId: tab.id, title: "You are on tab:" + tab.id});
  });
</pre>
<p>
  Specialized locale strings are implemented with
  <a href="/i18n">Internationalization</a>.
  Create directories to house language specific messages
  within a folder called <code>_locales</code>.
  The following image shows a filepath for an extension that supports english
  and spanish locales.
</p>
<img src="{{static}}/images/user_interface/locales_messages.png"
  height="50"
  alt="File structure for locale strings" />
<p>
  <a href="/i18n-messages">Format messages</a> inside of each language's
  <code>messages.json</code>.
</p>
<pre data-filename="en/messages.json">
  {
    "__MSG_tooltip__": {
        "message": "Hello!",
        "description": "Tooltip Greeting."
    }
  }
</pre>
<pre data-filename="es/messages.json">
  {
    "__MSG_tooltip__": {
        "message": "Hola!",
        "description": "Tooltip Greeting."
    }
  }
</pre>
<p>
  Include the name of the message in the tooltip field instead of the message
  to enable localization.
</p>
<pre data-filename="manifest.json">
  {
  "name": "Tab Flipper",
   ...
    "browser_action": {
      "default_title": "__MSG_tooltip__"
    }
  ...
 }
</pre>

<h3 id="omnibox">Omnibox</h3>
<p>
  Users can interact with an extension through the
  <a href="/omnibox">omnibox</a>
  by including the omnibox field in the manifest
  and registering a keyword.
  The
<a href="https://developer.chrome.com/extensions/samples#search:omnibox%20new">
  Omnibox New Tab Search</a>
  sample extension uses "nt" as the keyword.
</p>
<!-- Possible reduce example to relevant fields -->
<pre data-filename="manifest.json">
  {
    "name": "Omnibox New Tab Search",\
    ...
    <b>"omnibox": { "keyword" : "nt" },</b>
      "default_icon": {
        <b>"16": "newtab_search16.png",</b>
        "32": "newtab_search32.png"
        }
    ...
  }
</pre>
<p>
  When the user types "nt" into the omnibox,
  it activates the extension.
  To signal this to the user,
  it greyscales the provided 16x16 icon
  and includes it in the omnibox next to the extension name.
</p>
<img src="{{static}}/images/user_interface/omnibox.png"
  alt="Active Omnibox" />

<p>
  When the listen event for <a href="/omnibox#event-onInputEntered">
    <code>omnibox.onInputEntered</code></a>
  is triggered, the extension will open a new tab containing
  a Google search for the uers entry,
  instead of opening the results in the current tab.
</p>
<pre data-filename="background.js">
chrome.omnibox.onInputEntered.addListener(function(text) {
  // Encode user input for special characters , / ? : @ & = + $ #
  var newURL = 'https://www.google.com/search?q=' + encodeURIComponent(text);
  chrome.tabs.create({ url: newURL });
});
</pre>

<h3 id="context_menu">Context Menu</h3>
<p>
  Users can interact with an extension through a
  <a href="/contextMenus">context menu</a> option by
  granting permission to API in the manifest.
</p>
<pre data-filename="manifest.json">
  {
    "name": "Global Google Search",
    ...
    <b>"permissions": ["contextMenus",</b> "storage"],

    "icons": {
     <b>"16": "globalGoogle16.png",</b>
     "48": "globalGoogle48.png",
    "128": "globalGoogle128.png"
   }
   ...
  }
</pre>
<p>
  The 16x16 icon is displayed next to the new menu entry.
</p>
<img src="{{static}}/images/user_interface/contexticon.png"
  height="300"
  alt="Context Menu Icon" />
<p>
  Create a context menu by calling
  <a href="/contextMenus#method-create"><code>contextMenus.create</code></a>
  in the <a href="/background_pages">background script</a>.
  This should be done under the
  <a href="/runtime#event-onInstalled"><code>runtime.onInstalled</code></a>
  listener event.
</p>
<pre data-filename="background.js">
  chrome.runtime.onInstalled.addListener(function() {
    for (let key of Object.keys(kLocales)) {
      chrome.contextMenus.create({
        id: key,
        title: kLocales[key],
        type: 'normal',
        contexts: ['selection'],
      });
    }
  });
</pre>
<pre data-filename="locales.js">
  const kLocales = {
    'com.au': 'Australia',
    'com.br': 'Brazil',
    'ca': 'Canada',
    'cn': 'China',
    'fr': 'France',
    'it': 'Italy',
    'co.in': 'India',
    'co.jp': 'Japan',
    'com.ms': 'Mexico',
    'ru': 'Russia',
    'co.za': 'South Africa',
    'co.uk': 'United Kingdom'
  };
</pre>
<p>
  The Global Google Search context menu example
  creates multiple options from the list in
  <a
  href="/extensions/examples/api/contextMenus/global_context_search/locales.js">
    locales.js</a>.
  When an extension contains more than one context menu,
  Google Chrome automatically collapses them into a single parent menu.
</p>
<img src="{{static}}/images/user_interface/contextmenu.png"
  height="300"
  alt="Context Menu Icon" />

<h3 id="commands">Commands</h3>
<p>
  Extensions can define specific <a href="/commands">commands</a>
  and bind them to a key combination.
  Register one or more commands in the manifest under the commands field.
</p>
<pre data-filename="manifest.json">
  {
    "name": "Tab Flipper",
    ...
    "commands": {
      "flip-tabs-forward": {
        "suggested_key": {
          "default": "Ctrl+Shift+Right",
          "mac": "Command+Shift+Right"
        },
        "description": "Flip tabs forward"
      },
      "flip-tabs-backwards": {
        "suggested_key": {
          "default": "Ctrl+Shift+Left",
          "mac": "Command+Shift+Left"
        },
        "description": "Flip tabs backwards"
      }
    }
    ...
  }
</pre>
<p>
  Commands can be used to provide an alternative browser shortcut.
  <!-- TODO link to extension when live -->
  The <a href="">Tab Flipper</a> provides a new key combinations to
  switch tabs, which must be defined in a
  <a href="/background_pages">background script</a>.
</p>
<pre data-filename="background.js">
  chrome.commands.onCommand.addListener(function(command) {
    chrome.tabs.query({currentWindow: true}, function(tabs) {
      // Sort tabs according to their index in the window.
      tabs.sort((a, b) => { return a.index < b.index; });
      let activeIndex = tabs.findIndex((tab) => { return tab.active; });
      let lastTab = tabs.length - 1;
      let newIndex = -1;
      if (command === 'flip-tabs-forward')
        newIndex = activeIndex === 0 ? lastTab : activeIndex - 1;
      else  // 'flip-tabs-backwards'
        newIndex = activeIndex === lastTab ? 0 : activeIndex + 1;
      chrome.tabs.update(tabs[newIndex].id, {active: true, highlighted: true});
    });
  });
</pre>
<p>
  Commands can also create a key binding
  that works specially with its extension.
  The
  <!-- TODO link to hello extensions when it goes live -->
  <a href="">Hello Extensions</a> example gives a command to open the popup.
</p>
<pre data-filename="manifest.json">
  {
    "name": "Hello Extensions",
    "description" : "Base Level Extension",
    "version": "1.0",
    <b>"browser_action"</b>: {
      "default_popup": "hello.html",
      "default_icon": "hello_extensions.png"
    },
    "manifest_version": 2,
    "commands": {
      <b>"_execute_browser_action"</b>: {
        "suggested_key": {
          "default": "Ctrl+Shift+F",
          "mac": "MacCtrl+Shift+F"
        },
        "description": "Opens hello.html"
      }
    }
  }
</pre>

<p>
  Because the extension defines a
  <a href="/user_interface#browser"><code>broswer_action</code></a>
  it can specify
  <code>execute_browser_action</code> in the commands to open the popup file
  without including a <a href="/background_pages">background script</a>.
  If using
  <a href="/user_interface#page"><code>page_action</code></a>,
  it can be replaced with <code>execute_page_action</code>.
  Both browswer and extension commands can be used in the same extension.
</p>

<h3 id="override">Override Pages</h3>
<p>
  An extension can override and replace the History, New Tab, or Bookmarks page
  with a custom HTML file.
  Register the page in the manifest
</p>
<pre data-filename="manifest.json">
  {
    "name": "Awesome Override Extension",
    ...

    "chrome_url_overrides" : {
      "newtab": "override_page.html"
    },
    ...
  }
</pre>
<p>
  The "newtab" field should be replaed with <code>bookmarks</code> or
  <code>history</code> when overriding those pages.
  Like all extensions, this file cannot contain inline JavaScript,
  but can include script tags to JS files.
</p>
<pre data-filename="override_page.html">
  &lt;html&gt;
   &lt;head&gt;
    &lt;title&gt;New Tab&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
      &lt;h1&gt;Hello World&lt;/h1&gt;
    &lt;script src="logic.js">&lt;/script&gt;
   &lt;/body&gt;
  &lt;/html&gt;
</pre>
