{
  "comments": [
    {
      "key": {
        "uuid": "55a22652_19393eb0",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1115895
      },
      "writtenOn": "2018-01-19T00:32:26Z",
      "side": 1,
      "message": "Is it possible to lazily create this when needed at raster time?",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06159779_b72fc8ce",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1145109
      },
      "writtenOn": "2018-01-19T00:37:24Z",
      "side": 1,
      "message": "Yeah, I found this plumbing kinda awkward too. We used to create skia objects lazily but had to switch to creating at paint object construction time to avoid weird race conditions (crbug.com/771156).",
      "parentUuid": "55a22652_19393eb0",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "74ec1a4b_369973be",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1115895
      },
      "writtenOn": "2018-01-19T01:38:36Z",
      "side": 1,
      "message": "I thought through that too, but these are all on temporary flags that don\u0027t stick around.  I don\u0027t think the bool vs lazy intialization of shaders on these temporary flags makes a difference wrt race conditions.  Am I missing something?",
      "parentUuid": "06159779_b72fc8ce",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ec93242_a452755f",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1145109
      },
      "writtenOn": "2018-01-19T03:02:05Z",
      "side": 1,
      "message": "I started adding a thread checker instead to remove this bool and realized we still need the image provider to build the picture shader. Eventually it ends up getting accessed here in SkPaint conversion during raster (https://cs.chromium.org/chromium/src/cc/paint/paint_flags.cc?type\u003dcs\u0026sq\u003dpackage:chromium\u0026l\u003d118) which has no image provider. . .",
      "parentUuid": "74ec1a4b_369973be",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9feb2c98_cea4ffa3",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1145109
      },
      "writtenOn": "2018-01-19T03:04:32Z",
      "side": 1,
      "message": "I can may be just restrict the setting to ScopedRasterFlags and have it call CreateSkShader based on it?",
      "parentUuid": "5ec93242_a452755f",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "12b145d0_78812c35",
        "filename": "cc/paint/paint_shader.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1145109
      },
      "writtenOn": "2018-01-19T19:59:15Z",
      "side": 1,
      "message": "So I just let ScopedRasterFlags decide whether a skia shader is required. Since the in process raster case needs to pass an image provider to generate the temp SkPicture used during raster, I had to at least pass the setting there.",
      "parentUuid": "9feb2c98_cea4ffa3",
      "revId": "592b53d683c78c83ae6e30aa3fe431943d21962e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}