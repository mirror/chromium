{
  "comments": [
    {
      "key": {
        "uuid": "ab1f66a2_62acdac2",
        "filename": "components/cronet/android/java/src/org/chromium/net/impl/JavaUrlRequest.java",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1002888
      },
      "writtenOn": "2017-07-21T15:58:52Z",
      "side": 1,
      "message": "Always calling execute() is a little wasteful.  We could avoid it if mRunning is true but we\u0027d need to first check if the underlying ExecutorService.isShutdown() is true which means we\u0027d need to pass the ExecutorService into this class.  We could also avoid it if the underlying ExecutorService.isShutdown() is true but we\u0027d first need to pass the ExecutorService into this class.  I think always calling execute() is a reasonable trade-off of performance for simplicity.",
      "range": {
        "startLine": 180,
        "startChar": 59,
        "endLine": 180,
        "endChar": 0
      },
      "revId": "a1031446e9aa872690bc3d15a0781abea9513c7c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7cc6ed2_42aaccc5",
        "filename": "components/cronet/android/java/src/org/chromium/net/impl/JavaUrlRequest.java",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1140228
      },
      "writtenOn": "2017-07-21T16:05:02Z",
      "side": 1,
      "message": "The other benefit of always calling execute is that we don\u0027t have to do anything to prevent interrupts from leaking into subsequent tasks - that\u0027s handled by the executor we\u0027re delegating to. \n\nRather than trying to fix behavior in case of shutdown, would it make more sense to not shut down the thread pool until all the outstanding requests have finished their tasks?",
      "parentUuid": "ab1f66a2_62acdac2",
      "range": {
        "startLine": 180,
        "startChar": 59,
        "endLine": 180,
        "endChar": 0
      },
      "revId": "a1031446e9aa872690bc3d15a0781abea9513c7c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c4bb0374_c733105d",
        "filename": "components/cronet/android/java/src/org/chromium/net/impl/JavaUrlRequest.java",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1002888
      },
      "writtenOn": "2017-07-21T17:50:03Z",
      "side": 1,
      "message": "I\u0027m not sure there\u0027s an easy way for JavaCronetEngine to know if the ExecutorService is finished executing tasks;  I think we\u0027d have to add a whole bunch of additional bookkeeping to figure out which JavaUrlRequests finished.  I like my proposed fix because SerializingExecutor doesn\u0027t really change the shutdown semantics:  All tasks submitted before shutdown() is called will execute.",
      "parentUuid": "e7cc6ed2_42aaccc5",
      "range": {
        "startLine": 180,
        "startChar": 59,
        "endLine": 180,
        "endChar": 0
      },
      "revId": "a1031446e9aa872690bc3d15a0781abea9513c7c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90c1aa8d_11ed569b",
        "filename": "components/cronet/android/java/src/org/chromium/net/impl/JavaUrlRequest.java",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1140228
      },
      "writtenOn": "2017-07-21T19:58:47Z",
      "side": 1,
      "message": "There would be bookkeeping, but all of the bookkeeping would just be a refcount - increment when requests start, decrement when they complete.",
      "parentUuid": "c4bb0374_c733105d",
      "range": {
        "startLine": 180,
        "startChar": 59,
        "endLine": 180,
        "endChar": 0
      },
      "revId": "a1031446e9aa872690bc3d15a0781abea9513c7c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc8b8671_6afb4009",
        "filename": "components/cronet/android/java/src/org/chromium/net/impl/JavaUrlRequest.java",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1002888
      },
      "writtenOn": "2017-07-24T13:04:02Z",
      "side": 1,
      "message": "I prototyped the extra bookkeeping way: https://chromium-review.googlesource.com/c/582397\nIMHO the extra bookkeeping way feels like a band-aid for the broken SerializingExecutor shutdown behavior.  It adds a fair bit of complexity.\nMy vote is for this CL, and not the extra bookkeeping way.  WDYT?",
      "parentUuid": "90c1aa8d_11ed569b",
      "range": {
        "startLine": 180,
        "startChar": 59,
        "endLine": 180,
        "endChar": 0
      },
      "revId": "a1031446e9aa872690bc3d15a0781abea9513c7c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}