{
  "comments": [
    {
      "key": {
        "uuid": "7224407c_5fcdea07",
        "filename": "device/hid/hid_device_info.h",
        "patchSetId": 8
      },
      "lineNbr": 36,
      "author": {
        "id": 1113896
      },
      "writtenOn": "2017-07-17T15:58:43Z",
      "side": 0,
      "message": "Follow the pattern of UsbDevice and have HidDeviceInfo generate its own ID on construction (instead of having it assigned by HidService). You can keep the platform ID in HidDeviceInfo as well so you don\u0027t need to use the mappings as often.",
      "range": {
        "startLine": 36,
        "startChar": 16,
        "endLine": 36,
        "endChar": 45
      },
      "revId": "f66aae2d690ff7d3d22bfd086a203bb5e9ce80a4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1b2946b0_0dd22f2c",
        "filename": "device/hid/hid_device_info.h",
        "patchSetId": 8
      },
      "lineNbr": 36,
      "author": {
        "id": 1177311
      },
      "writtenOn": "2017-07-17T23:30:40Z",
      "side": 0,
      "message": "I removed the HidPlatformDeviceId from HidDeviceInfo because the HidDeviceInfo will be passed as parameter of mojo interface. So we don\u0027t need to add typemapp for HidPlatformDeviceId(which is uint64 or char[] on different platforms) in some traits.cc",
      "parentUuid": "7224407c_5fcdea07",
      "range": {
        "startLine": 36,
        "startChar": 16,
        "endLine": 36,
        "endChar": 45
      },
      "revId": "f66aae2d690ff7d3d22bfd086a203bb5e9ce80a4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e7316fd_27b09dfb",
        "filename": "device/hid/hid_device_info.h",
        "patchSetId": 8
      },
      "lineNbr": 36,
      "author": {
        "id": 1113896
      },
      "writtenOn": "2017-07-17T23:42:31Z",
      "side": 0,
      "message": "HidDeviceInfo will only be sent from the service implementation to clients so I think it\u0027s okay if some information is lost in translation. For example, HidDeviceInfoLinux adds extra Linux-specific fields which will also not be typemapped.\n\nLong term I suggest not using a typemap and having HidDeviceInfo contain internal fields like the platform device ID and a pointer to the Mojo struct which can be cloned when sending device information through Mojo. That will make it more clear which fields are not part of the Mojo interface but are still critical to the functionality of the HID service implementation.",
      "parentUuid": "1b2946b0_0dd22f2c",
      "range": {
        "startLine": 36,
        "startChar": 16,
        "endLine": 36,
        "endChar": 45
      },
      "revId": "f66aae2d690ff7d3d22bfd086a203bb5e9ce80a4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcce5ddb_39fb60e2",
        "filename": "extensions/test/data/api_test/hid/get_user_selected_devices/background.js",
        "patchSetId": 12
      },
      "lineNbr": 14,
      "author": {
        "id": 1177311
      },
      "writtenOn": "2017-07-20T10:32:08Z",
      "side": 0,
      "message": "Finally I found why the HidApiTest.GetUserSelectedDevices is flaky:\n\nThe device_infos are stored in the map of HidService. Before my change, the key of the map is \"A\" \"B\" \"C\", so the device_info are always well sorted, HidService will send onDeviceAdded() notification to HidDeviceManager in sequences as \"A\" \"B\" \"C\". So the device[0] in above JavaScript code always points to \"A\".\n\nAfter my change, the key of map is the random GUID string, so the sequence is random, and device[0] is random. So we cannot always assume \"A\" is the user selected device anymore.\n\nI made some change on this test, but still feel it is not good: the removed/added device is not the device returned by getUserSelectedDevices().\nAnother idea is: remove 2 devices, only 1 device left when runnning the Javascript code, then we can remove/add on the only 1 device.\nCould you please give some comments on this? Thanks!",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 35
      },
      "revId": "f66aae2d690ff7d3d22bfd086a203bb5e9ce80a4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed9bd5bc_b99bcc09",
        "filename": "extensions/test/data/api_test/hid/get_user_selected_devices/background.js",
        "patchSetId": 12
      },
      "lineNbr": 14,
      "author": {
        "id": 1113896
      },
      "writtenOn": "2017-07-20T14:20:44Z",
      "side": 0,
      "message": "How about giving each test device a separate serial number and then having TestDevicePermissionsPrompt always select a particular device when you don\u0027t ask for multiple selections?",
      "parentUuid": "bcce5ddb_39fb60e2",
      "range": {
        "startLine": 14,
        "startChar": 6,
        "endLine": 14,
        "endChar": 35
      },
      "revId": "f66aae2d690ff7d3d22bfd086a203bb5e9ce80a4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}