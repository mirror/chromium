{
  "comments": [
    {
      "key": {
        "uuid": "4dd2006b_b61d4e82",
        "filename": "/COMMIT_MSG",
        "patchSetId": 11
      },
      "lineNbr": 25,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-10-26T15:37:39Z",
      "side": 1,
      "message": "Recomputing occlusion at every step of the animation seems unnecessary. Shouldn\u0027t it be sufficient to compute at the start, and/or at the end of animations?",
      "revId": "d5a6521f03397f544aff018eb0d0254406780ba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c2aaf4b_959fdd9e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 11
      },
      "lineNbr": 25,
      "author": {
        "id": 1002897
      },
      "writtenOn": "2017-10-27T16:05:56Z",
      "side": 1,
      "message": "WindowOcclusionTracker::OnWindowTransformed() will be called at every step of the animation, but it will only recompute occlusion when there is no transform animation or when a transform animation just started [1]. I updated the CL description to make this clearer.\n\nAn alternative solution would be to rename OnWindowTransformed() to OnWindowTargetTransformChanged() and to call it whenever the target transform of a window changes (today, it isn\u0027t called when the target transform changes without a call to aura::Window::SetTransform). That would require adding ui::LayerAnimationDelegate::OnTargetTransformChanged() and making sure that ui::LayerAnimator calls it whenever the target transform changes (i.e. when a LayerAnimationSequence that affects TRANSFORM is added/removed to/from the queue and when SetTransformFromAnimation is called without an animation [2]). ui::Layer would forward that notification to ui::LayerDelegate::OnLayerTargetTransformChanged() which would forward it to aura::WindowObserver;:OnWindowTargetTransformChanged().\n\nWhat solution do you prefer? I like the current solution because:\n- It is consistent to have both OnWindowBoundsChanged() and OnWindowTransformChanged().\n- I would prefer not adding complexity to LayerAnimator.\n\n[1] https://chromium-review.googlesource.com/c/chromium/src/+/679206/22/ui/aura/window_occlusion_tracker.cc#408\n[2] https://cs.chromium.org/chromium/src/ui/compositor/layer_animator.cc?l\u003d95\u0026rcl\u003d1af275b69022aeb7326bcd81d50045c2adbb37f9",
      "parentUuid": "4dd2006b_b61d4e82",
      "revId": "d5a6521f03397f544aff018eb0d0254406780ba4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}