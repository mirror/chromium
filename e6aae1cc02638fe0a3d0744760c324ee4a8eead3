{
  "comments": [
    {
      "key": {
        "uuid": "470991c6_4411078c",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 58,
      "author": {
        "id": 1002272
      },
      "writtenOn": "2017-11-02T03:22:25Z",
      "side": 1,
      "message": "Nit: spelling",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dc9ff31_d43c52d4",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 58,
      "author": {
        "id": 1133035
      },
      "writtenOn": "2017-11-05T23:42:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "470991c6_4411078c",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2cb4fe08_a5a41284",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 148,
      "author": {
        "id": 1002272
      },
      "writtenOn": "2017-11-02T03:22:25Z",
      "side": 1,
      "message": "Nit: I wouldn\u0027t include this TODO in the code, as I think there is a chance we\u0027ll just leave it like this forever.",
      "range": {
        "startLine": 148,
        "startChar": 22,
        "endLine": 148,
        "endChar": 28
      },
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80786e4b_09836b98",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 148,
      "author": {
        "id": 1133035
      },
      "writtenOn": "2017-11-05T23:42:27Z",
      "side": 1,
      "message": "I\u0027m worried that we are breaking a well-defined contract of target\u003d_self links. Developers assume that once a user clicks a target\u003d_self link the current context will be navigated to the target. I think it\u0027s OK to do so for the MVP but I would like to revisit the decision afterwards.",
      "parentUuid": "2cb4fe08_a5a41284",
      "range": {
        "startLine": 148,
        "startChar": 22,
        "endLine": 148,
        "endChar": 28
      },
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd19c994_c545e68d",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 148,
      "author": {
        "id": 1002272
      },
      "writtenOn": "2017-11-06T01:43:24Z",
      "side": 1,
      "message": "OK, understood. Personally I\u0027d leave out the TODO and just have a bug as it is the kind of TODO that could live forever, but that\u0027s just an opinion.",
      "parentUuid": "80786e4b_09836b98",
      "range": {
        "startLine": 148,
        "startChar": 22,
        "endLine": 148,
        "endChar": 28
      },
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b8d44b6f_554dd782",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 212,
      "author": {
        "id": 1002272
      },
      "writtenOn": "2017-11-02T03:22:25Z",
      "side": 1,
      "message": "What prevents this opening a new app window if matching_app_ref is the same as the current app?",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db3853aa_1e0e25cd",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 212,
      "author": {
        "id": 1133035
      },
      "writtenOn": "2017-11-05T23:42:27Z",
      "side": 1,
      "message": "That would be the origin check on line 178. If the target\u0027s origin is the same as the current\u0027s page origin then don\u0027t redirect the navigation.",
      "parentUuid": "b8d44b6f_554dd782",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "138cc307_6b96b227",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 212,
      "author": {
        "id": 1002272
      },
      "writtenOn": "2017-11-06T01:43:24Z",
      "side": 1,
      "message": "Ah, OK. Origin !\u003d PWA scope though, so this could result in not opening in another app\u0027s window. Interestingly it won\u0027t stop same-origin, out-of-pwa-scope but no other app isntalled navigations opening in the browser which feels kind of inconsistent.\n\nBTW this function is getting really long which makes it hard to follow. I\u0027d suggest something like:\n\nauto this_app, target_app;\n\nif (this_app \u003d\u003d target_app)\n  // do nothing, navigation to the same app or no app to no app\nelse if (target_app)\n  // open in target app window\nelse if (this_app)\n  // open in browser tab.\n\nWith anything substantial (e.g. open in target app window) in a sub function.",
      "parentUuid": "db3853aa_1e0e25cd",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "41108ccb_fff5a82e",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 212,
      "author": {
        "id": 1133035
      },
      "writtenOn": "2017-11-08T00:34:44Z",
      "side": 1,
      "message": "\u003e Ah, OK. Origin !\u003d PWA scope though, so this could result in not opening in another app\u0027s window. Interestingly it won\u0027t stop same-origin, out-of-pwa-scope but no other app isntalled navigations opening in the browser which feels kind of inconsistent.\n\u003e \n\nWhat do you think of the new behavior which sort of matches Android:\n\n1. If in a regular tab -\u003e don\u0027t redirect same origin navigations (Android uses host instead).\n2. If in an app tab -\u003e don\u0027t redirect same scope navigations (out of scope navigations will be redirected; this matches Android).\n\n\u003e BTW this function is getting really long which makes it hard to follow. I\u0027d suggest something like:\n\u003e \n\u003e auto this_app, target_app;\n\u003e \n\u003e if (this_app \u003d\u003d target_app)\n\u003e   // do nothing, navigation to the same app or no app to no app\n\u003e else if (target_app)\n\u003e   // open in target app window\n\u003e else if (this_app)\n\u003e   // open in browser tab.\n\u003e \n\u003e With anything substantial (e.g. open in target app window) in a sub function.\n\nThanks for the suggestion! Done.",
      "parentUuid": "138cc307_6b96b227",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7a53b9c0_4332b9d7",
        "filename": "chrome/browser/extensions/bookmark_app_navigation_throttle.cc",
        "patchSetId": 6
      },
      "lineNbr": 212,
      "author": {
        "id": 1133035
      },
      "writtenOn": "2017-11-08T00:37:38Z",
      "side": 1,
      "message": "In case you\u0027re curious about Android:\n\n1. For WebAPKs to not open other in-scope links in a new WebAPK[1]\n2. For regular tabs to not open in-scope links if the host is the same (not origin, just host)[2]\n\n[1] https://cs.chromium.org/chromium/src/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java?rcl\u003ddb0e590542ca41876ea92d6b9413073e9fb0ef46\u0026l\u003d263\n[2] \nhttps://cs.chromium.org/chromium/src/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java?rcl\u003ddb0e590542ca41876ea92d6b9413073e9fb0ef46\u0026l\u003d456",
      "parentUuid": "41108ccb_fff5a82e",
      "revId": "e6aae1cc02638fe0a3d0744760c324ee4a8eead3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}