{
  "comments": [
    {
      "key": {
        "uuid": "01e9c63b_9f7714bf",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 232,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-02T18:57:30Z",
      "side": 1,
      "message": "base::TimeTicks?",
      "range": {
        "startLine": 232,
        "startChar": 4,
        "endLine": 232,
        "endChar": 14
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5125a447_ec0a9d70",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 232,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T19:56:18Z",
      "side": 1,
      "message": "Will fix.",
      "parentUuid": "01e9c63b_9f7714bf",
      "range": {
        "startLine": 232,
        "startChar": 4,
        "endLine": 232,
        "endChar": 14
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c6152dca_5f892f96",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 232,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T21:45:35Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5125a447_ec0a9d70",
      "range": {
        "startLine": 232,
        "startChar": 4,
        "endLine": 232,
        "endChar": 14
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f8e8ec7_c16b740e",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-02T18:57:30Z",
      "side": 1,
      "message": "This bug isn\u0027t world viewable, so there is no point in adding a reference to it.\n\nDisabling the OK button for one second seems supremely annoying. Can you elaborate on the nature of the attach? Feel free to email directly if you prefer.",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b337c78_5b2d3767",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T19:56:18Z",
      "side": 1,
      "message": "The bug will become world-readable a number of weeks after the patch lands. I\u0027ve added you to the CC list on the issue.",
      "parentUuid": "9f8e8ec7_c16b740e",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33f318b0_f167e440",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T21:45:35Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0b337c78_5b2d3767",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "06eceac4_63df6c32",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-02T23:18:48Z",
      "side": 1,
      "message": "Thanks for adding me to the cc. Shouldn\u0027t we attempt to reenable the button after key repeat rate? Otherwise it\u0027s pretty mysterious as to why the button is disabled and what needs to happen.",
      "parentUuid": "33f318b0_f167e440",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "aafcda2b_9222d9fb",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T23:26:57Z",
      "side": 1,
      "message": "Unfortunately, I don\u0027t think we have a good way to do so-- we could maybe try to keep track of the enabled state (because sometimes Windows intentionally disables the button if the user has e.g. an unselectable folder selected) but I don\u0027t know of a good place to PostMessage since we\u0027re in the middle of a blocking UI call. I suppose we could spawn a task/thread to do the countdown and send, but that level of complexity seems risky.",
      "parentUuid": "06eceac4_63df6c32",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8e2995a_0a4b9e61",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-03T00:27:07Z",
      "side": 1,
      "message": "Doesn\u0027t a timer work here? Maybe starting the timer the first time BFFM_INITIALIZED is called? If windows disabled the button, what happens when you call BFFM_ENABLEOK with TRUE? Does it allow the enable?",
      "parentUuid": "aafcda2b_9222d9fb",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "61a27970_ea25f7d5",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-03T17:31:05Z",
      "side": 1,
      "message": "Yes, there\u0027s probably some way that we could get a timer to reenable the button (checks if the window handle still exists, and if so, sends the message). However, this does introduce a question as to how long such a timer would need to be set-- how long do we have to wait for the user to recognize the dialog and release the key? If we guess too short, the acceptance still occurs.\n\nIf we call BFFM_ENABLEOK with TRUE, it enables the button unconditionally, even if the button would\u0027ve been disabled because an \"unselectable\" folder is selected. (This isn\u0027t disastrous, insofar as if the user selects such a folder, nothing bad seems to happen.) \n\nOne approach to consider might be looking at doing mitigations only when the enter key is down, which would limit the mitigations to scenarios where gesture-jacking might be occurring. We could add such a check in the existing approach.\n\nIt\u0027s tempting to scrap all of the code in this CL and just add:\n\n  while (GetAsyncKeyState(VK_RETURN) \u003c 0)\n    base::PlatformThread::Sleep(base::TimeDelta::FromMilliseconds(20));\n\n...immediately before the SHBrowseForFolder() call, but the attacker would probably just change the attack from \"Hold Enter\" to \"Press Enter five times to prove you\u0027re human.\"",
      "parentUuid": "b8e2995a_0a4b9e61",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fed9de86_25be0cb1",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 536,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-03T21:57:33Z",
      "side": 1,
      "message": "At some point you have to trust the user though. For example, the text could say, \u0027press enter and select c:\\ to prove you\u0027re a human.\u0027 At what point are you trusting the user? It is likely possible to subclass the window created by the dialog to see key/mouse events so that you could reenable the button at some point, but this is no doubt tricky.",
      "parentUuid": "61a27970_ea25f7d5",
      "range": {
        "startLine": 536,
        "startChar": 11,
        "endLine": 536,
        "endChar": 35
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1b62346_9022479a",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 542,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2018-01-02T18:57:30Z",
      "side": 1,
      "message": "Don\u0027t you need to reenable at some point?",
      "range": {
        "startLine": 542,
        "startChar": 6,
        "endLine": 542,
        "endChar": 51
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "234df7f6_eaa46d10",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 542,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T19:56:18Z",
      "side": 1,
      "message": "Windows re-enables the button when the user selects a folder.",
      "parentUuid": "d1b62346_9022479a",
      "range": {
        "startLine": 542,
        "startChar": 6,
        "endLine": 542,
        "endChar": 51
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65a584ea_656702b5",
        "filename": "ui/shell_dialogs/select_file_dialog_win.cc",
        "patchSetId": 4
      },
      "lineNbr": 542,
      "author": {
        "id": 1166820
      },
      "writtenOn": "2018-01-02T21:45:35Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "234df7f6_eaa46d10",
      "range": {
        "startLine": 542,
        "startChar": 6,
        "endLine": 542,
        "endChar": 51
      },
      "revId": "70faa8048c2337fc5510748c254304e37dac630a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}