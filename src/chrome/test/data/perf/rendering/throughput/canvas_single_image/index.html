<html>
<head>
<title>Canvas - Single Image</title>
<style>
  #sprite {
    visibility: hidden;
  }
</style>
<script type="text/javascript">
window.onload = init;

var kNumSprites = 2500;
var kSpriteSpeed = 2;

var raf;
var canvas;
var context;
var sprite;
var xMax;
var yMax;

function init() {
  canvas = document.getElementById('canvas');
  context = canvas.getContext('2d');
  
  initSprites();

  raf = window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame;
  tick();
};

function initSprites() {
  var spriteEl = document.getElementById('sprite');
  xMax = canvas.width - spriteEl.width;
  yMax = canvas.height - spriteEl.height;

  sprite = new Array();
  for (var i = 0; i < kNumSprites; ++i) {
    sprite[i] = { img: spriteEl,
                  x: Math.random() * xMax,
                  y: Math.random() * yMax,
                  dx: kSpriteSpeed * (Math.random() < .5 ? -1 : 1),
                  dy: kSpriteSpeed * (Math.random() < .5 ? -1 : 1) };
  }
};

function drawSprites() {
  for (var i = 0; i < kNumSprites; ++i) {
    sprite[i].x += sprite[i].dx;
    if ((sprite[i].x > xMax) || (sprite[i].x < 0))
      sprite[i].dx *= -1;

    sprite[i].y += sprite[i].dy;
    if ((sprite[i].y > yMax) || (sprite[i].y < 0))
      sprite[i].dy *= -1;
 
    context.drawImage(sprite[i].img, sprite[i].x, sprite[i].y);
  };
};

function tick() {
  draw();
  raf(tick, canvas);
};

function draw() {
  context.clearRect(0, 0, canvas.width, canvas.height);
  drawSprites();
};
</script>
</head>

<body>
  <canvas id="canvas" width="800" height = "600">
  <img id="sprite" src="http://farm3.staticflickr.com/2578/4176075327_b710931ef5_s.jpg" width="75" height="75">
</body>
</html>
