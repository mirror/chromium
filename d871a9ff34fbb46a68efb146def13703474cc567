{
  "comments": [
    {
      "key": {
        "uuid": "989ff5a4_a05884ce",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 267,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-09T21:56:28Z",
      "side": 1,
      "message": "thoughts on using an activity-alias like above targeting org.chromium.chrome.browser.document.ChromeLauncherActivity?  The alias could be default disabled and then the intent dispatching logic could go into LaunchIntentDispatcher?  I\u0027m wondering if we can centralize it (and again, whether it is worth it).  Just my initial quick thought.",
      "range": {
        "startLine": 267,
        "startChar": 9,
        "endLine": 267,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4254596c_078d7dce",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 267,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-09T23:07:20Z",
      "side": 1,
      "message": "My initial reaction is no, we want to keep this separated. If we send the Intent through the LaunchIntentDispatcher, we\u0027ll have to have logic in there to filter precisely those Intents and dispatch them in this way. The filtering logic would have to be run on every Intent launched by Chrome in the LaunchIntentDispatcher::dispatch() method, which has the following comment:\n\n\"Figure out how to route the Intent.  Because this is on the critical path to startup, please avoid making the pathway any more complicated than it already is. Make sure that anything you add _absolutely has_ to be here.\"\n\nEssentially we\u0027d combine it with the other Intents just to do work to re-extract them, which seems less than ideal. WDYT?",
      "parentUuid": "989ff5a4_a05884ce",
      "range": {
        "startLine": 267,
        "startChar": 9,
        "endLine": 267,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d2894da_6197756d",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 267,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-10T19:08:25Z",
      "side": 1,
      "message": "That makes sense.  Having it all in the LaunchIntentDispatcher is nice purely as a centralized handler of all intents, but the fact that this is so specific to one particular type makes me think it isn\u0027t worth adding the complexity there.\n\nAs a small nit, should this be call MediaLauncher or MediaIntentDispatcher to be more consistent with the corollary of the non-media intents?",
      "parentUuid": "4254596c_078d7dce",
      "range": {
        "startLine": 267,
        "startChar": 9,
        "endLine": 267,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "baff8880_b9c6a36f",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 267,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T23:39:25Z",
      "side": 1,
      "message": "Changed to MediaLauncherActivity",
      "parentUuid": "2d2894da_6197756d",
      "range": {
        "startLine": 267,
        "startChar": 9,
        "endLine": 267,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6c405ce0_51cd6766",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 276,
      "author": {
        "id": 1115974
      },
      "writtenOn": "2018-01-10T16:57:56Z",
      "side": 1,
      "message": "Why not also \"audio/*\"?",
      "range": {
        "startLine": 276,
        "startChar": 40,
        "endLine": 276,
        "endChar": 45
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "08685526_4de1c9da",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 276,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T19:14:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6c405ce0_51cd6766",
      "range": {
        "startLine": 276,
        "startChar": 40,
        "endLine": 276,
        "endChar": 45
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7ec2c927_6fd2c638",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 277,
      "author": {
        "id": 1115974
      },
      "writtenOn": "2018-01-10T16:57:56Z",
      "side": 1,
      "message": "Out of curiosity, why?",
      "range": {
        "startLine": 277,
        "startChar": 40,
        "endLine": 277,
        "endChar": 55
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "787e9a23_a82ea2c0",
        "filename": "chrome/android/java/AndroidManifest.xml",
        "patchSetId": 1
      },
      "lineNbr": 277,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T19:14:21Z",
      "side": 1,
      "message": "I\u0027m not entirely sure to be honest, but every online example of intent-filters for videos has this MIME type. Looking more into it, it looks like it\u0027s used for live-stream videos, which I\u0027m not entirely sure we\u0027re trying to support. Also, though I\u0027ve seen it in some places, on further inspection this is probably not necessary with video/* in there, so I\u0027m going to remove it for now. However, I don\u0027t think video/* is necessarily the ideal end-game, so I\u0027m also adding a TODO to update this filter to only list specific video/image/audio MIME types we support instead of using /* for each one.",
      "parentUuid": "7ec2c927_6fd2c638",
      "range": {
        "startLine": 277,
        "startChar": 40,
        "endLine": 277,
        "endChar": 55
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "80630ffe_c645949e",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1115974
      },
      "writtenOn": "2018-01-10T16:57:56Z",
      "side": 1,
      "message": "2018",
      "range": {
        "startLine": 1,
        "startChar": 13,
        "endLine": 1,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5dbfba7a_6efdb567",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T19:14:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "80630ffe_c645949e",
      "range": {
        "startLine": 1,
        "startChar": 13,
        "endLine": 1,
        "endChar": 17
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "710e30aa_3ac402c1",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-10T19:08:25Z",
      "side": 1,
      "message": "we should call IntentUtils.sanitizeIntent here",
      "range": {
        "startLine": 23,
        "startChar": 15,
        "endLine": 23,
        "endChar": 20
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed41dd59_ffa96864",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 23,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T23:39:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "710e30aa_3ac402c1",
      "range": {
        "startLine": 23,
        "startChar": 15,
        "endLine": 23,
        "endChar": 20
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab1cd482_86ff4438",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-10T19:08:25Z",
      "side": 1,
      "message": "we need to validate that the intent type is correct (i.e. is actually a media type an not something else).\n\nThe intent filter only handles the case where an implicit intent is sent, but someone could send an explicit intent to this activity to open an arbitrary webpage.",
      "range": {
        "startLine": 25,
        "startChar": 26,
        "endLine": 25,
        "endChar": 44
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a4f0565_600f6257",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T23:27:59Z",
      "side": 1,
      "message": "Makes sense. Would it be sufficient to check that the MIME type starts with \"video/\", \"audio/\", or \"image/\"? Or is it necessary to also forge a path to blink::IsSupportedMimeType?",
      "parentUuid": "ab1cd482_86ff4438",
      "range": {
        "startLine": 25,
        "startChar": 26,
        "endLine": 25,
        "endChar": 44
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e5f487d_e7e6cef0",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 25,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-11T18:43:36Z",
      "side": 1,
      "message": "We\u0027ll have to do something java only.  We can\u0027t guarantee that we have native initialized at this point, so you wouldn\u0027t want to add any native dependencies here.\n\nThis is likely a question for dtrainor@, but we should also add similar restrictions in CustomTabActivity to ensure we don\u0027t load web pages when it is a media intent.  I wonder what happens if you rename index.html -\u003e index.jpg.  Does Chrome realize it\u0027s a page and still attempt to render it or would it correctly reject that?  I guess once we start supporting content URIs the mime type could be wrong and it could be a good avenue for bypassing any checks (in particular, we don\u0027t show the URL in that mode, so we really don\u0027t want that to be publicly exposed).\n\nHonestly, this is likely something we\u0027ll want security to take a look at once we all get agreement on.",
      "parentUuid": "0a4f0565_600f6257",
      "range": {
        "startLine": 25,
        "startChar": 26,
        "endLine": 25,
        "endChar": 44
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "75bdb35c_9b173114",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-10T19:08:25Z",
      "side": 1,
      "message": "typically we use this for when chrome launches an intent from within it\u0027s own UI (and we don\u0027t use this in LaunchIntentDispatcher).  Why do you need this here?",
      "range": {
        "startLine": 32,
        "startChar": 22,
        "endLine": 32,
        "endChar": 51
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "849d5068_7d0e7041",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1231235
      },
      "writtenOn": "2018-01-10T22:57:33Z",
      "side": 1,
      "message": "That\u0027s the way DownloadUtils is firing the MediaViewerUtils.getMediaViewerIntent Intent, so I was assuming we\u0027d want the same here. This actually fires the CustomTabActivity Intent through the LaunchIntentDispatcher and not directly. If it needs to change here, I\u0027d assume it needs to change inside DownloadUtils as well. WDYT?",
      "parentUuid": "75bdb35c_9b173114",
      "range": {
        "startLine": 32,
        "startChar": 22,
        "endLine": 32,
        "endChar": 51
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5bb4aa57_6707f130",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/media/MediaViewerActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2018-01-11T18:43:36Z",
      "side": 1,
      "message": "I\u0027ll let dtrainor@ answer this.  I\u0027d like to know why it\u0027s needed.\n\nLooks like CustomTabIntentDataProvider only sets mEnableEmbeddedMediaExperience to true if it\u0027s a trusted activity.  Since this UI hides the security state indicators, we only use this from content with Chrome.  I think we\u0027ll need some sign off that it is ok to show this for external content as well.  Let\u0027s add rsesek@ to this once we get the pieces in place.",
      "parentUuid": "849d5068_7d0e7041",
      "range": {
        "startLine": 32,
        "startChar": 22,
        "endLine": 32,
        "endChar": 51
      },
      "revId": "d871a9ff34fbb46a68efb146def13703474cc567",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}