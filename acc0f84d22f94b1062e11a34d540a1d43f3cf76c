{
  "comments": [
    {
      "key": {
        "uuid": "ca29d0e4_73a3da30",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1003330
      },
      "writtenOn": "2018-01-17T23:25:04Z",
      "side": 1,
      "message": "Why is this change needed? I think instead we need a helper function on CompositorFilterOperations to determine whether the filter can turn null pixels into non-null, and expand the visual rect of its paired display items accordingly (determined by the difference between the output clip and layer clip).",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "069d9216_e1b54a4f",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2018-01-17T23:33:21Z",
      "side": 1,
      "message": "I think your method would need much code than this. The above change works without needing blink to deal with visual rects of paired cc display items. They are updated automatically with the existing visual rect logic of drawing display items. For empty filters, we already must create a no-op drawing display item to ensure a non-empty chunk with the property state containing the filter.",
      "parentUuid": "ca29d0e4_73a3da30",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "850200f5_64c7506e",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1003330
      },
      "writtenOn": "2018-01-17T23:43:20Z",
      "side": 1,
      "message": "Problem is the expansion is always needed regardless whether there is painted content or not. For example, we can have a filter that paste a 100x100 image, while the enclosing content is 1x1. In this case, the union of the visual rects will be 1x1 despite the filter\u0027s actual output is 100x100.\n\n\u003cdiv style\u003d\"filter:url(something_paste_an_image); width:100px; height:100px;\"\u003e\n  \u003cdiv style\u003d\"width:1px; height:1px; background:green;\"\u003e\u003c/div\u003e\n\u003c/div\u003e",
      "parentUuid": "069d9216_e1b54a4f",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ac8ee03f_375edcab",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2018-01-17T23:48:13Z",
      "side": 1,
      "message": "We will calculate correct visual rect using MapRectFromChunkToLayer which will consider the filter expansion. See the previous CL https://chromium-review.googlesource.com/c/chromium/src/+/868954.",
      "parentUuid": "850200f5_64c7506e",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "29cc8066_11200a4a",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1003330
      },
      "writtenOn": "2018-01-17T23:59:05Z",
      "side": 1,
      "message": "I see. It is a bit counter-intuitive but I\u0027m convinced this will work.\n\nBTW can we add a DCHECK(record || display_item.type \u003d\u003d DrawingFilterDummy)? If not, could you add a comment to list the circumstances where record can be nullptr?",
      "parentUuid": "ac8ee03f_375edcab",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b125bb1b_becce49c",
        "filename": "third_party/WebKit/Source/platform/graphics/compositing/PaintChunksToCcLayer.cpp",
        "patchSetId": 3
      },
      "lineNbr": 33,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2018-01-18T02:37:38Z",
      "side": 1,
      "message": "Added comment explaining why BeginPaint and EndPaintOfUnpaired are called regardless of whether record is null.\n\nIt\u0027s not easy to list all circumstances where record is null. When working on SPv1 I measured and reduced the them to a very low percentage (\u003c1%), but they may still happen anywhere when a DrawingRecorder is created but the enclosed code paints nothing under certain conditions.",
      "parentUuid": "29cc8066_11200a4a",
      "revId": "acc0f84d22f94b1062e11a34d540a1d43f3cf76c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}