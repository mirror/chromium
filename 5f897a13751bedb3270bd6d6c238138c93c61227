{
  "comments": [
    {
      "key": {
        "uuid": "46220e76_3b707fd6",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 160,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "#include gtest",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24f9eb37_a22dec74",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 160,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "46220e76_3b707fd6",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b2ffd667_521bab00",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 183,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Can we pull out the hash computation so it isn\u0027t done for every loop iteration?",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5585ea1_495ebbbb",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 183,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b2ffd667_521bab00",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5af06af9_1495f958",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 235,
      "author": {
        "id": 1215055
      },
      "writtenOn": "2017-07-05T20:38:42Z",
      "side": 1,
      "message": "Same issue as for ExpectMetric below.",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a9b869df_71ff6413",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 235,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "I think HasMetric is ok - it just asserts that there\u0027s at least one instance of the given metric. I will add a version that returns the number of metric samples as well, and will address the ExpectMetric comment below.",
      "parentUuid": "5af06af9_1495f958",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65a52cfb_b95f761c",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 235,
      "author": {
        "id": 1215055
      },
      "writtenOn": "2017-07-05T22:51:04Z",
      "side": 1,
      "message": "Okay, that sounds fine to me.",
      "parentUuid": "a9b869df_71ff6413",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "022551b1_7fcc3bcc",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1215055
      },
      "writtenOn": "2017-07-05T20:38:42Z",
      "side": 1,
      "message": "Implementing ExpectMetric this way will break unit tests for users of UKM that generate multiple entries for the same source ID with the same metrics inside them but different metric values for each entry because TestUkmRecorder::FindMetric will always return the first instance of the metric in the merged entry.\n\nThere should be a way to verify individual entries as ExpectMetric previously did. If this new behavior is desired, I would suggest creating a second method for verifying an individual entry  (e.g. ExpectMetricInEntry).",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a48ff6c_8d5108b1",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Thanks! I\u0027ve added a variant that allows for verifying multiple metrics with the same name were logged.\n\nI do not want tests to make assumptions about the order that metrics are provided to tests in, so I\u0027m trying to clean up the test API to avoid this going forward.",
      "parentUuid": "022551b1_7fcc3bcc",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d250243b_a3a55d4e",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1215055
      },
      "writtenOn": "2017-07-05T22:51:04Z",
      "side": 1,
      "message": "Is the expectation that UKM entries will always be merged on source ID into a single entry at the server, or will it be possible to examine the individual entries that were generated? Based on the example on the Detailed Design section and example on page 7 of go/ukm-api, it seems like it is the latter, in which case there could reasonably be a need to test that a specific combination of metric values were generated within a single entry.\n\nTo accommodate tests for such cases and prevent them from assuming the order of the entries or metrics, maybe it would make sense to add a method ExpectEntry that checks if an entry with a given set of metric values is present:\n\nvoid UkmTester::ExpectEntry(const ukm::UkmSource\u0026 source, const char* event, const std::vector\u003cUkmMetric\u003e\u0026 expected_metric_values);",
      "parentUuid": "0a48ff6c_8d5108b1",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba9fb0dd_78739709",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-06T00:42:26Z",
      "side": 1,
      "message": "You\u0027re absolutely right - I had been focusing on the case where there was just one entry per source, since that\u0027s how PageLoad works, but it should be allowed to retain the individual entries as well. I\u0027ll make changes to support this case, as it\u0027s important for your case and any other similar cases. Thanks!",
      "parentUuid": "d250243b_a3a55d4e",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8174d5ba_049e9849",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-06T14:30:03Z",
      "side": 1,
      "message": "I added an ExpectEntry() method. The signature is slightly different, both to ease implementation and to improve test readability. See what you think, thanks!",
      "parentUuid": "ba9fb0dd_78739709",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "905eba62_9b793ec5",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.cc",
        "patchSetId": 4
      },
      "lineNbr": 248,
      "author": {
        "id": 1215055
      },
      "writtenOn": "2017-07-06T15:57:47Z",
      "side": 1,
      "message": "LGTM, thanks!",
      "parentUuid": "8174d5ba_049e9849",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "effe1a6d_19bb8055",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Can we put this in a separate file? The functionality is sufficient enough that I think it\u0027ll make things more readable.",
      "range": {
        "startLine": 34,
        "startChar": 8,
        "endLine": 34,
        "endChar": 17
      },
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "708daf34_5cca4568",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 34,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "effe1a6d_19bb8055",
      "range": {
        "startLine": 34,
        "startChar": 8,
        "endLine": 34,
        "endChar": 17
      },
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9a992bec_ed182ab1",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "nit: don\u0027t inline the constructor",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed1565b1_615b6752",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "happy to make the change but not clear to me why. can you share the reason not to do this?",
      "parentUuid": "9a992bec_ed182ab1",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b63d6a8_f12d0852",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T22:10:06Z",
      "side": 1,
      "message": "Sure:\nhttps://www.chromium.org/developers/coding-style/cpp-dos-and-donts\n\nSee section \"Stop inlining constructors and destructors\"",
      "parentUuid": "ed1565b1_615b6752",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7bd04849_70796307",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:18:01Z",
      "side": 1,
      "message": "Thanks! It is sad that compilers can\u0027t optimize this away. You probably know this, but an inline function is a hint to the compiler rather than a requirement that the given function be inlined. It\u0027s also interesting that this is inconsistent with the Google style guide.",
      "parentUuid": "7b63d6a8_f12d0852",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "939c7b97_008afc86",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 36,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T23:38:32Z",
      "side": 1,
      "message": "Technically it isn\u0027t against our guide to violate this, but it is suggested.\n\nWe also have [1] to generate a style error for constructors that will generate a lot of inlined code.\n\n[1]: https://www.chromium.org/developers/coding-style/chromium-style-checker-errors#TOC-Constructor-Destructor-Errors",
      "parentUuid": "7bd04849_70796307",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "316982f2_d8b2b7b3",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 38,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Might want to explain that this swaps out the global UKM recorder. I wouldn\u0027t be opposed to naming it as such either.",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "84b9df94_3556d17b",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 38,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "I decided to move ownership for the recorder to the parent, and pass in a test recorder to the constructor.",
      "parentUuid": "316982f2_d8b2b7b3",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24b5175a_dbf5cf06",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Number of UKMSources recorded.",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "893d9b65_a1be1c37",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 42,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done. I added \"UKM\" to the comment - the intent is to talk at a high level about sources and entries, rather than referring to specific class types, so I used \"UKM sources\" rather than UkmSources here.",
      "parentUuid": "24b5175a_dbf5cf06",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "34995b86_aaa34c88",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Number of {UKMEntrys, UKMEntries} recorded. Pick which formality you care about :)",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a574b8fc_e059d60a",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 45,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "34995b86_aaa34c88",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2c76773d_018f8ff7",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 50,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "#include \u003cvector\u003e",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95b31b58_b2613afe",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 50,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2c76773d_018f8ff7",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e3b2f7e1_a3a44051",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "#include \"base/compiler_specific.h\"",
      "range": {
        "startLine": 53,
        "startChar": 43,
        "endLine": 53,
        "endChar": 61
      },
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e9925771_0c418645",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 53,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e3b2f7e1_a3a44051",
      "range": {
        "startLine": 53,
        "startChar": 43,
        "endLine": 53,
        "endChar": 61
      },
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09385678_64d4c58e",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 55,
      "author": {
        "id": 1142059
      },
      "writtenOn": "2017-07-05T18:21:28Z",
      "side": 1,
      "message": "Can you document these three methods? I\u0027m not quite sure what |event| or |name| is (admittedly I don\u0027t know this code very well).",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "29ab357d_a21bae33",
        "filename": "chrome/browser/page_load_metrics/observers/page_load_metrics_observer_test_harness.h",
        "patchSetId": 4
      },
      "lineNbr": 55,
      "author": {
        "id": 1136769
      },
      "writtenOn": "2017-07-05T22:05:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "09385678_64d4c58e",
      "revId": "5f897a13751bedb3270bd6d6c238138c93c61227",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}