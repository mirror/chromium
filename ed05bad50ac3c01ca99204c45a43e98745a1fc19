{
  "comments": [
    {
      "key": {
        "uuid": "bb2f1a63_15996869",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-18T20:55:50Z",
      "side": 1,
      "message": "Where does the 76 come from?",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f148d8a9_7e2f985b",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-19T07:28:47Z",
      "side": 1,
      "message": "I don\u0027t really like that part, as I mentioned in the description. I just logged the proper offset when the bug is fixed and used it. Akin to screenshot tests, really.",
      "parentUuid": "bb2f1a63_15996869",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "397a784a_4f60e0aa",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T17:25:26Z",
      "side": 1,
      "message": "The problem with hard coding 76 is that it doesn\u0027t take into account any other changes we do. Why do you need any value here, can\u0027t you just make sure it moves?",
      "parentUuid": "f148d8a9_7e2f985b",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "826e2f60_e72cdb88",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-21T21:21:20Z",
      "side": 1,
      "message": "It does move in master, just not enough.",
      "parentUuid": "397a784a_4f60e0aa",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "233d5ab2_38b5a5c3",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T22:21:29Z",
      "side": 1,
      "message": "Is there an API you can use to get the exact location?",
      "parentUuid": "826e2f60_e72cdb88",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0ccefcab_6835f6b0",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-22T07:21:56Z",
      "side": 1,
      "message": "Exact location of selection box can be obtained through FindBarView and related objects, but as the bug is that find bar components receive incorrect coordinates, the test would pass even without the fix. To be honest, I don\u0027t really like something like that either, but can\u0027t come up with anything that would be more generic, yet check if the bug is fixed (so it would fail without the patch, and pass with it).",
      "parentUuid": "233d5ab2_38b5a5c3",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bfaae01d_a119547b",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-22T18:01:55Z",
      "side": 1,
      "message": "I was thinking more of an api to get the location of the text on the page. That\u0027s the important part, right? You want to make sure the find bar doesn\u0027t obscure the text on the page you are search for.",
      "parentUuid": "0ccefcab_6835f6b0",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f71765b1_94dcf664",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 79,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-23T06:43:55Z",
      "side": 1,
      "message": "That action would require assistance from renderer, and while I found some functions that could theoretically help in WebLocalFrame, I don\u0027t see any relevant existing messages that we could send to RenderFrameImpl aside from those that act on find in page (such as return closest find selection rect). And when we need a current active find in page rect, pretty much the only place to get it from would be by either asking the FindBarHost/FindBarView or subscribing to FindTabHelper. Both are pretty unreliable, as FindBarHost/FindBarView get the info from FindTabHelper, and the bug was precicely that it gave incorrect iformation. Without changing WebContentsImpl, Browser, or FindRequestManager (all of them just pass the information along to FindTabHelper without using or storing it) we cannot get the right selection_rect info.",
      "parentUuid": "bfaae01d_a119547b",
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24bab9db_f699cf51",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1586,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-18T20:55:50Z",
      "side": 1,
      "message": "private: DISALLOW...",
      "range": {
        "startLine": 1586,
        "startChar": 0,
        "endLine": 1586,
        "endChar": 2
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b124cf0_4f8f4350",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1586,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-21T07:18:24Z",
      "side": 1,
      "message": "The test class FindInPageDPITest inherits from (FindInPageControllerTest) doesn\u0027t have one. Should it be fixed for both, or is there a specific reason the parent doesn\u0027t need it and this one does?",
      "parentUuid": "24bab9db_f699cf51",
      "range": {
        "startLine": 1586,
        "startChar": 0,
        "endLine": 1586,
        "endChar": 2
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b1848ba_98e1d98e",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1586,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T17:18:43Z",
      "side": 1,
      "message": "Both please.",
      "parentUuid": "9b124cf0_4f8f4350",
      "range": {
        "startLine": 1586,
        "startChar": 0,
        "endLine": 1586,
        "endChar": 2
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8ec49b02_7c76e415",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1586,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-21T21:21:20Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2b1848ba_98e1d98e",
      "range": {
        "startLine": 1586,
        "startChar": 0,
        "endLine": 1586,
        "endChar": 2
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4757bfdd_483112ae",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1591,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T17:25:26Z",
      "side": 1,
      "message": "I tend to think this test is overkill and is likely to be more pain to keep working. All you want to verify is that display::Screen::GetScreen()-\u003eScreenToDIPRectInWindow is called. Surely there is a more direct way to verify that?",
      "range": {
        "startLine": 1591,
        "startChar": 0,
        "endLine": 1591,
        "endChar": 65
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a15bf6d_a7ef446c",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1591,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-21T21:21:20Z",
      "side": 1,
      "message": "But what if in future this behavior changes (afaik there is a lot of refactoring involving DIPs in Aura/Views), and also then we can\u0027t run the test for Macs?",
      "parentUuid": "4757bfdd_483112ae",
      "range": {
        "startLine": 1591,
        "startChar": 0,
        "endLine": 1591,
        "endChar": 65
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6da0833_a3f2be37",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1606,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-18T20:55:50Z",
      "side": 1,
      "message": "How do you know the findbar is fully visible at this point?",
      "range": {
        "startLine": 1606,
        "startChar": 1,
        "endLine": 1606,
        "endChar": 69
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d41078be_ea681e2b",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1606,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-19T07:28:47Z",
      "side": 1,
      "message": "The test itself is mostly taken from FindInPageControllerTest.FindMovesWhenObscuring. We can be sure that the find bar is fully visible because we do RunUntilIdle.",
      "parentUuid": "d6da0833_a3f2be37",
      "range": {
        "startLine": 1606,
        "startChar": 1,
        "endLine": 1606,
        "endChar": 69
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9455c808_70ae8f8c",
        "filename": "chrome/browser/ui/find_bar/find_bar_host_browsertest.cc",
        "patchSetId": 3
      },
      "lineNbr": 1606,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T17:18:43Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "d41078be_ea681e2b",
      "range": {
        "startLine": 1606,
        "startChar": 1,
        "endLine": 1606,
        "endChar": 69
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2bcc5c4b_98f8f631",
        "filename": "chrome/browser/ui/find_bar/find_tab_helper.cc",
        "patchSetId": 3
      },
      "lineNbr": 172,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-18T20:55:50Z",
      "side": 1,
      "message": "Why does this only apply to windows and linux? Assuming we actually ran this code on mac, won\u0027t it equally apply there?",
      "range": {
        "startLine": 172,
        "startChar": 4,
        "endLine": 172,
        "endChar": 40
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c08ff0e9_a8863e32",
        "filename": "chrome/browser/ui/find_bar/find_tab_helper.cc",
        "patchSetId": 3
      },
      "lineNbr": 172,
      "author": {
        "id": 1239649
      },
      "writtenOn": "2017-08-19T07:28:47Z",
      "side": 1,
      "message": "ScreenMac does not define own version of Screen::ScreenToDIPRectInWindow. Mac OS, as I understand does not have any resizing issues because they always use native pixels.",
      "parentUuid": "2bcc5c4b_98f8f631",
      "range": {
        "startLine": 172,
        "startChar": 4,
        "endLine": 172,
        "endChar": 40
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c97c4c15_b45c8f7b",
        "filename": "chrome/browser/ui/find_bar/find_tab_helper.cc",
        "patchSetId": 3
      },
      "lineNbr": 172,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-08-21T17:25:26Z",
      "side": 1,
      "message": "That seems surprising to me. I\u0027m adding tapted for his thoughts.",
      "parentUuid": "c08ff0e9_a8863e32",
      "range": {
        "startLine": 172,
        "startChar": 4,
        "endLine": 172,
        "endChar": 40
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bdecb961_7029ca4d",
        "filename": "chrome/browser/ui/find_bar/find_tab_helper.cc",
        "patchSetId": 3
      },
      "lineNbr": 172,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-08-22T00:15:17Z",
      "side": 1,
      "message": "Hm. Mac has \"screen coordinates\" and \"window base coordinates\" (DIPs). -[NSWindow convertRectFromScreen:] is probably what gets called in Cocoa code -- https://developer.apple.com/documentation/appkit/nswindow/1419603-convertrectfromscreen\n\n(screen coordinates are sometimes \"native pixels\", but less so now since new laptop models use scaling by default. But screen coordinates are always 1x or 2x DIPs.)\n\n\nMac+Cocoa doesn\u0027t seem to be affected by this bug.\n\n\nI suspect that although find_notification_details.h and frame_messages.h both say this selection rect is \"screen coordinates\" it\u0027s actually \"root frame coordinates\"\n. From\n\n    WebRect selection_rect \u003d OwnerFrame().GetFrameView()-\u003eContentsToRootFrame(\n        active_match_-\u003eBoundingBox());\n    ReportFindInPageSelection(selection_rect, active_match_index_ + 1,\n                              identifier);\n\n\nin TextFinder.cpp .\n\n(Certainly, I didn\u0027t spot anything offsetting the origin until the logic gets to FindBarHost::GetDialogPosition().\n\nSo I think Mac must use DIPs for root frame coordinates in Blink? But I don\u0027t know too much about blink...\n\n\nThat works for Cocoa since the cocoa browser is positioning an NSView -- not an NSWindow -- and so it wants DIPs.\n\nBut for toolkit-views, FindBarHost is positioning a window, and so it actually wants screen coordinates. And I think this is the case on Mac -- (the find bar on mac_views_browser \u003d true does some crazy stuff, so I think it is also affected).\n\n\n\nSo! I think this logic really belongs in chrome/browser/ui/views/find_bar_host.cc . That\u0027s the place in the UI code that differs between the find-in-page UI being a subview of the parent window (Mac+Cocoa), and a child bubble window (views browser).\n\n\n\nWe should also update the documentation for |selection_bounds| in frame_messages.h and find_notification_details.h -- navigating all this find stuff was really confusing :/  (I *think* I got it right..)",
      "parentUuid": "c97c4c15_b45c8f7b",
      "range": {
        "startLine": 172,
        "startChar": 4,
        "endLine": 172,
        "endChar": 40
      },
      "revId": "ed05bad50ac3c01ca99204c45a43e98745a1fc19",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}