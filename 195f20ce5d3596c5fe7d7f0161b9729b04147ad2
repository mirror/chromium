{
  "comments": [
    {
      "key": {
        "uuid": "fc956a7d_6cb96197",
        "filename": "chrome/browser/ui/webui/policy_tool_ui_handler.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1136204
      },
      "writtenOn": "2017-10-05T20:51:19Z",
      "side": 1,
      "message": "Hey is there a way this could be used to delete other files, outside of the expected files.\ni.e. can ../../ or similar be used? If that is protected against, could you point me to where that happens for this code?\nIs it reasonable to have tests containing ../ or $HOME or similar for this code?",
      "revId": "195f20ce5d3596c5fe7d7f0161b9729b04147ad2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa2dbe4e_55b78882",
        "filename": "chrome/browser/ui/webui/policy_tool_ui_handler.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1233031
      },
      "writtenOn": "2017-10-05T21:28:07Z",
      "side": 1,
      "message": "The name is passed from javascript, which takes it from the \u003cselect\u003e element, and the sessions list is passed from backend, which generates this list as the list of filenames in the sessions directory that have specific extension (see GetSessionsList, line 62 in this file).\n\nThe only way I can see to delete files elsewhere is to add an \u003coption\u003e element to the list manually (e.g. in javascript from console), choose this new option and click delete. Do you think we need to do an additional check for this kind of scenario?",
      "parentUuid": "fc956a7d_6cb96197",
      "revId": "195f20ce5d3596c5fe7d7f0161b9729b04147ad2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3e0360b6_257bbedf",
        "filename": "chrome/browser/ui/webui/policy_tool_ui_handler.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1136204
      },
      "writtenOn": "2017-10-05T21:53:14Z",
      "side": 1,
      "message": "If there\u0027s any way a third party (not the user) could alter the contents of that list; Or if there\u0027s a way for a third party to send a \"deleteSession\" message to this code, then we should defend against improper use.\n\nIt\u0027s okay to be safe instead of sorry by defending against improper use, even if we don\u0027t think it can be used by a third party.\n\nPlease add a security reviewer to the CL. They could help decide what\u0027s necessary.",
      "parentUuid": "fa2dbe4e_55b78882",
      "revId": "195f20ce5d3596c5fe7d7f0161b9729b04147ad2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f317809_3858fe89",
        "filename": "chrome/browser/ui/webui/policy_tool_ui_handler.cc",
        "patchSetId": 3
      },
      "lineNbr": 249,
      "author": {
        "id": 1000640
      },
      "writtenOn": "2017-10-06T06:52:19Z",
      "side": 1,
      "message": "Anton, I think you can avoid to worry about this issue if you modify your code so that the session list is stored in the code and only indices inside this list are sent back to the code. That way a malicious actor can only ever clear all entries in the list but can never exploit this interface to delete arbitrary files on disk.",
      "parentUuid": "3e0360b6_257bbedf",
      "revId": "195f20ce5d3596c5fe7d7f0161b9729b04147ad2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}