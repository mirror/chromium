{
  "comments": [
    {
      "key": {
        "uuid": "7753f5be_3027b479",
        "filename": "content/renderer/media_capture_from_element/canvas_capture_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 164,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-11-07T21:41:28Z",
      "side": 1,
      "message": "This condition makes me sad because Unpremul almost never happens. Only case I can think of is if the source canvas has a WebGL context created with the option {premultipliedAlpha \u003d false;}\nIn the case where the image is opaque (alpha \u003d 255 everywhere), there is no difference between premul and unpremul, so you could catch more cases with this fast path by checking for:\n\n... \u0026\u0026 (pixmap.alphaType() \u003d\u003d kUnpremul_SkAlphaType || image-\u003eisOpaque())",
      "range": {
        "startLine": 164,
        "startChar": 28,
        "endLine": 164,
        "endChar": 49
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3fc5db6_19455f61",
        "filename": "content/renderer/media_capture_from_element/canvas_capture_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 164,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Thanks for the pointer. I changed it here and l.248.",
      "parentUuid": "7753f5be_3027b479",
      "range": {
        "startLine": 164,
        "startChar": 28,
        "endLine": 164,
        "endChar": 49
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "064e1b23_8d9f531e",
        "filename": "content/renderer/media_capture_from_element/canvas_capture_handler.h",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1002076
      },
      "writtenOn": "2017-11-08T03:23:50Z",
      "side": 1,
      "message": "nit: Both these args should be passed by value, per current style guidelines:\n\n  void SendFrame(scoped_refptr\u003cmedia::VideoFrame\u003e video_frame,\n                 base::TimeTicks current_time);\n\nNote that, in all cases, you are already providing an rvalue video_frame argument in all your calls to SendFrame(). So, there shouldn\u0027t be any extra ref-count thrashing.",
      "range": {
        "startLine": 104,
        "startChar": 17,
        "endLine": 105,
        "endChar": 52
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "01092647_8dbbc263",
        "filename": "content/renderer/webgraphicscontext3d_provider_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 50,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-11-07T20:43:24Z",
      "side": 1,
      "message": "std::make_unique pls",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "653b6085_a4fbdbb3",
        "filename": "content/renderer/webgraphicscontext3d_provider_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 50,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "01092647_8dbbc263",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a37d77e_6c8bf88a",
        "filename": "content/renderer/webgraphicscontext3d_provider_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 77,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-11-07T20:43:24Z",
      "side": 1,
      "message": "no need to do this, the whole provider will need to be deleted. best not to create UAF possibilities, IMO. normally a lost context does not mean it is deleted. Only in ImageTransportFactory is that a thing that happens, elsewhere code often cleans up textures and stuff (needlessly) on the dead context to avoid writing different shutdown paths. I\u0027d prefer if GLTHelper is consistent with the rest of this class.",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2af16909_08145973",
        "filename": "content/renderer/webgraphicscontext3d_provider_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 77,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Removed it. I am not sure what do you mean by making GLHelper consistent with the rest. This class looks mostly like a container for |provider_|.",
      "parentUuid": "3a37d77e_6c8bf88a",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c4360bc5_0f90c882",
        "filename": "content/renderer/webgraphicscontext3d_provider_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 77,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-11-07T22:14:43Z",
      "side": 1,
      "message": "provider_ is not nulled, neither is gl_helper_.",
      "parentUuid": "2af16909_08145973",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "08d5af84_089901e9",
        "filename": "content/test/data/media/canvas_capture_color.html",
        "patchSetId": 5
      },
      "lineNbr": 189,
      "author": {
        "id": 1002076
      },
      "writtenOn": "2017-11-08T03:23:50Z",
      "side": 1,
      "message": "nit (simpler promise chain structure, fewer LOC): How about:\n\n  doCanvasCaptureAndCheckRgba(contextType, RED)\n      .then(function() {\n        window.internals.loseSharedGraphicsContext3D();\n        // For the canvas to realize its Graphics context was lost we must try\n        // to use the contents of the canvas.\n        var imageData \u003d canvas.getContext(contextType).getImageData(0, 0, 1, 1);\n        return draw(canvas, contextType, GREEN)\n            .then(doCanvasCaptureAndCheckRgba.bind(contextType, BLUE));\n      })\n      .then(function() {\n        window.domAutomationController.send(\u0027OK\u0027);\n      }, function(err) {\n        window.domAutomationController.send(err);\n      });",
      "range": {
        "startLine": 167,
        "startChar": 0,
        "endLine": 189,
        "endChar": 9
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd99729f_5d36757a",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 586,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-11-07T21:41:28Z",
      "side": 1,
      "message": "You can remove this code. bitmap_image is not even being used!  I did some digging, and it turns out you don\u0027t have to worry about mailboxing textures that come from a WebGL context.  The above call to GetSourceImageForCanvas always returns resources that are in the shared context. The mailboxing is handled deeper in DrawingBuffer::CopyToPlatformTexture",
      "range": {
        "startLine": 586,
        "startChar": 4,
        "endLine": 586,
        "endChar": 16
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a941ffd5_3ea0a538",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 586,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fd99729f_5d36757a",
      "range": {
        "startLine": 586,
        "startChar": 4,
        "endLine": 586,
        "endChar": 16
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d366c337_46006116",
        "filename": "third_party/WebKit/Source/platform/graphics/UnacceleratedStaticBitmapImage.cpp",
        "patchSetId": 5
      },
      "lineNbr": 41,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-11-07T21:41:28Z",
      "side": 1,
      "message": "I think this method is not needed.",
      "range": {
        "startLine": 41,
        "startChar": 51,
        "endLine": 41,
        "endChar": 66
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cd52b10e_9512012d",
        "filename": "third_party/WebKit/Source/platform/graphics/UnacceleratedStaticBitmapImage.cpp",
        "patchSetId": 5
      },
      "lineNbr": 41,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Not any more. Done.",
      "parentUuid": "d366c337_46006116",
      "range": {
        "startLine": 41,
        "startChar": 51,
        "endLine": 41,
        "endChar": 66
      },
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a3e84806_0bd4995a",
        "filename": "third_party/WebKit/public/platform/WebGraphicsContext3DProvider.h",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-11-07T20:43:24Z",
      "side": 1,
      "message": "Document that this can\u0027t return null (unlike GetGrContext which can if the context was lost before it\u0027s called), cuz this isn\u0027t a method that has an equivalent on ContextProvider makes documentation here more important - tho rly the rest could use it :)",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c9fc728d_022feea7",
        "filename": "third_party/WebKit/public/platform/WebGraphicsContext3DProvider.h",
        "patchSetId": 5
      },
      "lineNbr": 62,
      "author": {
        "id": 1123894
      },
      "writtenOn": "2017-11-07T22:12:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a3e84806_0bd4995a",
      "revId": "21d934d83865ccac9530ad4734e50f742ac67983",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}