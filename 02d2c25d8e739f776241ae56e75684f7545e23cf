{
  "comments": [
    {
      "key": {
        "uuid": "c475bb0b_e0ef8af1",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 139,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-07-13T10:31:23Z",
      "side": 1,
      "message": "DEFAULT_LOADING_CONTROL, if you absolutely must.",
      "range": {
        "startLine": 139,
        "startChar": 38,
        "endLine": 139,
        "endChar": 53
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b3e02377_73b04be8",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 139,
      "author": {
        "id": 1117099
      },
      "writtenOn": "2017-07-13T11:47:01Z",
      "side": 1,
      "message": "Obsolete, since the default queue was removed.",
      "parentUuid": "c475bb0b_e0ef8af1",
      "range": {
        "startLine": 139,
        "startChar": 38,
        "endLine": 139,
        "endChar": 53
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "260f4469_16ae0522",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 424,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-07-13T10:31:23Z",
      "side": 1,
      "message": "Setting priority to high constantly may cause some perf regressions, when we\u0027re using priorities to ensure that we do the right kind of work (e.g. to respond to user performance as fast as you can).\n\nI had a prototype of supporting something like this in one of the previous patch:\n- IsImportant flag in a task queue (https://chromium-review.googlesource.com/c/541404/1/third_party/WebKit/Source/platform/scheduler/base/task_queue.h#143)\n- Use this IsImportant flag to increase queue priority to high from normal if needed (https://chromium-review.googlesource.com/c/541404/1/third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc#1634).\n\nCould you do this?",
      "range": {
        "startLine": 424,
        "startChar": 2,
        "endLine": 424,
        "endChar": 28
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "daa5d829_a8818250",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 424,
      "author": {
        "id": 1117099
      },
      "writtenOn": "2017-07-13T11:47:01Z",
      "side": 1,
      "message": "I don\u0027t understand this one.... Is this about moving the \u0027high priority\u0027 into MainThreadTaskQueue::QueueCreationParams? That is, add an \"is important\" bool to the creation params, rather than creating the queue and setting it afterwards?\n\nOr do want a different/finer grained control of when to issue high priority tasks? In this case, I\u0027m not sure how.\n\n---\n\nThere was a good bit of discussion around this in email \u0026 previous rounds of the CL. For the tasks I want to prioritize (very short run-time, but important to trigger other work), I\u0027m quite sure I want the high priority. I was initially a bit sloppy about that and had other tasks in there, too, but after feedback this has been separated out quite cleanly, IMHO, and the tasks that go into the \u0027loading control\u0027 queue really are control tasks that should be executed ahead of other loading tasks.\n\nThere was some discussion about some asserting that the \"control\" tasks are really very short duration tasks, but I wouldn\u0027t be sure how to do this.\n\nIf it helps, the whole feature is behind a feature flag, so we can do experiments before launching.",
      "parentUuid": "260f4469_16ae0522",
      "range": {
        "startLine": 424,
        "startChar": 2,
        "endLine": 424,
        "endChar": 28
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b05bcdb_1cf8173d",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 424,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-07-14T08:10:45Z",
      "side": 1,
      "message": "Sorry, I haven\u0027t been clear enough. \n\nThe idea is that scheduler manages priorities of different queues (e.g. all loading tasks might have their priority decreases during user gesture) and just using SetQueuePriority isn\u0027t enough â€” this will be overwritten.\n\nThe solution that I propose is the following:\n- Have \"is important\" bit in MainThreadTaskQueue (similar to CanBeBlocked/CanBeThrottled/etc) and set it to true for LoadingControl queue.\n- Use this bit in RendererSchedulerImpl::TaskQueuePolicy::GetPriority to change policy priority from normal to high. (It will be so for 99% of the time, except for some critical moments like user gesture. I believe that it\u0027s what you want).",
      "parentUuid": "daa5d829_a8818250",
      "range": {
        "startLine": 424,
        "startChar": 2,
        "endLine": 424,
        "endChar": 28
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "21d9ca82_ab4c79d3",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.h",
        "patchSetId": 13
      },
      "lineNbr": 535,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-07-13T10:31:23Z",
      "side": 1,
      "message": "Do we need default loading control task queue? We are trying to move more loading tasks to per-frame task queues and I\u0027d like to avoid adding a new default queue.",
      "range": {
        "startLine": 535,
        "startChar": 37,
        "endLine": 535,
        "endChar": 72
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "65133cbb_eea33c7c",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/renderer_scheduler_impl.h",
        "patchSetId": 13
      },
      "lineNbr": 535,
      "author": {
        "id": 1117099
      },
      "writtenOn": "2017-07-13T11:47:01Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "21d9ca82_ab4c79d3",
      "range": {
        "startLine": 535,
        "startChar": 37,
        "endLine": 535,
        "endChar": 72
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "285a1014_653fc867",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/web_frame_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 170,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-07-13T10:31:23Z",
      "side": 1,
      "message": "Please add QueueType::FRAME_LOADING_CONTROL.",
      "range": {
        "startLine": 170,
        "startChar": 44,
        "endLine": 170,
        "endChar": 57
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f6c1d0f_1f866e30",
        "filename": "third_party/WebKit/Source/platform/scheduler/renderer/web_frame_scheduler_impl.cc",
        "patchSetId": 13
      },
      "lineNbr": 170,
      "author": {
        "id": 1117099
      },
      "writtenOn": "2017-07-13T11:47:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "285a1014_653fc867",
      "range": {
        "startLine": 170,
        "startChar": 44,
        "endLine": 170,
        "endChar": 57
      },
      "revId": "02d2c25d8e739f776241ae56e75684f7545e23cf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}