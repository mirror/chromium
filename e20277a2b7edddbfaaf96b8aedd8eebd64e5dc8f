{
  "comments": [
    {
      "key": {
        "uuid": "f97ff151_6052733f",
        "filename": "media/base/ipc/media_param_traits_macros.h",
        "patchSetId": 9
      },
      "lineNbr": 90,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T19:29:40Z",
      "side": 1,
      "message": "I\u0027m confused about why this is needed. You\u0027re not sending it over old IPC, and I expect mojo should be covered by the additions to media_types.typemap?",
      "range": {
        "startLine": 90,
        "startChar": 0,
        "endLine": 90,
        "endChar": 25
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d598c56_f46e88fc",
        "filename": "media/base/ipc/media_param_traits_macros.h",
        "patchSetId": 9
      },
      "lineNbr": 90,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Mojo still uses this file for validation. I know, I was also confused by that :)",
      "parentUuid": "f97ff151_6052733f",
      "range": {
        "startLine": 90,
        "startChar": 0,
        "endLine": 90,
        "endChar": 25
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "750fb8b0_4e945cf7",
        "filename": "media/blink/watch_time_reporter.cc",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T19:29:40Z",
      "side": 1,
      "message": "Don\u0027t think you have a |status| here. \n\nDo you have have a test to verify background reporter is getting the forwarded all the right signals?",
      "range": {
        "startLine": 159,
        "startChar": 38,
        "endLine": 159,
        "endChar": 44
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "900fcd7f_8f27ac78",
        "filename": "media/blink/watch_time_reporter.cc",
        "patchSetId": 9
      },
      "lineNbr": 159,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Deleted this since I realized this will impact our metrics on MTBR. Will have to separate this out to avoid fudging current UMA values.",
      "parentUuid": "750fb8b0_4e945cf7",
      "range": {
        "startLine": 159,
        "startChar": 38,
        "endLine": 159,
        "endChar": 44
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f80edc19_ff415993",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 191,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T19:29:40Z",
      "side": 1,
      "message": "I\u0027m confused about why we skip for non-\"All\" metrics - seems like we will be missing things in UKM that are reported to UMA. For instance, if the user is goes from AC -\u003e Battery in the middle of playback, the reporter will finalize just the power metrics. The recorder will skip UKM reporting but will send off UMAs and then remove the finalized AC keys from watch_time_info_ (line 170). Later on, when the video ends it we\u0027ll get the \"all\" keys and will report only the battery watch time to UKM. Am I missing something?",
      "range": {
        "startLine": 191,
        "startChar": 24,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f61318e_2ba3e0ca",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 191,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Nope, you reminded me why earlier patch sets had aggregate_watch_time_info instead. Switched to only finalizing on a complete finalize and summing the watch time across all partial finalize events.",
      "parentUuid": "f80edc19_ff415993",
      "range": {
        "startLine": 191,
        "startChar": 24,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "99233ce8_bbeabf54",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 191,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T22:53:34Z",
      "side": 1,
      "message": "ACK. I guess this means you have a gap in the unit tests ;)",
      "parentUuid": "0f61318e_2ba3e0ca",
      "range": {
        "startLine": 191,
        "startChar": 24,
        "endLine": 191,
        "endChar": 27
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f450f1f0_d7793b20",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 222,
      "author": {
        "id": 1124674
      },
      "writtenOn": "2017-08-30T01:43:41Z",
      "side": 1,
      "message": "While you are updating this, it would be good to switch to using the code generated API. (go/ukmapi)\n\nIt should be a fairly straightforward change:\n#include \"services/metrics/public/cpp/ukm_builders.h\"\n\nInstead of \nstd::unique_ptr\u003cukm::UkmEntryBuilder\u003e builder \u003d\n      ukm_recorder-\u003eGetEntryBuilder(source_id, kWatchTimeUkmEvent);\n\nuse\nukm::builders::Media_BasicPlayback builder(source_id);\nand later\nbuilder.record(ukm_recorder);\n\ninstead of \nbuilder-\u003eAddMetric(kUkmKeyIsBackground,\n                         kv.first \u003d\u003d WatchTimeKey::kAudioVideoBackgroundAll);\n\ndo\nbuilder.SetIsBackground(kv.first \u003d\u003d WatchTimeKey::kAudioVideoBackgroundAll);\n\nfor tests you can get the event and metric names from ukm_builders.h\n\nukm::builders::Media_BasicPlayback::kEntryName\nukm::builders::Media_BasicPlayback::kIsBackgroundName\n\nYou may want to use a local alias declaration:\nusing UkmEntry \u003d ukm::builders::Media_BasicPlayback;\nUkmEntry::kIsBackgroundName",
      "range": {
        "startLine": 222,
        "startChar": 6,
        "endLine": 222,
        "endChar": 71
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6241d7d1_48150bf2",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 222,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Very cool! This is much better than const char\u0027ing a bunch of strings :)",
      "parentUuid": "f450f1f0_d7793b20",
      "range": {
        "startLine": 222,
        "startChar": 6,
        "endLine": 222,
        "endChar": 71
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ae7b5cc_c88aa9ca",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 254,
      "author": {
        "id": 1129179
      },
      "writtenOn": "2017-08-30T19:29:40Z",
      "side": 1,
      "message": "Maybe add an else { ... } warning here to catch new metrics that need to be added to the builder?",
      "range": {
        "startLine": 254,
        "startChar": 5,
        "endLine": 254,
        "endChar": 0
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "910a239f_65654a3b",
        "filename": "media/mojo/services/watch_time_recorder.cc",
        "patchSetId": 9
      },
      "lineNbr": 254,
      "author": {
        "id": 1001250
      },
      "writtenOn": "2017-08-30T20:47:15Z",
      "side": 1,
      "message": "Can\u0027t, there are other keys in the watch time info struct, we\u0027re just ignoring them.",
      "parentUuid": "3ae7b5cc_c88aa9ca",
      "range": {
        "startLine": 254,
        "startChar": 5,
        "endLine": 254,
        "endChar": 0
      },
      "revId": "e20277a2b7edddbfaaf96b8aedd8eebd64e5dc8f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}