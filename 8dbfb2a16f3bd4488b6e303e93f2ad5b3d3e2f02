{
  "comments": [
    {
      "key": {
        "uuid": "c09637fd_96d97537",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 441,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "I think you need to check that virtualViewId equals mSelectionNodeId, and\nthat\u0027s it.",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4cdfcd66_353a5476",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 441,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c09637fd_96d97537",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "23b4782e_09f4919c",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 445,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "I don\u0027t think this is needed anymore...you should just pass\nvirtualViewId instead of nodeId below and there\u0027s no need to\ncheck if it\u0027s a text field or not.",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ad796920_9a3142a5",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 445,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "23b4782e_09f4919c",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a5f1059_fcedd24c",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 514,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "This doesn\u0027t look right, why did this need to change?\nWas it broken before, for granularity moves other than\neditable text?",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a445fa55_df363d81",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 514,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "The granularity move is broken for edit texts but not for other text nodes and my change might have adverse effect on other text nodes. I have made my change specific to edit texts, but incase this should be handled by talkback and not here, we can do that too.",
      "parentUuid": "3a5f1059_fcedd24c",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "903461a4_f326c48a",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 1102,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "This shouldn\u0027t be needed.",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "28b2e405_3d3174c9",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 1102,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "This is required as granularity move is broken when you add some letters in the middle of a word. The cursor index does not get updated.",
      "parentUuid": "903461a4_f326c48a",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4ae6b575_2675f623",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 1102,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2018-01-08T17:02:30Z",
      "side": 1,
      "message": "This is the wrong place to fix it, though.\n\nLet\u0027s figure out why the cursor index isn\u0027t getting updated when\nyou add letters in the middle of a word.\n\nsetAccessibilityEventTextChangedAttrs is just a function to\nset properties of an AccessibilityEvent. It\u0027s called by us when\nwe fire an AccessibilityEvent. If we\u0027re not updating\nmSelectionEndIndex correctly, we should fix that in whatever\nmethod was firing the AccessibilityEvent, not inside of one of\nthe helper methods that\u0027s just used to populate the event.",
      "parentUuid": "28b2e405_3d3174c9",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7e8b207_1ed518a9",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 1102,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-10T06:00:50Z",
      "side": 1,
      "message": "So what I see is, The actual text_changed event is fired by the android widget TextView.java, which I don\u0027t think we can change. That is then received by HandleEditableTextChanged in web_contents_accessibility_android.cc which then calls handleEditableTextChanged in WebContentsAccessibility.java and this is the place where we send the a11y event and then later event is built and attributes are updated. \n\nAnd same is the flow with selection_changed events. \n\nIn this process I don\u0027t see anywhere where we make an attempt to change the selection index. Where exactly you think I should be placing this?",
      "parentUuid": "4ae6b575_2675f623",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "18fcffed_41c8c401",
        "filename": "content/public/android/java/src/org/chromium/content/browser/accessibility/WebContentsAccessibility.java",
        "patchSetId": 11
      },
      "lineNbr": 1102,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2018-01-10T21:05:34Z",
      "side": 1,
      "message": "\u003e So what I see is, The actual text_changed event is fired by the android widget TextView.java\n\nNo, that\u0027s only if it\u0027s a real (native) Android widget. Chrome implements its own text fields and we have to fire the right accessibility events to try to match what TextView.java does.\n\nWe fire a text_changed event in WebContentsAccessibility.handleEditableTextChanged(). This is called from the C++ code when we get an event indicating that a text field changed.\n\nI think I see the problem now. The problem is that we have two different cases - one for static text, one for text fields.\n\nFor static text, moving by granularity is all just simulated. We\u0027re not actually changing anything in the web page, we\u0027re just keeping track of the selection start and end index and reporting it to TalkBack.\n\nBut for editable text, there\u0027s a \"real\" cursor that\u0027s part of the web page. We\u0027re exposing the real selection start and end.\n\nIt looks like this is buggy - when the real text field selection changes, we\u0027re not \"syncing\" that with the selection start and end used by the granularity code.",
      "parentUuid": "e7e8b207_1ed518a9",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "140d4558_f9e3a2fe",
        "filename": "content/public/android/javatests/src/org/chromium/content/browser/accessibility/WebContentsAccessibilityTest.java",
        "patchSetId": 11
      },
      "lineNbr": 94,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "Comment what this is?",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2db7dac7_961a8125",
        "filename": "content/public/android/javatests/src/org/chromium/content/browser/accessibility/WebContentsAccessibilityTest.java",
        "patchSetId": 11
      },
      "lineNbr": 94,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "140d4558_f9e3a2fe",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6c399108_119bf761",
        "filename": "content/public/android/javatests/src/org/chromium/content/browser/accessibility/WebContentsAccessibilityTest.java",
        "patchSetId": 11
      },
      "lineNbr": 304,
      "author": {
        "id": 1000678
      },
      "writtenOn": "2017-12-22T23:09:59Z",
      "side": 1,
      "message": "Unfortunately this isn\u0027t allowed in tests. We need to figure out why\nit doesn\u0027t work if you don\u0027t do this.",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7f3d70fb_a0d2c63d",
        "filename": "content/public/android/javatests/src/org/chromium/content/browser/accessibility/WebContentsAccessibilityTest.java",
        "patchSetId": 11
      },
      "lineNbr": 304,
      "author": {
        "id": 1241685
      },
      "writtenOn": "2018-01-02T10:59:09Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6c399108_119bf761",
      "revId": "8dbfb2a16f3bd4488b6e303e93f2ad5b3d3e2f02",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}