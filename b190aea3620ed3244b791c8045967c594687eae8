{
  "comments": [
    {
      "key": {
        "uuid": "d1fcf40c_72a4dff6",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 355,
      "author": {
        "id": 1175795
      },
      "writtenOn": "2018-01-30T18:42:19Z",
      "side": 1,
      "message": "One thing to consider here would be to use a factory method for creating a default/empty PhotoState like this. Factory methods for creating a PhotoState with defaults for all or most fields could be shared across several usage sites, e.g. [1][2][3]. Besides eliminating duplication this would have the advantage of reducing the risk of ending up with uninitialized fields in some usage sites whenever a new field is added to the struct.\n\n[1] https://cs.chromium.org/chromium/src/content/browser/image_capture/image_capture_impl.cc?q\u003dmojom::PhotoState::New\u0026l\u003d28\u0026dr\u003dC\n[2] https://cs.chromium.org/chromium/src/media/capture/video/mac/video_capture_device_mac.mm?q\u003dmojom::PhotoState::New\u0026l\u003d395\u0026dr\u003dC\n[3] https://cs.chromium.org/chromium/src/media/capture/video/win/video_capture_device_mf_win.cc?q\u003dmojom::PhotoState::New\u0026l\u003d777\u0026dr\u003dC",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ff4b55b_ae6d4f6f",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 355,
      "author": {
        "id": 1213761
      },
      "writtenOn": "2018-01-30T23:02:20Z",
      "side": 1,
      "message": "Yes it would be better.\n\nBut, where should I put this factory method?\n\nI tried to put:\n\n  static PhotoStatePtr Default() {\n\t  auto photo_capabilities \u003d mojom::PhotoState::New();\n\t  photo_capabilities-\u003eheight \u003d mojom::Range::New();\n\t  photo_capabilities-\u003ewidth \u003d mojom::Range::New();\n\t  photo_capabilities-\u003eexposure_compensation \u003d mojom::Range::New();\n\t  photo_capabilities-\u003ecolor_temperature \u003d mojom::Range::New();\n\t  photo_capabilities-\u003eiso \u003d mojom::Range::New();\n\t  photo_capabilities-\u003ebrightness \u003d mojom::Range::New();\n\t  photo_capabilities-\u003econtrast \u003d mojom::Range::New();\n\t  photo_capabilities-\u003esaturation \u003d mojom::Range::New();\n\t  photo_capabilities-\u003esharpness \u003d mojom::Range::New();\n\t  photo_capabilities-\u003ezoom \u003d mojom::Range::New();\n\t  photo_capabilities-\u003etorch \u003d false;\n\t  photo_capabilities-\u003ered_eye_reduction \u003d mojom::RedEyeReduction::NEVER;\n\t  return photo_capabilities;\n  }\n\nin |image_capture.mojom.h| before discovering it was a generated file.",
      "parentUuid": "d1fcf40c_72a4dff6",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8ccd50ae_bbde2d4e",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 355,
      "author": {
        "id": 1175795
      },
      "writtenOn": "2018-01-31T00:10:29Z",
      "side": 1,
      "message": "Hmm, I see two options that seem both acceptable:\n1.) Create a new pair of files in media/capture/mojo named, e.g., \"image_capture_types.h/cc\" and place the factory methods there. Then add a new source_set to media/capture/mojo/BUILD.gn that includes these two files.\n2.) Create the same new pair of files in media/capture instead and add them to an appropriate existing target in media/capture/BUILD.gn.",
      "parentUuid": "3ff4b55b_ae6d4f6f",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e2ebdcd2_e4d13abd",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 450,
      "author": {
        "id": 1175795
      },
      "writtenOn": "2018-01-30T18:42:19Z",
      "side": 1,
      "message": "The behavior contract at interface media::VideoCaptureDevice specifies [1] that the callback gets invoked on the same thread that called TakePhoto. It seems that is not the case here.\n\n[1] https://cs.chromium.org/chromium/src/media/capture/video/video_capture_device.h?q\u003dSetPhotoOptions\u0026l\u003d289",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1778366c_b730fe59",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 450,
      "author": {
        "id": 1213761
      },
      "writtenOn": "2018-01-30T22:35:39Z",
      "side": 1,
      "message": "According to this, don\u0027t we then have the same issue in VideoCaptureDeviceWin [1] and VideoCaptureDeviceMFWin [2] ?\n\n[1] https://cs.chromium.org/chromium/src/media/capture/video/win/video_capture_device_win.cc?l\u003d860\n[2] https://cs.chromium.org/chromium/src/media/capture/video/win/video_capture_device_mf_win.cc?l\u003d883",
      "parentUuid": "e2ebdcd2_e4d13abd",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "262905da_a193929f",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 450,
      "author": {
        "id": 1175795
      },
      "writtenOn": "2018-01-30T22:50:26Z",
      "side": 1,
      "message": "Good catch. Looks like we do.\nWe should probably fix that.\nCreated issue https://bugs.chromium.org/p/chromium/issues/detail?id\u003d807441 for this.",
      "parentUuid": "1778366c_b730fe59",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79b14e84_48a78805",
        "filename": "media/capture/video/file_video_capture_device.cc",
        "patchSetId": 3
      },
      "lineNbr": 450,
      "author": {
        "id": 1213761
      },
      "writtenOn": "2018-01-31T00:05:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "262905da_a193929f",
      "revId": "b190aea3620ed3244b791c8045967c594687eae8",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}