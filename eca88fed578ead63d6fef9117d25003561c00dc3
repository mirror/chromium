{
  "comments": [
    {
      "key": {
        "uuid": "a1186d33_d621c028",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1115976
      },
      "writtenOn": "2017-11-15T01:15:06Z",
      "side": 1,
      "message": "A comment in \"WebKit/public/platform/TaskType.h\" says,\n\n  // Tasks that must not be throttled should be posted here, but the usage\n  // should be very limited.\n  kUnthrottled,\n\nI wonder if we should have a dedicated task type for realtime audio (and video?) that is never throttled (+altimin@)",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca8aa74f_73a2e1e9",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1115916
      },
      "writtenOn": "2017-11-15T04:37:28Z",
      "side": 1,
      "message": "What task types do other audio tasks use?",
      "parentUuid": "a1186d33_d621c028",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a07de66_da41a6a2",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T17:22:01Z",
      "side": 1,
      "message": "In general, WebAudio tasks are timing-sensitive, so I have been using kUnthrottled.",
      "parentUuid": "ca8aa74f_73a2e1e9",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d155f3ad_7c34d8f9",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-11-15T17:38:41Z",
      "side": 1,
      "message": "Other real-time media tasks are using kUnthrottled, I believe (see HTMLMediaElement).\n\nI\u0027m strongly in favour of introducing a small number of specific unthrottled task types instead of one general kUnthrottled — with the motivation being that it will it harder to use kUnthrottled incorrectly — there are only a handful of users of kUnthrottled now (audio and workers), it\u0027s easier to introduce specific task types for these and prevent people from using kUnthrottled because it\u0027s an easy thing to do.\n\ntl;dr: I like the idea of introducing TaskType::RealTimeMedia.",
      "parentUuid": "1a07de66_da41a6a2",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4d9f3b9_60ae7616",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T17:51:34Z",
      "side": 1,
      "message": "I see WebGL task type in the dictionary. Can WebAudio have TaskType::WebAudio?\n\nI believe the refresh rate of video spans 30~90fps with the sweet spot of 60fps (~16ms), but WebAudio\u0027s callback needs to support \u003c3ms. The task being posted usually are supposed to happen in the \"render quantum boundary\", it has roughly 3ms of interval when the sample rate is 44.1Khz.",
      "parentUuid": "d155f3ad_7c34d8f9",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8b580a2_be120d59",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1150969
      },
      "writtenOn": "2017-11-15T17:54:52Z",
      "side": 1,
      "message": "WebAudio is an option, but I\u0027d want something that could be used in HTMLMediaElement instead of kUnthrottled (we also have MediaElementEvent and it will be strange to use WebAudio together with it. RealTimeMedia, however, makes it clearer that there are expectations of this thing being unthrottled.",
      "parentUuid": "b4d9f3b9_60ae7616",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "48f467bf_6ffabc12",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T18:23:29Z",
      "side": 1,
      "message": "I see. If the |RealTimeMedia| category does not have implication of a specific time interval, I am fine with RealTimeMedia. Thanks!",
      "parentUuid": "d8b580a2_be120d59",
      "range": {
        "startLine": 57,
        "startChar": 56,
        "endLine": 57,
        "endChar": 78
      },
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d4c121be_88648f1e",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1115976
      },
      "writtenOn": "2017-11-15T01:15:06Z",
      "side": 1,
      "message": "For readability and safeness, how about strictly checking state transition like this?\n\nswitch (state) {\n  case kPending:\n    NOTREACHED()\n        \u003c\u003c \"The state never returns to kPending.\";\n    break;\n  case kRunning:\n    DCHECK_EQ(kPending, processor_state_);\n    processor_state_ \u003d state;\n    break;\n  case kStopped:\n    // I don\u0027t know whether this expectation is correct :)\n    NOTREACHED()\n        \u003c\u003c \"The state is never changed once it reaches kStopped.\";\n    break;\n  case kError:\n    processor_state_ \u003d state;\n    break\n  DispatchEvent(...);\n}",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4925486_30462f14",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1115976
      },
      "writtenOn": "2017-11-15T01:34:24Z",
      "side": 1,
      "message": "Sorry, these are explicitly wrong and incomplete. Maybe...\n\nswitch (processor_state_) {\n  case kPending:\n    DCHECK(new_state \u003d\u003d kRunning || new_state \u003d\u003d kError);\n    break;\n  case kRunning:\n    DCHECK(new_state \u003d\u003d kStopped || new_state \u003d\u003d kError);\n    break;\n  case kStopped:\n  case kError:\n    NOTREACHED()\n        \u003c\u003c \"The state is never changed once it reaches kStopped or kError.\";\n    return;\n  }\n  processor_state_ \u003d new_state;\n  DispatchEvent(...);\n}",
      "parentUuid": "d4c121be_88648f1e",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5cbce042_378b03ee",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1115916
      },
      "writtenOn": "2017-11-15T04:37:28Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "a4925486_30462f14",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2186115a_5e52b115",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T17:22:01Z",
      "side": 1,
      "message": "Great idea!",
      "parentUuid": "5cbce042_378b03ee",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1a2b3964_30722b0a",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.cpp",
        "patchSetId": 2
      },
      "lineNbr": 325,
      "author": {
        "id": 1115976
      },
      "writtenOn": "2017-11-15T01:15:06Z",
      "side": 1,
      "message": "\u0027default\u0027 is not necessary because all cases are handled. We might want to move NOTREACHED() to line 328.",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "343ef7e0_f6c09fb9",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.h",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1115916
      },
      "writtenOn": "2017-11-15T04:37:28Z",
      "side": 1,
      "message": "Use an enum class.",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5529748c_bd86fb69",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.h",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T17:22:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "343ef7e0_f6c09fb9",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b3e8616_97da16b7",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.h",
        "patchSetId": 2
      },
      "lineNbr": 82,
      "author": {
        "id": 1115976
      },
      "writtenOn": "2017-11-15T01:15:06Z",
      "side": 1,
      "message": "How about clarifying a thread posted tasks will run?",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "528950b2_cace7fc4",
        "filename": "third_party/WebKit/Source/modules/webaudio/AudioWorkletNode.h",
        "patchSetId": 2
      },
      "lineNbr": 82,
      "author": {
        "id": 1130280
      },
      "writtenOn": "2017-11-15T17:22:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9b3e8616_97da16b7",
      "revId": "eca88fed578ead63d6fef9117d25003561c00dc3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}