{
  "comments": [
    {
      "key": {
        "uuid": "67fdd3ac_cd608d63",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 557,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2018-01-12T17:56:50Z",
      "side": 1,
      "message": "We should have ProfileHelper::GetProfileByUserIdHashForTest called explicitly before this since we are simulating login instead of exercising real login code path in this test. Otherwise, AccessibilityManager would still be using sign-in profile and we are not really testing what we want.\n\nSuggest to get back the StartUserSession method and use that (without the SetPrefServiceForTest call).",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58120795_e22798ca",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 557,
      "author": {
        "id": 1147616
      },
      "writtenOn": "2018-01-16T03:03:56Z",
      "side": 1,
      "message": "Ack. After the change, there is test failure in BrailleWhenLoggedIn test.\n\nThe reason is ash is not connected to pref service. It is because PrefInitializationStatus is always WAITING [1]. The root cause is [1] is false (test could pass If I changed [1] to return true). So the reason is ProfileHelper::GetProfileByUserIdHashForTest is making some ConfigurationPolicyProvider not initialization complete at POLICY_DOMAIN_CHROME.\n\nI am bit unclear of what happened here. I would continue investigation. But if I can get some suggestions, that would be better here. Thanks!\n\n[1] https://cs.chromium.org/chromium/src/components/policy/core/browser/configuration_policy_pref_store.cc?type\u003dcs\u0026sq\u003dpackage:chromium\u0026l\u003d68",
      "parentUuid": "67fdd3ac_cd608d63",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5179a0ef_93f3d451",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 557,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2018-01-16T23:10:19Z",
      "side": 1,
      "message": "I\u0027m sorry, I\u0027m not sure what\u0027s going on here. xiyuan, do you have ideas?\n\n(Ash\u0027s connection to the pref service is async at startup[2]. Maybe something has to wait until it\u0027s ready? But I haven\u0027t see that before in tests.)\n\n[2] https://cs.chromium.org/chromium/src/ash/shell.cc?type\u003dcs\u0026q\u003donlocalstateprefserviceinitialized\u0026sq\u003dpackage:chromium\u0026l\u003d873",
      "parentUuid": "58120795_e22798ca",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bd4bb907_4cbf354f",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 557,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2018-01-16T23:58:35Z",
      "side": 1,
      "message": "CreateSession/StartUserSession are used to simulate user login. They are hacks in the sense that we are not exercising the regular login code path. The failure is probably something we did not properly setup in the test.\n\nI have tried to figure out what is wrong but failed, even forcing ConfigurationPolicyPrefStore::IsInitializationComplete does not work for me. :(",
      "parentUuid": "5179a0ef_93f3d451",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "be0732d1_83170048",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 611,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2018-01-12T17:47:50Z",
      "side": 1,
      "message": "nit: I might remove the assertions from line 611 to 620. The fact that the profiles change this way seems like an internal impl detail, not the end-user behavior we want to test. This feels a little like a \"change detector\" test. xiyuan, WDYT?",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de74804c_7f9c5242",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 611,
      "author": {
        "id": 1000101
      },
      "writtenOn": "2018-01-12T17:56:50Z",
      "side": 1,
      "message": "+1\n\nI don\u0027t think we should test this detail either.",
      "parentUuid": "be0732d1_83170048",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf07cfb3_71f6f7aa",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 611,
      "author": {
        "id": 1147616
      },
      "writtenOn": "2018-01-16T03:03:56Z",
      "side": 1,
      "message": "done. In this patch, I removed the test EnableOnLoginScreenAndLogin. I felt it is a dup of this. WDYT?",
      "parentUuid": "de74804c_7f9c5242",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "10f0cdc3_895fdd61",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 611,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2018-01-16T23:10:19Z",
      "side": 1,
      "message": "I would just remove lines 611 to 620. The two tests are testing different things -- e.g. one is testing calling AccessibilityManager::SetLargeCursor() directly, the other is testing changing the pref for large cursor. While the internal implementation of SetLargeCursor() just changes the pref, that\u0027s an implementation detail.",
      "parentUuid": "bf07cfb3_71f6f7aa",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eccb5a2f_1afe0cbe",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 641,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2018-01-12T17:47:50Z",
      "side": 1,
      "message": "nit: \u003d default where you can",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a07b4870_5b59f0f5",
        "filename": "chrome/browser/chromeos/accessibility/accessibility_manager_browsertest.cc",
        "patchSetId": 6
      },
      "lineNbr": 641,
      "author": {
        "id": 1147616
      },
      "writtenOn": "2018-01-16T03:03:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eccb5a2f_1afe0cbe",
      "revId": "4a60c00a169b9550739a483249ef40cb10a800ba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}