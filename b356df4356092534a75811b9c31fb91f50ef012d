{
  "comments": [
    {
      "key": {
        "uuid": "e9359783_3c84c350",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1003325
      },
      "writtenOn": "2017-07-07T23:21:42Z",
      "side": 1,
      "message": "One last comment: Does this actually need to be delayed or was the delay used to get out of the way of startup?",
      "range": {
        "startLine": 36,
        "startChar": 8,
        "endLine": 36,
        "endChar": 33
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7807b8b7_e1971b96",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 36,
      "author": {
        "id": 1153420
      },
      "writtenOn": "2017-07-07T23:33:47Z",
      "side": 1,
      "message": "I would assume it was to get out of the way of startup. Looking at the original CL, https://codereview.chromium.org/370293004 , I wasn\u0027t able to find any explicit explanation or rationale. Looking at https://bugs.chromium.org/p/chromium/issues/detail?id\u003d383558#c8 is the closest I can find,\n\n\u003e At startup or shortly thereafter...\n\nI\u0027m not exactly sure where you\u0027re going with this, but you could ask erikchen@ who is the original author.",
      "parentUuid": "e9359783_3c84c350",
      "range": {
        "startLine": 36,
        "startChar": 8,
        "endLine": 36,
        "endChar": 33
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06f8eac2_e3a016e5",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1003325
      },
      "writtenOn": "2017-07-07T23:14:24Z",
      "side": 1,
      "message": "Consider adding a priority (likely USER_BLOCKING or USER_VISIBLE, depending on how import it is to load these hotkeys) and a shutdown behavior (likely CONTINUE_ON_SHUTDOWN as if we\u0027re already shutting down, we don\u0027t care for this to run or complete).",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ac0c4688_c2e6653b",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1153420
      },
      "writtenOn": "2017-07-07T23:33:47Z",
      "side": 1,
      "message": "Given that we\u0027re delaying loading these things for 10 seconds, I\u0027m guessing priority is fairly low for this. Admittedly, I don\u0027t have any real experience of what this feature is doing.\n\nHowever, I\u0027m a bit confused about CONTINUE_ON_SHUTDOWN, I agree that this operation doesn\u0027t need to be performed if we\u0027re shutting down, but isn\u0027t CONTINUE_ON_SHUTDOWN the default?",
      "parentUuid": "06f8eac2_e3a016e5",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ade455e5_c3deea12",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1003325
      },
      "writtenOn": "2017-07-07T23:59:44Z",
      "side": 1,
      "message": "We prefer folks to be opinionated as to how their tasks should run when they have the context.\n\nLeaving the priority and shutdown behavior unspecified is basically another way of saying that we don\u0027t care and are fine with any changes to the API in the future. \n\nThe default behavior is currently SKIP_ON_SHUTDOWN, which means this task will block shutdown if the task execution has already started.",
      "parentUuid": "ac0c4688_c2e6653b",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3af69e6b_19ec3aea",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1153420
      },
      "writtenOn": "2017-07-10T19:18:00Z",
      "side": 1,
      "message": "I cannot seem to find where in the code that uses a default behavior of SKIP_ON_SHUTDOWN. Isn\u0027t TaskTrait\u0027s |shutdown_behavior_| field going to default to CONTINUE_ON_SHUTDOWN (the first enum value), even if shutdown_behavior_set_explicitly_ is still false? Can you maybe update the code to make it easier to find where the default gets set? Because I tried before posting my last comment, and apparently failed.\n\nI\u0027m also surprised to hear that the default is SKIP_ON_SHUTDOWN. Why don\u0027t we default to the lighter weight CONTINUE_ON_SHUTDOWN if the caller hasn\u0027t specified / doesn\u0027t care? Why waste resources/block shutdown?",
      "parentUuid": "ade455e5_c3deea12",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da6e3414_481e4b2e",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1003325
      },
      "writtenOn": "2017-07-10T19:39:54Z",
      "side": 1,
      "message": "The first enum value in any enum is not guaranteed to be the default. In this case, this line selects SKIP_ON_SHUTDOWN as the default.\nhttps://cs.chromium.org/chromium/src/base/task_scheduler/task_traits.h?rcl\u003d8b4f1223115aa934a660b2df2776bbb7124ce6bd\u0026l\u003d157\n\nIt is not the intent of this API to let developers omit traits that just happen to match the default. Instead, the intent is to let developers omit traits when they want to use the scheduler\u0027s opinion on how to dispatch tasks.\n\nIn this case, we should have an opinion. Adding a CONTINUE_ON_SHUTDOWN documents that the task can be terminated in the middle of execution and no bad result will occur. A priority will also document the importance of this task to the user.\n\nAs for SKIP_ON_SHUTDOWN vs. CONTINUE_ON_SHUTDOWN, SKIP_ON_SHUTDOWN is the safer default because it provides atomic execution of the task under shutdown situations.",
      "parentUuid": "3af69e6b_19ec3aea",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cf7ca674_cac7ac92",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1153420
      },
      "writtenOn": "2017-07-11T15:52:29Z",
      "side": 1,
      "message": "Thanks for the link!\n\nI\u0027m still a bit confused about SKIP_ON_SHUTDOWN vs. CONTINUE_ON_SHUTDOWN. If you default to SKIP_ON_SHUTDOWN because it\u0027s \"safer\", that\u0027s essentially a leaky interface, right? And all of your callers are going to depend on that safety, maybe not on purpose. You\u0027re never going to be able to change it.\n\nIt seems to me what you really want here is to force every caller to specify a priority and a shutdown behavior. I don\u0027t see why it\u0027s optional to begin with if your stance is that every callsite should think about, specify, and document these.\n\nMaybe I\u0027m just missing the user case where you don\u0027t want to specify these.",
      "parentUuid": "da6e3414_481e4b2e",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e0cf929f_b7fbe30b",
        "filename": "content/browser/cocoa/system_hotkey_helper_mac.mm",
        "patchSetId": 2
      },
      "lineNbr": 37,
      "author": {
        "id": 1153420
      },
      "writtenOn": "2017-07-11T16:01:06Z",
      "side": 1,
      "message": "Also, posted https://chromium-review.googlesource.com/c/567020/ to actually add the things that we should. I think I was wrong when I initially said it should be \"fairly low\" priority, after reading TaskPriority documentation I think you were right, USER_VISIBLE is fairly reasonable for this use case.",
      "parentUuid": "cf7ca674_cac7ac92",
      "range": {
        "startLine": 37,
        "startChar": 24,
        "endLine": 37,
        "endChar": 32
      },
      "revId": "b356df4356092534a75811b9c31fb91f50ef012d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}