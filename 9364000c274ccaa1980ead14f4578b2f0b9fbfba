{
  "comments": [
    {
      "key": {
        "uuid": "86d29b9d_8b0257a1",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 23,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "I don\u0027t think we need this global. (there\u0027s kinda already one in views::MenuController::active_instance_, but that\u0027s orthogonal).\n\nCan ProfileChooserView store a unique_ptr\u003cDiceAccountsMenu\u003e? That way something that could trigger closing the profile switcher will also destroy |DiceAccountsMenu|, and close the menu rather than leaving it dangling. Probably Show() can return a std::unique_ptr for this.\n\nAnd ProfileChooserView is short-lived, so i wouldn\u0027t worry about clearing out the unique_ptr\u003cDiceAccountsMenu\u003e. And if the menu is shown twice on the same ProfileChooserView, it can just be replaced when the new menu is created.",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c6079a8f_181b50e7",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 23,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "86d29b9d_8b0257a1",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b4978a0f_52bd6a53",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "comment about separators?\n\n // DiceAccountsMenu adds separators at the top and between each item to....",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "53fb9fa8_e6d54f0f",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b4978a0f_52bd6a53",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d1d1548_9324d37e",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T23:17:31Z",
      "side": 1,
      "message": "\u003e\u003e comment about separators?\n\n\u003e\u003e // DiceAccountsMenu adds separators at the top and between each item to....\n\u003e Done\n\nPing? (the extra separators are unusual - a comment explaining why would be good I think)",
      "parentUuid": "53fb9fa8_e6d54f0f",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "278968ab_977535d4",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 45,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-02T12:23:55Z",
      "side": 1,
      "message": "In the mocks, the spacing in and around the items is a lot bigger, so I added the separators for now so that the menu looks closer to the mocks. We might want to change that in the future and maybe increase the height of the items overall, if that is possible.",
      "parentUuid": "9d1d1548_9324d37e",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "586185be_5d102954",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "scale factors might do something funny if you don\u0027t also pass anchor_view-\u003esize() before converting to screen coordinates.\n\nCan you just pass anchor_view-\u003eGetBoundsInScreen() to RunMenuAt()?",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d74317a3_cd949671",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Yes, perfect. I didn\u0027t know that this method exists. Done",
      "parentUuid": "586185be_5d102954",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2b924b6_8d4ecd2c",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 82,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "int(..) is a `functional cast` which we tend not to use. static_cast\u003csize_t\u003e(id) or or just `NOTIMPLEMENTED() \u003c\u003c \"Selected id: \" \u003c\u003c id.",
      "range": {
        "startLine": 82,
        "startChar": 28,
        "endLine": 82,
        "endChar": 31
      },
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb62e99c_df6a653f",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 82,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e2b924b6_8d4ecd2c",
      "range": {
        "startLine": 82,
        "startChar": 28,
        "endLine": 82,
        "endChar": 31
      },
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3cb65500_dfdb5f4f",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 88,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "MenuClosed callbacks usually just reset |menu_runner_|. i.e.,\n  menu_runner_ \u003d nullptr;\n\nI think doing nothing is also OK.\n\nBut deleting the menu delegate (i.e. |this|) is normally not done. I think lifetimes get complicated - usually menus are \"owned\" by something, and that something can go away and call `delete` before the menu is closed -- that triggers MenuClosed(), so if MenuClosed() also tries to delete, it becomes a double-free.",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "13b7435c_2bb63f59",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 88,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T09:56:22Z",
      "side": 1,
      "message": "I guess I do not understand how the menu ownership works. My understanding from the MenuRunner is that the MenuRunner or the Menu does not take ownership of the MenuModel or of the MenuDelegate. This means that DiceAccountsMenu is not owners by anything and would simply leak (at least in the current implementation).\n\nI think this is potentially solved by Trent\u0027s suggestion to use a unique_ptr\u003cDiceAccountsMenu\u003e in the ProfileChooserView (in that case, DiceAccountsMenu would only leak until the ProfileChooserView is closed).\n\nThomas: Let\u0027s use a unique_ptr\u003cDiceAccountsMenu\u003e (there no need to release if on MenuClosed).",
      "parentUuid": "3cb65500_dfdb5f4f",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "681a4608_ae8d1856",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.cc",
        "patchSetId": 5
      },
      "lineNbr": 88,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "13b7435c_2bb63f59",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8508812a_7b33308a",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 30,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "would it make sense to move GetImagesForAccounts() into dice_accounts_menu.cc? the icons need only live in the menu model then",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "31a1c157_92b3e0da",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 30,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T09:56:22Z",
      "side": 1,
      "message": "I think we preferred passing down the list of images to avoid having adding a dependency on the profile or on the AccountTrackerService in the DiceAcccountsMenu.",
      "parentUuid": "8508812a_7b33308a",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a9f91263_7f9123ca",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 30,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Yes, I agree with Mihai. The fetching part shouldn\u0027t be in here.",
      "parentUuid": "31a1c157_92b3e0da",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b93be543_f6ea2dbf",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "nit: explicit not needed (% comment above)",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4a2fb6b1_0755ef98",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 34,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b93be543_f6ea2dbf",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "576066e1_7aaf8791",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2018-02-01T02:11:05Z",
      "side": 1,
      "message": "this is never null (nor changed), so shouldn\u0027t be a unique_ptr -- see https://chromium.googlesource.com/chromium/src/+/lkgr/styleguide/c++/c++.md#forward-declarations-vs_includes",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23db50e4_32d93105",
        "filename": "chrome/browser/ui/views/profiles/dice_accounts_menu.h",
        "patchSetId": 5
      },
      "lineNbr": 46,
      "author": {
        "id": 1246408
      },
      "writtenOn": "2018-02-01T13:42:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "576066e1_7aaf8791",
      "revId": "9364000c274ccaa1980ead14f4578b2f0b9fbfba",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}