{
  "comments": [
    {
      "key": {
        "uuid": "421e81d2_ad76b1ee",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1123405
      },
      "writtenOn": "2017-08-23T19:14:21Z",
      "side": 1,
      "message": "What is failing in VerifyDmabuf when we get NV12 buffers?\nCan we enable this check just for NV12 temporarily instead of completely skipping it?",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ff53b87_8d1ff0f9",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1002450
      },
      "writtenOn": "2017-08-24T15:16:59Z",
      "side": 1,
      "message": "Nothing. It is just temporary disabled for this switching. I don\u0027t want to spend too much efforts to make VerifyDmabuf support both formats at the same time. \n\nWe will enable the verification after this switching complete.\n\nThere is another CL in minigbm related to this:\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/minigbm/+/544489\n\nTo ensure the video playback on ARC++ is not affected by this switching, (Since chrome and chromeos version is not always synced.) We will:\n\n1. Merge this CL in Chrome\n2. After Chrome with this CL is picked in ChromeOS, we merge the minigbm CL.\n3. Enable the verification again.",
      "parentUuid": "421e81d2_ad76b1ee",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24e0af5a_27dc8218",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1123405
      },
      "writtenOn": "2017-08-28T16:42:39Z",
      "side": 1,
      "message": "My question was: since we\u0027ll have to support VerifyDmabuf for NV12 eventually, can we change VerifyDmabuf and make it work just with NV12 in this patch, while we can skip it for RGB if you want?\nIf any problem arises from switching to NV12, better catch it as early as possible.\n\nI don\u0027t see anything in VerifyDmabuf that depends on minigbm.",
      "parentUuid": "5ff53b87_8d1ff0f9",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02ce9300_ef50e70e",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1002450
      },
      "writtenOn": "2017-08-29T06:15:16Z",
      "side": 1,
      "message": "mmm.... I think I didn\u0027t misunderstand your question. But maybe my reply was not clear enough.\n\nThere is nothing need to be changed in VerifyDmabuf to support NV12 (I have tested). \n\nHowever, the goal of this patch is not just switch from YV12 to NV12 but actually, is to make it work for BOTH YV12/NV12. That\u0027s why we need to turn off VerifyDmabuf. It is complicated to make VerifyDmabuf support BOTH, and I don\u0027t think it is necessary.\n\nWhy we need to support BOTH formats? To make the format transition smooth.\n\nWe are not sure when chrome PFQ will uprev. \n\nSo we cannot submit the follow CL to switch the format in minigbm:\n\nhttps://chromium-review.googlesource.com/c/chromiumos/platform/minigbm/+/544489\n\nInstead we should \n1. Merge this CL in Chrome. (So that both format is supported)\n2. After Chrome with this CL is picked in ChromeOS, we merge the minigbm CL.\n3. Enable the verification again in Chrome.",
      "parentUuid": "24e0af5a_27dc8218",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4f2d7f30_8cf9f106",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1119929
      },
      "writtenOn": "2017-08-29T08:05:05Z",
      "side": 1,
      "message": "I tend to agree with Daniele here, but I don\u0027t really understand what\u0027s the problem with VerifyDmabuf(). We should be getting the format from Android side (since it only knows it by querying gralloc, which is free to choose arbitrary format, as long as hardware is expected to support it) and then VerifyDmabuf() should check the DMA-buf validity based on that format.",
      "parentUuid": "02ce9300_ef50e70e",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3cd094f0_77c356cb",
        "filename": "chrome/gpu/chrome_arc_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 261,
      "author": {
        "id": 1002450
      },
      "writtenOn": "2017-08-29T08:29:53Z",
      "side": 1,
      "message": "True. At this moment, the format of imported buffer is actually set in both VDA and minigbm and they must match to each other.\n\nIf we can let minigbm to decide the format and VDA to accept it, there is no issue for VerifyFormat.\n\nBut that also means we need:\n\n1. Resolve format from cros_minigbm.\n2. Extended the mojo interface to pass the format\n3. Change all VDA implementations to take the format.\n\nBut Hiro is doing a major change in (2), so I would prefer to do this after his work.",
      "parentUuid": "4f2d7f30_8cf9f106",
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79dd0d34_a042b1d4",
        "filename": "media/gpu/vaapi_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 47,
      "author": {
        "id": 1119929
      },
      "writtenOn": "2017-08-29T08:05:05Z",
      "side": 1,
      "message": "Why do we hardcode the format here? The format is determined at runtime by gralloc, so it is an implementation detail, which can change.",
      "range": {
        "startLine": 47,
        "startChar": 0,
        "endLine": 47,
        "endChar": 40
      },
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e1a654d5_7708eb63",
        "filename": "media/gpu/vaapi_video_decode_accelerator.cc",
        "patchSetId": 3
      },
      "lineNbr": 898,
      "author": {
        "id": 1119929
      },
      "writtenOn": "2017-08-29T08:05:05Z",
      "side": 1,
      "message": "We should be getting output format from Android side.",
      "range": {
        "startLine": 894,
        "startChar": 0,
        "endLine": 898,
        "endChar": 39
      },
      "revId": "bbbde46f80d0b07673c675b1708e20c3d03e2aec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}