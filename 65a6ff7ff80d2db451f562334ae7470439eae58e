{
  "comments": [
    {
      "key": {
        "uuid": "b9fb4a64_9a21747f",
        "filename": "components/signin/core/browser/account_reconcilor.cc",
        "patchSetId": 6
      },
      "lineNbr": 349,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-27T16:55:33Z",
      "side": 1,
      "message": "The reconcilor is already revoking credentials for secondary accounts in a special case (this is done in the reconcilor, not in the delegate). Because of that, I think the following code would be better for 3 reasons: a) keeps all removal of secondary accounts in the reconcilor  b) it removes tokens that are invalid and and c) it is easier to remove later as it is clear this only affects the secondary accounts cases.\n\nif (delegate-\u003eShouldRevokeAllSecondaryTokensBeforeReconcile(\n    verified_gaia_accounts, primary_account_id_)) {\n  RevokeAllSecondaryTokens();\n}\nauto chrome_accounts \u003d LoadValidAccountsFromTokenService(primary_account_);\n\nTo reuse the RevokeAllSecondayTokens we can pass a boolean indicating if it should be removed or only marked as removed.",
      "range": {
        "startLine": 349,
        "startChar": 24,
        "endLine": 349,
        "endChar": 31
      },
      "revId": "65a6ff7ff80d2db451f562334ae7470439eae58e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25021586_2cf21088",
        "filename": "components/signin/core/browser/account_reconcilor.cc",
        "patchSetId": 6
      },
      "lineNbr": 349,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2017-11-28T13:00:01Z",
      "side": 1,
      "message": "Done, except reusing the function.\n\nThere is also the is_reconcile_noop_ variable, which requires additional handling (either passing another boolean, or resetting it after the call).\nI think at this point, trying to reuse these 3 lines of code is overkill.\n\nAbout the 3 reasons, I\u0027m not sure why a) would be better if we don\u0027t share the RevokeAllSecondaryTokens() function, and c) is not obvious to me. However b) seems like a clear benefit.",
      "parentUuid": "b9fb4a64_9a21747f",
      "range": {
        "startLine": 349,
        "startChar": 24,
        "endLine": 349,
        "endChar": 31
      },
      "revId": "65a6ff7ff80d2db451f562334ae7470439eae58e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}