{
  "comments": [
    {
      "key": {
        "uuid": "b2b40801_a719d791",
        "filename": "content/browser/service_worker/service_worker_register_job.h",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1161621
      },
      "writtenOn": "2017-07-07T06:35:08Z",
      "side": 1,
      "message": "Starting a timer for every job seems to be heavy.. \nTo find and doom some jobs running for too long time, how about such a solution:\n  - Mark a time stamp(current time) on every job when it\u0027s pushed into the job queue.\n  - Change the DoomInstallingWorkerIfNeeded() impl to do: Iterate the job queue, for any one job, compare its\u0027 marked time stamp with current time, if we found it has been in the queue longer than for example 30 minutes, doom it.",
      "range": {
        "startLine": 167,
        "startChar": 23,
        "endLine": 167,
        "endChar": 41
      },
      "revId": "c1e338aaf1e5dae16a9d3ed1649c12fadad35a49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f49e8433_7bef0913",
        "filename": "content/browser/service_worker/service_worker_register_job.h",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-07-07T14:19:32Z",
      "side": 1,
      "message": "iterating over the job queue seems heavy too, and i\u0027d rather start the countdown on a job once it\u0027s started.\n\nthe way I thought this would work, though I didn\u0027t think of all the details is:\n- Once JobCoordinator starts a job, it also starts a timer that will fire in 30 min.\n- When the job is destructed, the timer is cancelled.\n- When the timer fires, it calls ServiceWorkerRegisterJobBase::Abort()",
      "parentUuid": "b2b40801_a719d791",
      "range": {
        "startLine": 167,
        "startChar": 23,
        "endLine": 167,
        "endChar": 41
      },
      "revId": "c1e338aaf1e5dae16a9d3ed1649c12fadad35a49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f420df4c_cab0104b",
        "filename": "content/browser/service_worker/service_worker_register_job.h",
        "patchSetId": 1
      },
      "lineNbr": 167,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-07-07T14:43:46Z",
      "side": 1,
      "message": "Ah yea, having a timer on every update may be a bit overkill since it happens so often.\n\nWe could have a single repeating timer in JobCoordinator that just checks the current job (the front of the queue) every 30 min.  If the job was started 30 min ago, call Abort(). That\u0027s pretty simple and will ensure we don\u0027t get stuck forever.",
      "parentUuid": "f49e8433_7bef0913",
      "range": {
        "startLine": 167,
        "startChar": 23,
        "endLine": 167,
        "endChar": 41
      },
      "revId": "c1e338aaf1e5dae16a9d3ed1649c12fadad35a49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}