{
  "comments": [
    {
      "key": {
        "uuid": "8bbd9224_e7252130",
        "filename": "cc/trees/layer_tree_host_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 3067,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2017-12-07T22:38:30Z",
      "side": 1,
      "message": "I\u0027m using this as a test to see if storing the last generated ID in the allocator is worth it.\nI think it isn\u0027t.\n\nThe top line certainly is more simple. It does indeed allow us to no longer store the LocalSurfaceId as a member.\n\nHowever, I think there is an intrinsic value to letting the type system provide hints such as assignment. If I were to look at the old bottom line, I could see the member variable and then ask \"Okay, where is this initialized?\" I can easily search for where that variable is assigned (ctor, operator\u003d). There are tricky ways to assign it like swap() that would make it harder to find where it is initialized.\n\nI think this LastGeneratedId() also hides the assignment. I think it is tricky, like swap().\nI tried to make the name \"LastGeneratedId\" a clue that it references \"GenerateId\". But at the end of the day, all of this is adding mental context rather than removing it and utilizing affordances.",
      "range": {
        "startLine": 3067,
        "startChar": 1,
        "endLine": 3067,
        "endChar": 3
      },
      "revId": "6d694d82923cb5a3d2c03675da9a803554fa82cb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69ea0948_9c532f56",
        "filename": "cc/trees/layer_tree_host_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 3067,
      "author": {
        "id": 1221484
      },
      "writtenOn": "2017-12-08T01:26:40Z",
      "side": 1,
      "message": "Are there ever cases where the same allocator is used to generate multiple surface IDs we need to track at once? In a case like that, we\u0027d still need to track these in local variables and the LastGeneratedId may be more of a distraction?\n\nIf not the pattern seems OK, but I wonder if GenerateId should be a void() function to make it clear that you are expected to retrieve the ID from the allocator itself?",
      "parentUuid": "8bbd9224_e7252130",
      "range": {
        "startLine": 3067,
        "startChar": 1,
        "endLine": 3067,
        "endChar": 3
      },
      "revId": "6d694d82923cb5a3d2c03675da9a803554fa82cb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aaf44e1d_b07b7800",
        "filename": "cc/trees/layer_tree_host_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 3067,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2017-12-09T00:23:12Z",
      "side": 1,
      "message": "I didn\u0027t check all 177 call sites.\nBut it does seem like this happens sometimes:\nhttps://cs.chromium.org/chromium/src/components/viz/service/display/surface_aggregator_pixeltest.cc?l\u003d109\n\nBut to my point, I still think it makes it a bit harder for the next person to understand where the initialization happens and that it must happen first.",
      "parentUuid": "69ea0948_9c532f56",
      "range": {
        "startLine": 3067,
        "startChar": 1,
        "endLine": 3067,
        "endChar": 3
      },
      "revId": "6d694d82923cb5a3d2c03675da9a803554fa82cb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1fb4df51_159a4c26",
        "filename": "components/viz/common/surfaces/parent_local_surface_id_allocator.h",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1115911
      },
      "writtenOn": "2017-12-08T01:41:47Z",
      "side": 1,
      "message": "void GenerateId()?",
      "revId": "6d694d82923cb5a3d2c03675da9a803554fa82cb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57a712de_72c9e383",
        "filename": "components/viz/common/surfaces/parent_local_surface_id_allocator.h",
        "patchSetId": 4
      },
      "lineNbr": 27,
      "author": {
        "id": 1115911
      },
      "writtenOn": "2017-12-08T01:41:47Z",
      "side": 1,
      "message": "const LocalSurfaceId\u0026 last_generated_id() const?",
      "revId": "6d694d82923cb5a3d2c03675da9a803554fa82cb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}