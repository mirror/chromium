{
  "comments": [
    {
      "key": {
        "uuid": "4384359d_b1242cd7",
        "filename": "third_party/WebKit/Source/core/html/forms/HTMLInputElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 434,
      "author": {
        "id": 1002854
      },
      "writtenOn": "2017-11-21T23:18:28Z",
      "side": 1,
      "message": "nit: IIUC, this is subtle in that EnsureUserAgentShadowRoot will cause CreateShadowSubtree to be called internally, which explains why we don\u0027t need to do so again in that case. A comment might help, but an alternative might be to remove the CreateShadowSubtree call in DidCreateUserAgentShadowRoot.\n\nWDYT of:\n\n- removing said call\n\n- making HTMLInputElement::InitializeTypeInParsing do this:\nif (input_type_view_-\u003eNeedsShadowSubtree()) {\n  CreateUserAgentShadowRoot();\n  input_type_view_-\u003eCreateShadowSubtree());\n}\n\n- making this call site do:\nif (input_type_view_-\u003eNeedsShadowSubtree()) {\n  EnsureUserAgentShadowRoot();\n  input_type_view_-\u003eCreateShadowSubtree());\n}\n\nIf it doesn\u0027t break anything, it seems clearer to me. Those four lines (the first technically doesn\u0027t need to check it again because at that site we know none exists, but we could check again) could even be gathered into a CreateShadowSubtreeIfNeeded method if you like that better.",
      "revId": "e26a2673d35efb8d82a0980e8ded2141d871d213",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bbb9d95f_bc27dfe0",
        "filename": "third_party/WebKit/Source/core/html/forms/HTMLInputElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 434,
      "author": {
        "id": 1115916
      },
      "writtenOn": "2017-11-22T02:05:38Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "4384359d_b1242cd7",
      "revId": "e26a2673d35efb8d82a0980e8ded2141d871d213",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6414a1e4_753f2271",
        "filename": "third_party/WebKit/Source/core/html/forms/HTMLInputElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 434,
      "author": {
        "id": 1175471
      },
      "writtenOn": "2017-11-22T21:54:26Z",
      "side": 1,
      "message": "This makes sense to me. Turns out all the subclasses of MediaControlInputElement also rely on EnsureUserAgentShadowRoot (which is called in each subclass\u0027 constructor) calling CreateShadowSubtree as well. So I just moved the shadow root and shadow subtree creation to MediaControlInputElement\u0027s constructor and removed all the EnsureUserAgentShadowRoot calls from the subclass constructors. WDYT?",
      "parentUuid": "bbb9d95f_bc27dfe0",
      "revId": "e26a2673d35efb8d82a0980e8ded2141d871d213",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d227a2d0_fd5d05d4",
        "filename": "third_party/WebKit/Source/core/html/forms/TextControlElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 171,
      "author": {
        "id": 1115916
      },
      "writtenOn": "2017-11-22T02:05:38Z",
      "side": 1,
      "message": "Add DCHECK(UserAgentShadowRoot()).",
      "revId": "e26a2673d35efb8d82a0980e8ded2141d871d213",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc0df81b_b0acc58e",
        "filename": "third_party/WebKit/Source/core/html/forms/TextControlElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 171,
      "author": {
        "id": 1175471
      },
      "writtenOn": "2017-11-22T23:09:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d227a2d0_fd5d05d4",
      "revId": "e26a2673d35efb8d82a0980e8ded2141d871d213",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}