{
  "comments": [
    {
      "key": {
        "uuid": "e6f21a91_668550b8",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1111839
      },
      "writtenOn": "2017-09-29T01:32:51Z",
      "side": 1,
      "message": "I think the commit title and message does not describe the fix precisely. It should be \n\narc/bluetooth: Prevent double-setting the user preference on power state\n\nThis adds a flag to guard SetPrimaryUserBluetoothPowerSetting if the power state change on adapter is initiated by Chrome in the first place, since the user preference has been saved. By SetPrimaryUserBluetoothPowerSetting, the the following scenario can be prevented.\n\nIssue:\nDouble-setting the user preference is OK in the normal case where it takes BlueZ \u003c 1 second to power on/off the adapter. In some cases, it takes BlueZ \u003e 3 seconds to finish powering off adapter. Within that \u003e 3 seconds window if an user turns on Bluetooth from Chrome Bluetooth setting, the power-on request will be fulfilled by BlueZ and enqueued to the to-be-send-to-android request queue while Android is still dealing with the previous power-off request. Afterward, Android gets back to Chrome about finishing power-off request, but since the current state is powered-on in preference on Chrome, the power-off state will be stored to preference again, which will then trigger a power-on request from Chrome. And this toggling will go on and on.",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 10,
        "endChar": 8
      },
      "revId": "f17efab2a62ff71632770df360e0c2c25bb47e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca356536_8e6f95ff",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1111839
      },
      "writtenOn": "2017-09-29T01:40:27Z",
      "side": 1,
      "message": "Correction:\n\"This adds a flag to guard SetPrimaryUserBluetoothPowerSetting if the power state change on adapter is initiated by Chrome in the first place, since the user preference has been saved. By SetPrimaryUserBluetoothPowerSetting, the following scenario can be prevented.\"",
      "parentUuid": "e6f21a91_668550b8",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 10,
        "endChar": 8
      },
      "revId": "f17efab2a62ff71632770df360e0c2c25bb47e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6690a865_bb6d772e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1181214
      },
      "writtenOn": "2017-09-29T02:27:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ca356536_8e6f95ff",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 10,
        "endChar": 8
      },
      "revId": "f17efab2a62ff71632770df360e0c2c25bb47e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a51532f3_ff0cfa36",
        "filename": "chrome/browser/chromeos/arc/bluetooth/arc_bluetooth_bridge.cc",
        "patchSetId": 2
      },
      "lineNbr": 1047,
      "author": {
        "id": 1111839
      },
      "writtenOn": "2017-09-29T01:34:48Z",
      "side": 1,
      "message": "nit: here and below\n// Saves the power state to user preference only if Android initiated it.\nif (save_user_pref)\n  SetPrimaryUserBluetoothPowerSetting(true);",
      "range": {
        "startLine": 1044,
        "startChar": 0,
        "endLine": 1047,
        "endChar": 3
      },
      "revId": "f17efab2a62ff71632770df360e0c2c25bb47e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d21514e_097f1595",
        "filename": "chrome/browser/chromeos/arc/bluetooth/arc_bluetooth_bridge.cc",
        "patchSetId": 2
      },
      "lineNbr": 1047,
      "author": {
        "id": 1181214
      },
      "writtenOn": "2017-09-29T02:27:49Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a51532f3_ff0cfa36",
      "range": {
        "startLine": 1044,
        "startChar": 0,
        "endLine": 1047,
        "endChar": 3
      },
      "revId": "f17efab2a62ff71632770df360e0c2c25bb47e36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}