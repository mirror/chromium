{
  "comments": [
    {
      "key": {
        "uuid": "9c560f42_228f8ef1",
        "filename": "content/browser/renderer_host/media/media_stream_manager.cc",
        "patchSetId": 4
      },
      "lineNbr": 635,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2017-11-21T17:36:15Z",
      "side": 1,
      "message": "Mojo mandates that the response callback must be run. In one of the browsertests, GenerateStream callback gets set but the test shuts down before the callback is run resulting in crash(reason for bot failure in ps3). Hence, added this change to ensure the callback is run(if not run before) before the test shuts down. This change seems to result in another browsertest failure as we can see from the failing bots. I\u0027ll check further tomorrow when I am in office. We need to ensure that callbacks are run(if set and not run) before DeviceRequest is destroyed.",
      "range": {
        "startLine": 635,
        "startChar": 77,
        "endLine": 635,
        "endChar": 0
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c0b1f12e_2c39fc77",
        "filename": "content/browser/renderer_host/media/media_stream_manager.cc",
        "patchSetId": 4
      },
      "lineNbr": 635,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2017-11-21T17:46:17Z",
      "side": 1,
      "message": "Note that the new failing test seems to be using SpeechRecognition, so it shouldn\u0027t use generateStream.\nMaybe you\u0027re introducing a regression for MEDIA_DEVICE_ACCESS-type requests, which is what speech recognition uses.",
      "parentUuid": "9c560f42_228f8ef1",
      "range": {
        "startLine": 635,
        "startChar": 77,
        "endLine": 635,
        "endChar": 0
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8bcf5b06_53d80d78",
        "filename": "content/browser/renderer_host/media/media_stream_manager.cc",
        "patchSetId": 4
      },
      "lineNbr": 635,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2017-11-21T18:14:49Z",
      "side": 1,
      "message": "Sure, it doesn\u0027t. I was referring to the failing test in ps3. Current(ps4) failing test seems to be caused by the above change which fixed the failing test in ps3. I think we need to find an appropriate place to run DeviceRequest\u0027s mojo callbacks(if not run earlier) before it\u0027s destroyed.",
      "parentUuid": "c0b1f12e_2c39fc77",
      "range": {
        "startLine": 635,
        "startChar": 77,
        "endLine": 635,
        "endChar": 0
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7013a1c_e56cb57b",
        "filename": "content/browser/renderer_host/media/media_stream_requester.h",
        "patchSetId": 4
      },
      "lineNbr": 16,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2017-11-21T16:47:12Z",
      "side": 1,
      "message": "add crbug.com reference",
      "range": {
        "startLine": 16,
        "startChar": 23,
        "endLine": 16,
        "endChar": 24
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "acef4ee6_861d81bb",
        "filename": "content/browser/renderer_host/media/media_stream_requester.h",
        "patchSetId": 4
      },
      "lineNbr": 16,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2017-11-22T09:14:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e7013a1c_e56cb57b",
      "range": {
        "startLine": 16,
        "startChar": 23,
        "endLine": 16,
        "endChar": 24
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7e29394e_7a1be3db",
        "filename": "content/renderer/media/user_media_processor.h",
        "patchSetId": 4
      },
      "lineNbr": 112,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2017-11-21T16:47:12Z",
      "side": 1,
      "message": "Rename to set_media_stream_dispatcher_host_for_testing() since is a simple setter.",
      "range": {
        "startLine": 112,
        "startChar": 7,
        "endLine": 112,
        "endChar": 45
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d07a378f_f75d12c3",
        "filename": "content/renderer/media/user_media_processor.h",
        "patchSetId": 4
      },
      "lineNbr": 112,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2017-11-22T09:14:55Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7e29394e_7a1be3db",
      "range": {
        "startLine": 112,
        "startChar": 7,
        "endLine": 112,
        "endChar": 45
      },
      "revId": "8e4d60f0badb297d9bd49ca01fd93b26872e31de",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}