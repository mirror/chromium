{
  "comments": [
    {
      "key": {
        "uuid": "d79cafc4_b3c16473",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1111,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "shouldn\u0027t this (and all other occurrences) also check the result of InitNativeRegApi? for example:\n\nif (!g_initialized \u0026\u0026 !InitNativeRegApi())\n    return false;",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "938781e4_09a33435",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1111,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "Good point, well made sir.\nDone.",
      "parentUuid": "d79cafc4_b3c16473",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f001e28e_36dba0a0",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1161,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "this could race against another thread on the system that\u0027s modifying the registry, no? if so, it\u0027s possible that |size_needed| is no longer sufficient for this second call. how about doing this in a loop up to some sane number of times (5?) to protect against such races?",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a08f8995_ec7aaf8b",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1161,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "Done.\n- It doesn\u0027t hurt to add a few tries in there.  It\u0027ll be super rare for a concurrent modify to happen that only results in a bigger buffer required.  base::win::reg doesn\u0027t do this - but I\u0027m happy to let NtReg be as stable as possible.\n- I\u0027ve added a do/while to the three APIs that could run into this: QueryRegEnumerationInfo, QueryRegSubkey, and QueryRegKeyValue.",
      "parentUuid": "f001e28e_36dba0a0",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8a7317f_14c1f7bf",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1161,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-26T21:44:23Z",
      "side": 1,
      "message": "Super",
      "parentUuid": "a08f8995_ec7aaf8b",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7a7958e7_76f3c404",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1172,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "content.data() for consistency with line 894?",
      "range": {
        "startLine": 1172,
        "startChar": 53,
        "endLine": 1172,
        "endChar": 64
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "15448f7f_42ff331b",
        "filename": "chrome_elf/nt_registry/nt_registry.cc",
        "patchSetId": 3
      },
      "lineNbr": 1172,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7a7958e7_76f3c404",
      "range": {
        "startLine": 1172,
        "startChar": 53,
        "endLine": 1172,
        "endChar": 64
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "74e067f4_2d9da32d",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 232,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "please document that |key| must have been opened with KEY_ENUMERATE_SUB_KEYS access",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0093006a_4d88f3c4",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 232,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "74e067f4_2d9da32d",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17850e01_c4612ebc",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 235,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "nit: out_subkey_count -\u003e subkey_count\n(here and in .cc)",
      "range": {
        "startLine": 235,
        "startChar": 48,
        "endLine": 235,
        "endChar": 64
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c853f1c_bb58786e",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 235,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "So, I was attempting to be consistent with the rest of the naming convention in this file.  All the other APIs that return values are named with \"out_\".\n\nIs this a bad thing?  Against our convention?\nIt wouldn\u0027t be too bad to rename all of them if you think it\u0027s worth doing.",
      "parentUuid": "17850e01_c4612ebc",
      "range": {
        "startLine": 235,
        "startChar": 48,
        "endLine": 235,
        "endChar": 64
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "860205f1_77190aa3",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 235,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-26T21:44:23Z",
      "side": 1,
      "message": "i didn\u0027t notice that it was the convention in this file. in that case, i think it\u0027s okay, though i don\u0027t believe that it\u0027s a general convention in the codebase. if you\u0027re ever bored, please survey other chromium code and remove \"out_\" in a separate CL if it seems to be rare.",
      "parentUuid": "7c853f1c_bb58786e",
      "range": {
        "startLine": 235,
        "startChar": 48,
        "endLine": 235,
        "endChar": 64
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b13bf4d_52b3bb64",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 242,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "nit: out_subkey_name -\u003e subkey_name\n(here and in .cc)",
      "range": {
        "startLine": 242,
        "startChar": 34,
        "endLine": 242,
        "endChar": 49
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a815d1a_a398c7a7",
        "filename": "chrome_elf/nt_registry/nt_registry.h",
        "patchSetId": 3
      },
      "lineNbr": 242,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "See above.",
      "parentUuid": "4b13bf4d_52b3bb64",
      "range": {
        "startLine": 242,
        "startChar": 34,
        "endLine": 242,
        "endChar": 49
      },
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58c6e4c3_b78d2b1b",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 342,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-26T21:44:23Z",
      "side": 1,
      "message": "while the delete shouldn\u0027t be needed, the close is, no? the safest thing would be to put the close in something like this on line 329:\n\n  base::ScopedClosureRunner key_closer(base::BindOnce(\u0026nt::CloseRegKey, key_handle)));\n\nsame thing for the tests below\n\n(with #include \"base/callback_helpers.h\" at the right place)",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ded04c3_ce7844c2",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 342,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-28T01:59:20Z",
      "side": 1,
      "message": "So the handle close isn\u0027t really needed either.\n\nThe \"NtRegistryTest\" harness overrides registry, each of these tests run in their own little temp sub-hive.  Even on assert, the whole little subtree of registry that these handles are open to gets deleted. \n\nThe system doesn\u0027t actually remove the subkey until the last handle is closed - which happens as soon as the test process\u0027 handle table is destroyed by the OS during the test process teardown.\n\n\nHowever.  I\u0027ve just decided to put back in the original handle close.  It\u0027s really not needed - but in the case where someone is running every single test, in a single process, there could be 5 extra handles in the process handle table and 5 little test sub-hives... until the process ends.  I don\u0027t know, it looks a bit better. ?\n\nI think the base stuff you mentioned might be a bit extreme here - but let me know if you feel strongly about it.  Once I actually finish https://bugs.chromium.org/p/chromium/issues/detail?id\u003d693215, handles will be scoped.",
      "parentUuid": "58c6e4c3_b78d2b1b",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4148d1ec_b21e581a",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 658,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "is this necessary? doesn\u0027t the test harness clean everything up in its dtor?\n\nif this isn\u0027t needed, how about simplifying the loop above by the use of ASSERT_TRUE rather than \"if (!) { ADD_FAILURE(); break;\"?",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88846723_c1446498",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 658,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "Done.  Removed the cleanup in any tests using NtRegistryTest harness, and adjusted everything to asserts.",
      "parentUuid": "4148d1ec_b21e581a",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d08a4df4_b52a0d41",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 658,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-26T21:44:23Z",
      "side": 1,
      "message": "Thanks. Some care should be taken with EXPECT vs ASSERT. As per https://github.com/google/googletest/blob/master/googletest/docs/Primer.md#assertions:\n\n\"Usually EXPECT_* are preferred, as they allow more than one failures to be reported in a test. However, you should use ASSERT_* if it doesn\u0027t make sense to continue when the assertion in question fails.\"",
      "parentUuid": "88846723_c1446498",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "04a9e465_ad0df8ac",
        "filename": "chrome_elf/nt_registry/nt_registry_unittest.cc",
        "patchSetId": 3
      },
      "lineNbr": 658,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-28T01:59:20Z",
      "side": 1,
      "message": "Ah yes.  That\u0027s why I didn\u0027t have them all asserts.  Re-adjusted.",
      "parentUuid": "d08a4df4_b52a0d41",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1104e647_43e50d47",
        "filename": "sandbox/win/src/nt_internals.h",
        "patchSetId": 3
      },
      "lineNbr": 414,
      "author": {
        "id": 1178124
      },
      "writtenOn": "2017-09-20T11:51:44Z",
      "side": 1,
      "message": "nit: add a trailing comma so that this line doesn\u0027t need to be touched if another item is added down the road.",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ed9523f_5ef9fc5f",
        "filename": "sandbox/win/src/nt_internals.h",
        "patchSetId": 3
      },
      "lineNbr": 414,
      "author": {
        "id": 1122084
      },
      "writtenOn": "2017-09-25T23:09:58Z",
      "side": 1,
      "message": "The enum defines from ntdll don\u0027t use the trailing commas.  All the defines in nt_internals.h are copied straight from windows .h files, so don\u0027t have them.\n\nFor consistency (and Windows defines) I\u0027m inclined to leave this file as is!",
      "parentUuid": "1104e647_43e50d47",
      "revId": "0a6f83ebcbca2636e72d8ee5a9815a852bf10d56",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}