{
  "comments": [
    {
      "key": {
        "uuid": "e06d0325_dab549ae",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1000539
      },
      "writtenOn": "2017-12-04T20:56:03Z",
      "side": 1,
      "message": "can we track this state in gles2_cmd_decoder instead?",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b3f6d65e_6f7c2b7e",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1128437
      },
      "writtenOn": "2017-12-04T21:28:47Z",
      "side": 1,
      "message": "We do in the texture\u0027s cleared rect. This is to tell the decoder if the image is already cleared on initialization which is platform dependent. On Mac, anonymous IO surfaces aren\u0027t cleared after this change, whereas on ChromeOS, all surfaces are zero-initialized.",
      "parentUuid": "e06d0325_dab549ae",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25dc0a80_7cabe357",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1000539
      },
      "writtenOn": "2017-12-04T21:57:57Z",
      "side": 1,
      "message": "They are cleared later using the GPU instead of CPU, right?\n\nWhat I\u0027m asking is if it\u0027s necessary to add a virtual function to GLImage just to pass this state around? Can we just have an ifdef for this in gles_cmd_decoder with a comment explaining that anonymous GLImages need to be cleared using the GPU?",
      "parentUuid": "b3f6d65e_6f7c2b7e",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2a01d8a_da98f298",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1128437
      },
      "writtenOn": "2017-12-04T22:11:12Z",
      "side": 1,
      "message": "piman@ suggested that we avoid the clear for ChromeOS since it\u0027s already cleared on creation, but mac isn\u0027t cleared. If we want to always clear anonymous images, we don\u0027t even need an ifdef.",
      "parentUuid": "25dc0a80_7cabe357",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "64577431_ea676fbe",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1000539
      },
      "writtenOn": "2017-12-04T22:20:29Z",
      "side": 1,
      "message": "Yes, we should avoid the clear when not on Mac.",
      "parentUuid": "c2a01d8a_da98f298",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f4096650_94910728",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1148065
      },
      "writtenOn": "2017-12-04T22:59:43Z",
      "side": 1,
      "message": "Ifdefs are hard to deal with / test. What\u0027s wrong with GLImage describing its state?",
      "parentUuid": "25dc0a80_7cabe357",
      "tag": "mailMessageId\u003d\u003cCAMeTaZeqKaBy3e8trhUtVXXLZR_u+2nZZ0UiruU-rQBh_V2Vdw@mail.gmail.com\u003e",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "480eedf0_9801e854",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1000539
      },
      "writtenOn": "2017-12-05T00:53:16Z",
      "side": 1,
      "message": "I don\u0027t think it describes state that is meaningful for the GLImage API itself. It describes state that the code using the image is interested in keeping track of. New functions added to GLImage should come with additions to the templated image tests we have but not sure what to test in this case..\n\nI understand that it\u0027s useful to pass metadata around with images so maybe we should have it inherit from ui::PropertyHandler so people can add whatever properties they want without having to change the GLImage class and make the core API harder to understand. That would also allow us to cleanup the EmulatingRGB hacks we have in there..",
      "parentUuid": "f4096650_94910728",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e02ba304_da6b6b1f",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1128437
      },
      "writtenOn": "2017-12-05T23:46:31Z",
      "side": 1,
      "message": "An alternative is to use GLImage::GetType in the decoder or a helper function (and implement it properly in all subclasses).\n\nI also realized that we need to fix BackTexture to set the cleared rect the same way.",
      "parentUuid": "480eedf0_9801e854",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88f1d0a1_9aa26274",
        "filename": "ui/gl/gl_image.h",
        "patchSetId": 2
      },
      "lineNbr": 100,
      "author": {
        "id": 1148065
      },
      "writtenOn": "2017-12-06T00:19:53Z",
      "side": 1,
      "message": "I don\u0027t think dynamically-typed property maps are really appropriate for this. Also it is security-sensitive, so I think I would prefer a solid interface as opposed to a property you\u0027re supposed to magically know about.\n\nHow about extending ImageFactory::CreateAnonymousImage to return a bool to indicate whether the image needs to be cleared? That way it wouldn\u0027t impact GLImage\u0027s API.",
      "parentUuid": "480eedf0_9801e854",
      "tag": "mailMessageId\u003d\u003cCAMeTaZfmZ56yM+LMxwcLPpUFskEjJJE7T_+OqPUh87n488ar2Q@mail.gmail.com\u003e",
      "revId": "a17f599b81654f9fd9663d7105625d31870fba2e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}