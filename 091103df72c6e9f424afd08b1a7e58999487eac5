{
  "comments": [
    {
      "key": {
        "uuid": "b2c194fb_51bf8f76",
        "filename": "device/vr/vr_service.mojom",
        "patchSetId": 3
      },
      "lineNbr": 134,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "nit: wrap to 80 chars.",
      "range": {
        "startLine": 134,
        "startChar": 68,
        "endLine": 134,
        "endChar": 93
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d52b332_ecee75e6",
        "filename": "device/vr/vr_service.mojom",
        "patchSetId": 3
      },
      "lineNbr": 134,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "Oops, done. (I\u0027ve been relying on presubmit / \"git cl format\" to take care of this, but looks like it doesn\u0027t handle mojom files.)",
      "parentUuid": "b2c194fb_51bf8f76",
      "range": {
        "startLine": 134,
        "startChar": 68,
        "endLine": 134,
        "endChar": 93
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d979908e_9258369f",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.cpp",
        "patchSetId": 3
      },
      "lineNbr": 789,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "why \u0027context\u0027?",
      "range": {
        "startLine": 789,
        "startChar": 70,
        "endLine": 789,
        "endChar": 77
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b48975c5_1510821c",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.cpp",
        "patchSetId": 3
      },
      "lineNbr": 789,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "Moot since I\u0027ve removed the argument. I had meant \"context\" in the sense of \"execution context\" as in the location of the code it\u0027s called from, but I agree that it\u0027s confusing.",
      "parentUuid": "d979908e_9258369f",
      "range": {
        "startLine": 789,
        "startChar": 70,
        "endLine": 789,
        "endChar": 77
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "102a48a8_0cd0cf1e",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.cpp",
        "patchSetId": 3
      },
      "lineNbr": 791,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "I think this code would be easier to follow if you moved the check outside of this function call.\n\neg\nif (wait_for_previous_render_ \u003d\u003d WaitPrevStrategy::AFTER_BITMAP)\n  wait_time +\u003d WaitForPreviousRenderPhase();",
      "range": {
        "startLine": 791,
        "startChar": 6,
        "endLine": 791,
        "endChar": 42
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c360d467_2082b019",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.cpp",
        "patchSetId": 3
      },
      "lineNbr": 791,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "102a48a8_0cd0cf1e",
      "range": {
        "startLine": 791,
        "startChar": 6,
        "endLine": 791,
        "endChar": 42
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9abe79c1_e9fd0901",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "If OpenVR handles timing at the platform without needing the js to wait, why can\u0027t we do the same for Daydream? Isn\u0027t the real reason we don\u0027t need this for openVR because we don\u0027t have any parallelization in the openVR pipeline?",
      "range": {
        "startLine": 112,
        "startChar": 53,
        "endLine": 112,
        "endChar": 76
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4147c67a_e9e62bd8",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "You say OpenVR here, but then use external display as a signal for that. That sounds like it\u0027s going to cause headaches in the future because you\u0027re using a generic device property to infer which headset you\u0027re targeting?",
      "range": {
        "startLine": 112,
        "startChar": 5,
        "endLine": 112,
        "endChar": 11
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bb1d8980_bba20ea4",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "Yes, and this is something that we should tackle in general, i.e. by passing device info parameters to VRDisplay beyond just \"has external display\". I think this should be a separate change though.\n\nBasically, we have two transport methods for submitFrame:\n\n- texture handle transport (as used for OpenVR on Windows). This is the present_image_needs_copy_ branch, this is selected for HasExternalDisplay().\n\n- mailbox transport (as used for the Android surface path). This is the !present_image_needs_copy_ branch, selected for !HasExternalDisplay.\n\nFWIW, I\u0027m not changing current behavior with the NEVER strategy (renamed to NO_WAIT). The current waitForPreviousRender only happens in the mailbox transport submit path, and the texture handle transport implicitly bypasses that due to using a different conditional branch. I just want to make this explicit, and this also makes it possible to place the BEFORE_BITMAP location without needing yet another if (!present_image_needs_copy_) wrapper.\n\nAs an intermediate step, I\u0027ve added FrameTransport enum, plus a ConfigurePresentationPathForDisplay() method which selects that and the WaitPrevStrategy. This makes the current choices more explicit, and then we can make a separate change to activate this in a cleaner way than just HasExternalDisplay. What do you think?",
      "parentUuid": "4147c67a_e9e62bd8",
      "range": {
        "startLine": 112,
        "startChar": 5,
        "endLine": 112,
        "endChar": 11
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0526a451_d77f4e3e",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "I\u0027ve rephrased it. You\u0027re right, the core difference is that we use overlapping frames on Android but strictly sequential frames for OpenVR. We could delay SendVSync until the previous frame is sufficiently far along with rendering on Android also, but that would make things very slow, especially with the current fence ClientWait approach which waits for rendering to fully finish.",
      "parentUuid": "9abe79c1_e9fd0901",
      "range": {
        "startLine": 112,
        "startChar": 53,
        "endLine": 112,
        "endChar": 76
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "59fbdfc9_469f51db",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-04T15:18:44Z",
      "side": 1,
      "message": "This looks better. sgtm to pass more device parameters in the future.",
      "parentUuid": "bb1d8980_bba20ea4",
      "range": {
        "startLine": 112,
        "startChar": 5,
        "endLine": 112,
        "endChar": 11
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "97586420_8759b518",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 112,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-04T22:13:05Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "59fbdfc9_469f51db",
      "range": {
        "startLine": 112,
        "startChar": 5,
        "endLine": 112,
        "endChar": 11
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9d1e060_0879276b",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "Looks like this strategy is never used. Do you plan to use it in the future?",
      "range": {
        "startLine": 114,
        "startChar": 4,
        "endLine": 114,
        "endChar": 17
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e2ba116d_8233658c",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 114,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "Yes, this is intended for the GpuFence approach which explicitly separates frames via GPU server wait without having to do a client-side wait for rendering to finish. See WIP http://crrev.com/790133 for a rough idea.",
      "parentUuid": "f9d1e060_0879276b",
      "range": {
        "startLine": 114,
        "startChar": 4,
        "endLine": 114,
        "endChar": 17
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3800db57_98a8aa59",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 220,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-12-01T15:33:30Z",
      "side": 1,
      "message": "What do you mean by Backwards compatible?",
      "range": {
        "startLine": 220,
        "startChar": 5,
        "endLine": 220,
        "endChar": 25
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e1f6a747_7385a657",
        "filename": "third_party/WebKit/Source/modules/vr/VRDisplay.h",
        "patchSetId": 3
      },
      "lineNbr": 220,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-12-01T18:41:13Z",
      "side": 1,
      "message": "I\u0027ve changed the default to UNINITIALIZED to make the logic clearer.",
      "parentUuid": "3800db57_98a8aa59",
      "range": {
        "startLine": 220,
        "startChar": 5,
        "endLine": 220,
        "endChar": 25
      },
      "revId": "091103df72c6e9f424afd08b1a7e58999487eac5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}