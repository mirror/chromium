{
  "comments": [
    {
      "key": {
        "uuid": "a665f5c5_7cd4c5a2",
        "filename": "content/renderer/render_thread_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 1934,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2017-10-06T01:08:14Z",
      "side": 1,
      "message": "If SwiftShader\u0027s being used to render WebGL (--use-gl\u003dswiftshader-webgl), what\u0027s the likelihood that the WebGL context will be created before the compositor initializes? It seems that the \"Rats\" infobar will always be raised in that situation, which would be unfortunate. A while ago it used to be possible for the WebGL context and compositor\u0027s context to race for who got created first; not sure whether things have been changed so that even for documents which have script tags that run before onload that the compositor gets a chance to initialize before a WebGL context might get created.",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e822197_a2b29a06",
        "filename": "content/renderer/render_thread_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 1934,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T20:52:37Z",
      "side": 1,
      "message": "Does webgl start making frames before BeginMainFrames (RAF etc) start happening?\n\nIf so then it would race and that would be unfortunate. We don\u0027t need to lose contexts if software_rendering is there though. We can disable gpu compositing when we make any context and see software rendering. Then it would be disabled when the WebGL context was made, instead of later when the compositor context is made.\n\nI did that in the last patch set.",
      "parentUuid": "a665f5c5_7cd4c5a2",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ff9ce38_bdec68de",
        "filename": "content/renderer/render_thread_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 1934,
      "author": {
        "id": 1003154
      },
      "writtenOn": "2017-10-07T00:33:09Z",
      "side": 1,
      "message": "WebGL only falls back to swiftshader at GPU process start/restart time, not in the middle of GPU process\u0027s lifetime. As I mentioned in the crbug, you just need to query GpuFeatureInfo from GPU process (sent over to browser/renderer) to decide gpu compositing or software compositing (once that decision is added in GPU process)",
      "parentUuid": "0e822197_a2b29a06",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3312164_57d32bdd",
        "filename": "content/renderer/render_thread_impl.cc",
        "patchSetId": 5
      },
      "lineNbr": 1934,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-10T15:30:40Z",
      "side": 1,
      "message": "There\u0027s 2 interactions to think about:\n- For WebGL it may be using software renderering (swiftshader or not)\n- The Compositor itself may be using software or not.\n\nWhen swiftshader is on, compositor doesn\u0027t use gpu, so WebGL needs to readback to a texture. But in other cases if the compositor decides to not use gpu, WebGL needs to behave similarly, doing a readback to a bitmap to give to the compositor.\n\nThis patch is working toward addressing the Compositor\u0027s mode, of which swiftshader is one (stable, that\u0027s helpful) input. But the Compositor\u0027s mode can change at any time from gpu to software (when swiftshder is not on).",
      "parentUuid": "5ff9ce38_bdec68de",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "724a5be8_7e44431a",
        "filename": "content/renderer/render_thread_impl.h",
        "patchSetId": 5
      },
      "lineNbr": 262,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2017-10-06T00:42:49Z",
      "side": 1,
      "message": "typo: use -\u003e used",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "352c7c51_bacac798",
        "filename": "content/renderer/render_thread_impl.h",
        "patchSetId": 5
      },
      "lineNbr": 262,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "724a5be8_7e44431a",
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9bf67ac5_ffae9542",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 976,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "Could you move this check to the shouldAccelerate() method?",
      "range": {
        "startLine": 976,
        "startChar": 6,
        "endLine": 976,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "48d823a4_9d5b6052",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 976,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "ok, we\u0027ll have to make ShouldAccelerate() make the context then, is that what you\u0027re expecting?",
      "parentUuid": "9bf67ac5_ffae9542",
      "range": {
        "startLine": 976,
        "startChar": 6,
        "endLine": 976,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59b5ed88_58cfe577",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 976,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T18:22:55Z",
      "side": 1,
      "message": "zmo is landing a CL that does this.",
      "parentUuid": "48d823a4_9d5b6052",
      "range": {
        "startLine": 976,
        "startChar": 6,
        "endLine": 976,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bea0fc23_d23cd412",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 976,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T18:28:11Z",
      "side": 1,
      "message": "Cool, can you link?",
      "parentUuid": "59b5ed88_58cfe577",
      "range": {
        "startLine": 976,
        "startChar": 6,
        "endLine": 976,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "331d0165_2d0384c8",
        "filename": "third_party/WebKit/Source/core/html/HTMLCanvasElement.cpp",
        "patchSetId": 5
      },
      "lineNbr": 976,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T18:36:31Z",
      "side": 1,
      "message": "https://chromium-review.googlesource.com/c/chromium/src/+/704075",
      "parentUuid": "bea0fc23_d23cd412",
      "range": {
        "startLine": 976,
        "startChar": 6,
        "endLine": 976,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f7fc5c9_0b6d32c9",
        "filename": "third_party/WebKit/Source/modules/webgl/WebGLRenderingContextBase.cpp",
        "patchSetId": 5
      },
      "lineNbr": 786,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2017-10-06T01:08:14Z",
      "side": 1,
      "message": "It\u0027s a good question. I think the answer is yes. Currently this code assumes that it should hand back a texture-backed StaticBitmapImage, but if we\u0027re using SwiftShader and software compositing, it should probably be creating a CPU-backed Skia surface / image. Does that sound correct?",
      "range": {
        "startLine": 786,
        "startChar": 5,
        "endLine": 786,
        "endChar": 9
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f2e72ad3_eb3bfe19",
        "filename": "third_party/WebKit/Source/modules/webgl/WebGLRenderingContextBase.cpp",
        "patchSetId": 5
      },
      "lineNbr": 786,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "Yes, if the output of this goes to the compositor, it needs to be software or it\u0027ll not display when compositor is software compositing..",
      "parentUuid": "6f7fc5c9_0b6d32c9",
      "range": {
        "startLine": 786,
        "startChar": 5,
        "endLine": 786,
        "endChar": 9
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69f66ac3_c71d343e",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 212,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "This is guaranteed by the condition in HTMLCanvasElement that I asked you move to shouldAccelerate()",
      "range": {
        "startLine": 212,
        "startChar": 20,
        "endLine": 212,
        "endChar": 24
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1bb629da_1330cebd",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 929,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "Yes. Please create a crbug tied to this comment. In the event that we give up on GPU acceleration after a context reset (the three strikes, is that still a thing?), the canvas should switch to software rendering.",
      "range": {
        "startLine": 929,
        "startChar": 37,
        "endLine": 929,
        "endChar": 48
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d71a819_86caebe1",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 929,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "I\u0027m not sure how to describe when we\u0027ll fall back but it will stop being able to make a context if the gpu process can\u0027t be established by some mechanism, yeah. I think when that happens it will usually be the case that the context here is null too. But we shouldn\u0027t rely on that if we can do better with a more clear signal.",
      "parentUuid": "1bb629da_1330cebd",
      "range": {
        "startLine": 929,
        "startChar": 37,
        "endLine": 929,
        "endChar": 48
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e35d2f0_24ec6e74",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 929,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T18:22:55Z",
      "side": 1,
      "message": "Right, but are there cases where the compositor gives up on gpu-acceleration while and it is still possible to set-up a gpu context?",
      "parentUuid": "8d71a819_86caebe1",
      "range": {
        "startLine": 929,
        "startChar": 37,
        "endLine": 929,
        "endChar": 48
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b504845_a3db80d4",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 929,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T18:28:11Z",
      "side": 1,
      "message": "Today, if the compositor context is made but lost before it gets to the impl thread, it will fall back to software. The gpu process may still be available afaik.",
      "parentUuid": "4e35d2f0_24ec6e74",
      "range": {
        "startLine": 929,
        "startChar": 37,
        "endLine": 929,
        "endChar": 48
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f8291c3_540c7287",
        "filename": "third_party/WebKit/Source/platform/graphics/Canvas2DLayerBridge.cpp",
        "patchSetId": 5
      },
      "lineNbr": 929,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T18:41:24Z",
      "side": 1,
      "message": "Ah, so that\u0027s what the crbug should be about. Basically: In the case where a context can be created after a context loss, but the compositor fell back to software rendering mode, then the canvas should also fall back to software.",
      "parentUuid": "4b504845_a3db80d4",
      "range": {
        "startLine": 929,
        "startChar": 37,
        "endLine": 929,
        "endChar": 48
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc8c56e0_e1dcddfd",
        "filename": "third_party/WebKit/Source/platform/graphics/SkiaTextureHolder.cpp",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "Nope. No need for it here.",
      "range": {
        "startLine": 27,
        "startChar": 31,
        "endLine": 27,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9de87907_6a56bd46",
        "filename": "third_party/WebKit/Source/platform/graphics/SkiaTextureHolder.cpp",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "Ok, I\u0027d like to explain why, is this correct?\n\n  // Software compositing isn\u0027t relevant here, this isn\u0027t a compositor input.",
      "parentUuid": "bc8c56e0_e1dcddfd",
      "range": {
        "startLine": 27,
        "startChar": 31,
        "endLine": 27,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fb61afc_a776e782",
        "filename": "third_party/WebKit/Source/platform/graphics/SkiaTextureHolder.cpp",
        "patchSetId": 5
      },
      "lineNbr": 27,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T18:22:55Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "9de87907_6a56bd46",
      "range": {
        "startLine": 27,
        "startChar": 31,
        "endLine": 27,
        "endChar": 32
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8bb1d8f_033ed019",
        "filename": "third_party/WebKit/Source/platform/graphics/gpu/SharedGpuContext.cpp",
        "patchSetId": 5
      },
      "lineNbr": 130,
      "author": {
        "id": 1105344
      },
      "writtenOn": "2017-10-06T01:08:14Z",
      "side": 1,
      "message": "This one should be assigned to junov -- it\u0027s for 2D canvas.",
      "range": {
        "startLine": 130,
        "startChar": 4,
        "endLine": 130,
        "endChar": 5
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50159d44_dd5fd021",
        "filename": "third_party/WebKit/Source/platform/graphics/gpu/SharedGpuContext.cpp",
        "patchSetId": 5
      },
      "lineNbr": 130,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "Yes, see comment below.",
      "parentUuid": "a8bb1d8f_033ed019",
      "range": {
        "startLine": 130,
        "startChar": 4,
        "endLine": 130,
        "endChar": 5
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4bd7804b_05dcebea",
        "filename": "third_party/WebKit/Source/platform/graphics/gpu/SharedGpuContext.cpp",
        "patchSetId": 5
      },
      "lineNbr": 130,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "50159d44_dd5fd021",
      "range": {
        "startLine": 130,
        "startChar": 4,
        "endLine": 130,
        "endChar": 5
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bc45a9a2_280f360c",
        "filename": "third_party/WebKit/Source/platform/graphics/gpu/SharedGpuContext.cpp",
        "patchSetId": 5
      },
      "lineNbr": 135,
      "author": {
        "id": 1115939
      },
      "writtenOn": "2017-10-06T14:34:01Z",
      "side": 1,
      "message": "Should add \"!using_software_compositing \u0026\u0026\" to this expression",
      "range": {
        "startLine": 135,
        "startChar": 9,
        "endLine": 135,
        "endChar": 17
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfe916d8_3cdddaef",
        "filename": "third_party/WebKit/Source/platform/graphics/gpu/SharedGpuContext.cpp",
        "patchSetId": 5
      },
      "lineNbr": 135,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-10-06T15:31:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bc45a9a2_280f360c",
      "range": {
        "startLine": 135,
        "startChar": 9,
        "endLine": 135,
        "endChar": 17
      },
      "revId": "124cadf9e141045ea43f7ec50fee516f2986abe7",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}