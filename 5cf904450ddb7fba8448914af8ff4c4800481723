{
  "comments": [
    {
      "key": {
        "uuid": "95fb5645_028db06f",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1001629
      },
      "writtenOn": "2017-07-28T16:27:26Z",
      "side": 0,
      "message": "I didn\u0027t understand this comment. It says 10.9, but then the code only ran on 10.12+, and the first thing in the if says \"if we\u0027re on 10.12 we have to early out sometimes actually\". I mechanically replaced it with corresponding new code, but I\u0027m not sure the existing code does what it was intended to do.",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6371e0c5_5a8743ae",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1002844
      },
      "writtenOn": "2017-07-28T19:09:55Z",
      "side": 0,
      "message": "This block is only needed on 10.12+. The function it uses is only available on 10.9+, at least according to https://developer.apple.com/documentation/security/1400026-secpolicycreaterevocation?language\u003dobjc. What I don\u0027t understand is why I needed the availability pragma at all if 10.9 is the oldest version we support.",
      "parentUuid": "95fb5645_028db06f",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0164f8ff_140f575e",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1001629
      },
      "writtenOn": "2017-07-28T19:15:45Z",
      "side": 0,
      "message": "Yup, that\u0027s exactly what I don\u0027t understand either :-) But this if block was like this when you landed it, so I was hoping you could tell me why it looks like way it looks. Is the intention to only call SecPolicyCreateRevocation() on 10.12+? That\u0027s what happened on both the lhs and rhs.\n\nI believe (but haven\u0027t checked) that things should build without the pragma _and_ without the availability check, but that\u0027d be a behavior change.",
      "parentUuid": "6371e0c5_5a8743ae",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1541cfbf_4de537dd",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1002844
      },
      "writtenOn": "2017-07-28T19:22:20Z",
      "side": 0,
      "message": "Apple changed the behavior of their pki code in 10.12. This block accounts for that. So it is intentional that it is only on 10.12+.\n\nAt the time I added it, I got some compiler error/warning about SecPolicyCreateRevocation that required me to add the availability pragma. I don\u0027t know why that is, if we require 10.9 anyway.\n\nIf the code compiles successfully now just by removing the pragma (but leaving the version check), that would be fine too. (I\u0027m not sure if there is a preference for using the base::mac version check when availability isn\u0027t a problem? Could/should __builtin_available be used for all version checks now?)",
      "parentUuid": "0164f8ff_140f575e",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee698c71_54a464da",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1001629
      },
      "writtenOn": "2017-07-28T19:24:09Z",
      "side": 0,
      "message": "yes, I think we generally should use @available over base::mac::IsAtLeast(). It does the same thing (except that @avail happens to return true on non-mac while base::mac::IsAtLeast() returns false on non-mac), and it also helps with the warning. So I think we want to remove the base::mac::IsAtLeast() functions eventually.",
      "parentUuid": "1541cfbf_4de537dd",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51dd6304_d2fec97b",
        "filename": "net/cert/x509_util_mac.cc",
        "patchSetId": 1
      },
      "lineNbr": 209,
      "author": {
        "id": 1002844
      },
      "writtenOn": "2017-07-28T19:34:35Z",
      "side": 0,
      "message": "Ack",
      "parentUuid": "ee698c71_54a464da",
      "range": {
        "startLine": 209,
        "startChar": 18,
        "endLine": 209,
        "endChar": 40
      },
      "revId": "5cf904450ddb7fba8448914af8ff4c4800481723",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}