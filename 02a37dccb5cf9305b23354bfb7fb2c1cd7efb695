{
  "comments": [
    {
      "key": {
        "uuid": "8d9edf40_7903986e",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-01T11:25:18Z",
      "side": 1,
      "message": "Didn\u0027t we agree version 6 and above would be the ones with sections?",
      "range": {
        "startLine": 59,
        "startChar": 44,
        "endLine": 59,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e9112301_81d16551",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 59,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-01T17:44:36Z",
      "side": 1,
      "message": "Yes we did. This change was not conscious.",
      "parentUuid": "8d9edf40_7903986e",
      "range": {
        "startLine": 59,
        "startChar": 44,
        "endLine": 59,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34a8e6b3_41ccfa2d",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 176,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-01T11:25:18Z",
      "side": 1,
      "message": "As per maria\u0027s comment, 0 above will likely be replaced with an UNKNOWN or INVALID and cover the equality case.",
      "range": {
        "startLine": 176,
        "startChar": 64,
        "endLine": 176,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90a95fb9_27e17ed5",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 176,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-01T17:44:36Z",
      "side": 1,
      "message": "Even if, this would still mean it remains a valid section, wouldn\u0027t it?\nI have no strong feelings here but the parsing should proably still succeed",
      "parentUuid": "34a8e6b3_41ccfa2d",
      "range": {
        "startLine": 176,
        "startChar": 64,
        "endLine": 176,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f100977c_0be8c24c",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 176,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-03T08:42:34Z",
      "side": 1,
      "message": "The zero case is clearly an invalid section to propagate to upper layers. You might still want to parse the rest.",
      "parentUuid": "90a95fb9_27e17ed5",
      "range": {
        "startLine": 176,
        "startChar": 64,
        "endLine": 176,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4f04f3db_6541134e",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 176,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-03T11:11:16Z",
      "side": 1,
      "message": "Sure, this is done in the latest PS. (It\u0027s special cased as the section ID is valid, just the section is not.)",
      "parentUuid": "f100977c_0be8c24c",
      "range": {
        "startLine": 176,
        "startChar": 64,
        "endLine": 176,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d0b3fae_74cb8ab0",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-01T11:25:18Z",
      "side": 1,
      "message": "Please discuss this through with maria. I suspect you\u0027d like to propagate even empty sections to upper layers and let the server decide.",
      "range": {
        "startLine": 187,
        "startChar": 24,
        "endLine": 187,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "26091b68_5a50556a",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-01T17:44:36Z",
      "side": 1,
      "message": "Depends on whether we can receive empty sections. If so, that is likely. If not, only a section with at least one valid tile is a valid section. (That\u0027s the current assumption. Leaving this open until I synced with Maria)",
      "parentUuid": "2d0b3fae_74cb8ab0",
      "range": {
        "startLine": 187,
        "startChar": 24,
        "endLine": 187,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5ff2501_e3534fe3",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 187,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-02T19:28:07Z",
      "side": 1,
      "message": "Propagating this since this depends on UX.\n(UI can easily remove empty sections. Adding them back is much harder.)",
      "parentUuid": "26091b68_5a50556a",
      "range": {
        "startLine": 187,
        "startChar": 24,
        "endLine": 187,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "065c72d3_bbb5b5df",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 211,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-01T11:25:18Z",
      "side": 1,
      "message": "The handling of the failure case (i.e. warn and fall back to older parsing logic) seems unnecessary to me and could hide issues in tests. How about simply:\n   return ParseVersion6OrAbove(list);",
      "range": {
        "startLine": 211,
        "startChar": 48,
        "endLine": 211,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c5e6a0b_cc4fa5c8",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 211,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-01T17:44:36Z",
      "side": 1,
      "message": "I changed the WARNING to DFATAL. That way, tests which are not set up properly will crash. Stale cashes or spontaneous rollbacks to V5 will still work then.\n(I would be less persistent if server and client would always roll at the same time.)",
      "parentUuid": "065c72d3_bbb5b5df",
      "range": {
        "startLine": 211,
        "startChar": 48,
        "endLine": 211,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8da6332b_74578212",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 211,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-03T08:42:34Z",
      "side": 1,
      "message": "I have the impression this is too smart and unnecessary.\n- Stale cache: Do you mean from prefs? You\u0027re right about the need to handle that, but I think what we should do is to store the version in prefs (and discard prefs in case of version mismatch). WDYT?\n\n- Rollbacks to V5: I don\u0027t follow what you mean here unless it refers to stale caches / prefs.",
      "parentUuid": "8c5e6a0b_cc4fa5c8",
      "range": {
        "startLine": 211,
        "startChar": 48,
        "endLine": 211,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "59fdf2f9_e09881b3",
        "filename": "components/ntp_tiles/popular_sites_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 211,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-03T11:11:16Z",
      "side": 1,
      "message": "\u003e I have the impression this is too smart and unnecessary.\n\u003e - Stale cache: Do you mean from prefs? You\u0027re right about the need to handle that, but I think what we should do is to store the version in prefs (and discard prefs in case of version mismatch). WDYT?\n\nThat seems appropriate, given the answer to the next question. \n\n\u003e - Rollbacks to V5: I don\u0027t follow what you mean here unless it refers to stale caches / prefs.\n\nI though about the server returning an older version. But as we can override the version using Finch, we gain very little and should probably prefer the cleaner version checks.",
      "parentUuid": "8da6332b_74578212",
      "range": {
        "startLine": 211,
        "startChar": 48,
        "endLine": 211,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d704e0ad_e99636d8",
        "filename": "components/ntp_tiles/section_type.h",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-01T11:25:18Z",
      "side": 1,
      "message": "How about replacing LAST with COUNT, such that there\u0027s no need to make it equal with TRAVEL? Less redundancy, less code changes in the future.",
      "range": {
        "startLine": 24,
        "startChar": 15,
        "endLine": 24,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97a0e7e8_8c3771bc",
        "filename": "components/ntp_tiles/section_type.h",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-01T17:44:36Z",
      "side": 1,
      "message": "This would have been a good idea. Now that the first section is UNKNOWN (or something similar), I am not sure COUNT is any longer correct.",
      "parentUuid": "d704e0ad_e99636d8",
      "range": {
        "startLine": 24,
        "startChar": 15,
        "endLine": 24,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b7d6912b_0b64ece9",
        "filename": "components/ntp_tiles/section_type.h",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1176649
      },
      "writtenOn": "2017-08-07T05:20:04Z",
      "side": 1,
      "message": "If you don\u0027t like COUNT, then END? Please check for similar occurrences in the codebase, and if you don\u0027t find anything, fall back to your proposal.",
      "parentUuid": "97a0e7e8_8c3771bc",
      "range": {
        "startLine": 24,
        "startChar": 15,
        "endLine": 24,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "674845b1_9f1fc526",
        "filename": "components/ntp_tiles/section_type.h",
        "patchSetId": 4
      },
      "lineNbr": 24,
      "author": {
        "id": 1200319
      },
      "writtenOn": "2017-08-07T17:13:13Z",
      "side": 1,
      "message": "I know this pattern from other chromium code I worked with:\nhttps://cs.chromium.org/search/?q\u003dLAST.%3D\n\n(I couldn\u0027t find END or COUNT in a similar fashion)",
      "parentUuid": "b7d6912b_0b64ece9",
      "range": {
        "startLine": 24,
        "startChar": 15,
        "endLine": 24,
        "endChar": 0
      },
      "revId": "02a37dccb5cf9305b23354bfb7fb2c1cd7efb695",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}