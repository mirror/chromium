{
  "comments": [
    {
      "key": {
        "uuid": "30459592_057f3c91",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 10,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-10-27T23:37:56Z",
      "side": 1,
      "message": "WebView is removed not because of the memory usage, but because we did not want the previous page to live (it may play audio or video or do something else in JavaScript). We could (and should) have loaded about://blank?\u003crandom_token\u003e instead, but I learned about this trick from you a few weeks ago :)",
      "range": {
        "startLine": 10,
        "startChar": 17,
        "endLine": 10,
        "endChar": 18
      },
      "revId": "e6b9108989caf0708b41383f71f457535eb8358f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a119547b_0f200cb8",
        "filename": "ios/web/web_state/ui/crw_web_controller.mm",
        "patchSetId": 2
      },
      "lineNbr": 1091,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-10-27T23:37:56Z",
      "side": 1,
      "message": "WebView is purged here because this is the only way to clear visited links when clearing the browsing data. So I think this change breaks visited links clearing.",
      "range": {
        "startLine": 1091,
        "startChar": 16,
        "endLine": 1091,
        "endChar": 28
      },
      "revId": "e6b9108989caf0708b41383f71f457535eb8358f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51d3743f_4dfe3634",
        "filename": "ios/web/web_state/ui/crw_web_controller.mm",
        "patchSetId": 2
      },
      "lineNbr": 1091,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-10-30T15:00:58Z",
      "side": 1,
      "message": "Can you give me a bit more context on visited link and clearing browsing data? Which code path triggers this functionality?\n\nIIUC, there seems to be two use cases for SetWebUsageEnabled(false):\n(1) destroy the WKWebView when it\u0027s not needed to avoid playing audio and whatnot\n(2) force clearing browsing data\n\nWhat I\u0027m trying to change is (1) here. Would it make sense to create a separate API for (2) to preserve its functionality? Would this be feasible?",
      "parentUuid": "a119547b_0f200cb8",
      "range": {
        "startLine": 1091,
        "startChar": 16,
        "endLine": 1091,
        "endChar": 28
      },
      "revId": "e6b9108989caf0708b41383f71f457535eb8358f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0bf4633a_a4aa0eaf",
        "filename": "ios/web/web_state/ui/crw_web_controller.mm",
        "patchSetId": 2
      },
      "lineNbr": 1091,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-10-30T15:33:03Z",
      "side": 1,
      "message": "Sorry for vague comment. Steps to clear visited links:\n1.) Search in google for puppies (kittens also work)\n2.) Tap on the first link\n3.) Go back\n4.) Open Settings\n5.) Tap Privacy\n6.) Tap Clear Browsing Data\n7.) Tap Clear Browsing Data\n\nExpected result:\nPreviously clicked link is blue, not purple\n\n\u003e\u003e (1) destroy the WKWebView when it\u0027s not needed to avoid playing audio and whatnot\nNo, SetWebUsageEnabled(false) is not called during native view load\n\n\u003e\u003e (2) force clearing browsing data\nYes, SetWebUsageEnabled(false) is called to clear visited link.\n\n\u003e\u003e What I\u0027m trying to change is (1) here.\nAre you sure this is the right place? |removeWebView| call is already hidden behind IsSlimNavigationManagerEnabled() check and SetWebUsageEnabled(false) is not called during native view load.\n\n\u003e\u003e Would it make sense to create a separate API for (2) to preserve its functionality? Would this be feasible?\nIt would make sense to remove SetWebUsageEnabled API and replace it with API, which sole purpose is clearing visited links. But I don\u0027t know how that API will help with native view load.",
      "parentUuid": "51d3743f_4dfe3634",
      "range": {
        "startLine": 1091,
        "startChar": 16,
        "endLine": 1091,
        "endChar": 28
      },
      "revId": "e6b9108989caf0708b41383f71f457535eb8358f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}