{
  "comments": [
    {
      "key": {
        "uuid": "9d176911_e684f65a",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 420,
      "author": {
        "id": 1002500
      },
      "writtenOn": "2017-09-05T15:18:04Z",
      "side": 1,
      "message": "Do you need to check resultCode? I guess we are fine with updating whatever the result...?",
      "range": {
        "startLine": 420,
        "startChar": 25,
        "endLine": 420,
        "endChar": 26
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a0105dab_784fe507",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 420,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-09-05T15:40:32Z",
      "side": 1,
      "message": "Yeah - it\u0027s Android\u0027s activity and there\u0027s no documentation saying it will give us a useful result code so we should just update regardless.",
      "parentUuid": "9d176911_e684f65a",
      "range": {
        "startLine": 420,
        "startChar": 25,
        "endLine": 420,
        "endChar": 26
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e0736d5_f7bae5df",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1002500
      },
      "writtenOn": "2017-09-05T15:18:04Z",
      "side": 1,
      "message": "Under what circumstances can mSite be null here?",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33003938_4de2c3f3",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-09-05T15:40:32Z",
      "side": 1,
      "message": "If the activity is killed in the background eg due to memory pressure we lose all its state - although actually I just discovered that getPreferenceScreen() will be null too in that case so currently this crashes!\n\nFixed now by nullchecking getPreferenceScreen first. (If it is null then we get an onActivityCreated before the onActivityResult so can rely on the usual initialization path.)",
      "parentUuid": "4e0736d5_f7bae5df",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ad1bf442_4af66740",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1002500
      },
      "writtenOn": "2017-09-05T15:47:31Z",
      "side": 1,
      "message": "Please document (comment) the null checks you\u0027ve added.",
      "parentUuid": "33003938_4de2c3f3",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e6d6a19d_da6c630e",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-09-05T18:12:54Z",
      "side": 1,
      "message": "Hmmm I\u0027ve had a bit more of a look at this to see when mSite and the preference could *actually* be null, and while I think in practice mSite should never be null when the preference screen is null, because of the order in which they are initialized in \u0027onWebsitePermissionsAvailable\u0027, I\u0027m also starting to get worried we could end up with a race condition if my code calls displaySitePermissions at the same time as the code in \u0027onWebsitePermissionsAvailable\u0027 calls displaySitePermissions, since onWebsitePermissionsAvailable is called asynchronously. (They could try to remove the same pref twice or something and crash..). \n\nI\u0027m also thinking we probably should also persist mSite to the bundle in onSaveInstanceState in the case where it was populated from the origin, wdyt? That would actually help with the race condition issue too, because it wouldn\u0027t have to go get the permissions asynchronously again.",
      "parentUuid": "ad1bf442_4af66740",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "25fa1e88_ed682c4f",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-09-06T10:06:31Z",
      "side": 1,
      "message": "... guess I could just stick in a \u0027synchronized\u0027 on displaySitePermissions for now and do the onSaveInstanceState stuff in a followup CL?",
      "parentUuid": "e6d6a19d_da6c630e",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e74f7a58_26fe82df",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/website/SingleWebsitePreferences.java",
        "patchSetId": 2
      },
      "lineNbr": 423,
      "author": {
        "id": 1002500
      },
      "writtenOn": "2017-09-06T10:30:14Z",
      "side": 1,
      "message": "Yeah, sure, you could add \u0027synchronized\u0027 to displaySitePermissions. But I would probably discuss this concern with someone more knowledgeable to see if it is a redundant safeguard.",
      "parentUuid": "25fa1e88_ed682c4f",
      "range": {
        "startLine": 423,
        "startChar": 51,
        "endLine": 423,
        "endChar": 56
      },
      "revId": "479d7c77629e38afbb51b20d080608dad6af5188",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}