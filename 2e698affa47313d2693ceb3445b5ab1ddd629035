{
  "comments": [
    {
      "key": {
        "uuid": "3f4835ba_bab6d915",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 15,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "14-19: Could we please use the definition from the correct zlib include file, rather than redefine it.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e2b3574e_9d05c0b0",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 15,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T21:13:17Z",
      "side": 1,
      "message": "I rather not because we lack any control on what zlib will ship or define in the future.\n\nAnother advantage is that in this way this code can be easily tested standalone.",
      "parentUuid": "3f4835ba_bab6d915",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5d25ee8e_ec50b150",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 15,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-25T23:02:21Z",
      "side": 1,
      "message": "I think Noel is suggesting to use the ZLIB_INTERNAL which is already defined in zutil.h\nhttps://cs.chromium.org/chromium/src/third_party/zlib/zutil.h?type\u003dcs\u0026q\u003dzlib+HAVE_HIDDEN\u0026sq\u003dpackage:chromium\u0026l\u003d17\n\nAs opposed to trying to find a zlib-provided replacement for USE_ARMV8_CRC32. I think perhaps that caused some confusion/miscommunication here?\n\nI think using zutil.h\u0027s ZLIB_INTERNAL makes sense.\n\nIf they change ZLIB_INTERNAL (unlikely) we\u0027ll have to change as well. But I think that makes sense. Similarly, if ZLIB changes the inner workings of zlib/crc32.c we\u0027ll also need to reflect those changes.",
      "parentUuid": "e2b3574e_9d05c0b0",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2c979f1_a9abd5ab",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 15,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-29T11:34:33Z",
      "side": 1,
      "message": "\u003e I think Noel is suggesting to use the ZLIB_INTERNAL which is already defined in zutil.h\n\nExactly.",
      "parentUuid": "5d25ee8e_ec50b150",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b30701b7_4b9103dd",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 15,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-29T20:01:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c2c979f1_a9abd5ab",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5918de0c_7206cfd8",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 26,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "#ifdef not needed: the build file rules exclude this file when this feature is disabled.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5b3b658_4996b74f",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 26,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:54:47Z",
      "side": 1,
      "message": "IIRC that was needed to make one of the bots happy (Windows or fuchsia? Dunno).",
      "parentUuid": "5918de0c_7206cfd8",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "03178d72_699fa8ec",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 26,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-29T11:34:33Z",
      "side": 1,
      "message": "Remove it and let\u0027s see.  It sure it won\u0027t be the windows bot, and fuchsia will compile it.",
      "parentUuid": "e5b3b658_4996b74f",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36e6153d_613a97b7",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 26,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-29T20:01:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "03178d72_699fa8ec",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0fb897b4_119715a2",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 36,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Magic numbers. They can vary with arch (see below). Does #include \u003casm/hwcap.h\u003e not work for you?",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33c23f7b_a8435b3b",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 36,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:54:47Z",
      "side": 1,
      "message": "This seems to be the approach used everywhere else in Chromium code base (i.e. skia, boringssl, etc).\n\nI can add a TODO towards change everywhere to start using the header file.",
      "parentUuid": "0fb897b4_119715a2",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "157eddb8_1619821d",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 36,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-25T23:02:21Z",
      "side": 1,
      "message": "I wouldn\u0027t say this is a magic number. It has a name (flag_crc32) which makes the meaning clear.\n\n\nThe asm/hwcap.h thing looks useful though. More on that below.",
      "parentUuid": "33c23f7b_a8435b3b",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5b1d236b_a23017bc",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 36,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-02-01T20:52:47Z",
      "side": 1,
      "message": "The new patchset uses the named constants like HWCAP_CRC32 so I\u0027m marking this as resolved.",
      "parentUuid": "157eddb8_1619821d",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "72d0f5d5_132a728b",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "http://bit.ly/2CcoEsr talks about android CPU features, and refers a code change in AOSP that implemented the feature.\n\nUnder the hood, they use getauxval(AT_HWCAP) for aarch64, but they use getauxval(AT_HWCAP2) for aarch32. Reading into the linux kernel code, that looks correct and also in other code I\u0027ve searched that used getauxval detect at runtime in an arch-dependent way.\n\nCan you please check, or ask around it, so we can resolve which arch is being targeted here?  Can we support both by reading the correct getauxval(), AT_HWCAP vs AT_HWCAP2?",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a43f9e1_e6583d67",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:54:47Z",
      "side": 1,
      "message": "It is a good point and it is a bit unclear really.\n\nLet\u0027s breakdown the problem: this would be used only for ChromeOS (CrOS) or ARM Linux (as in android we use getCpuFeatures()).\n\nThe article suggests using AT_HWCAP for aarch64. I tested this standalone as a 64bits binary and it works fine in a 64bits kernel.\n\nI haven\u0027t tested the scenario of running in 32bits@ARMv8.\n\nIIRC, Chrome ships as a 32bits binary in ChromeOS (even though the kernel is 64bits).\n\nGiven that this is disabled for now for CrOS because it seems that its scripts will bypass the needed compiler flag to enable the use of the crc32 instruction (i.e. -march\u003darmv8-a+crc), I think we are safe.\n\nWhen I enable this for CrOS I can double check this scenario (i.e. 32bits binary running in a 64bits kernel).",
      "parentUuid": "72d0f5d5_132a728b",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8336680_07fd8a78",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-25T23:02:21Z",
      "side": 1,
      "message": "I wouldn\u0027t focus on just Chromium\u0027s builds and CrOS. Since this is going to be upstreamed this needs to be generic.\n\n\nIf asm/hwcap.h provides a clear CRC32 / PMULL define I strongly prefer it.\nIt looks like those exist sometimes but not always.\nLooking here:\nhttp://elixir.free-electrons.com/linux/v2.6.39.4/source/arch/arm/include/asm/hwcap.h\nThe PMULL define is \"FAST_MULT\" and CRC32 is \"EDSP\". That doesn\u0027t seem right. But that\u0027s for an old kernel version.\n\nA newer kernel version:\nhttp://elixir.free-electrons.com/linux/latest/source/arch/arm/include/uapi/asm/hwcap.h#L39\nhas HWCAP2_PMULL and HWCAP2_CRC32. But notice it doesn\u0027t have HWCAP_CRC32 and HWCAP_PMULL.\n\nThis might be the reason why Skia and boringssl wouldn\u0027t use these?\n\n\nIf the defines are available:\n- when we build for AArch32, we want to use AT_HWCAP2 and HWCAP2_PMULL / HWCAP2_CRC32.\n- When we build for AArch64, we want to use AT_HWCAP and HWCAP_CRC32 and HWCAP_PMULL.\n\nCan we try that?",
      "parentUuid": "5a43f9e1_e6583d67",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6ccbb3a_1c34cae1",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-26T19:00:20Z",
      "side": 1,
      "message": "I realized why my new-kernel-version link didn\u0027t have HWCAP_CRC32 and HWCAP_PMULL. I was looking in arch/arm and not arch/arm64. The correct link for AArch64 builds is:\nhttp://elixir.free-electrons.com/linux/latest/source/arch/arm64/include/uapi/asm/hwcap.h\n\nThe defines in there match the (1 \u003c\u003c 4) and (1 \u003c\u003c 7) we have here.\n\n\nI also found a bit more info explaining why this funky situation happened:\nhttps://sourceware.org/ml/libc-help/2017-08/msg00013.html\n\nEssentially, AArch32 ran out of bits in AT_HWCAP and needed more, so they added AT_HWCAP2.\nAArch64 is treated as a completely separate arch and doesn\u0027t reuse the old values/bits. They defined a new set. They eliminated a bunch and no longer needed the extra bits if AT_HWCAP2.\n\n\nI think this should look something like:\n#include \u003casm/hscap.h\u003e\n\n#if defined(ARMV8_OS_LINUX)\n  #if defined(__aarch64__)\n    flag_crc32 \u003d HWCAP_CRC32;\n    flag_pmull \u003d HWCAP_PMULL;\n    capabilities \u003d getauxval(AT_HWCAP);\n  #else // AArch32\n    flag_crc32 \u003d HWCAP2_CRC32;\n    flag_pmull \u003d HWCAP2_PMULL;\n    capabilities \u003d getauxval(AT_HWCAP2);\n  #endif\n#elif defined(ARMV8_OS_ANDROID)\n    flag_crc32 \u003d ANDROID_CPU_ARM_FEATURE_CRC32;\n    flag_pmull \u003d ANDROID_CPU_ARM_FEATURE_PMULL;\n    capabilities \u003d android_getCpuFeatures();\n#endif",
      "parentUuid": "d8336680_07fd8a78",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "302e4160_5524a96d",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-26T19:02:00Z",
      "side": 1,
      "message": "Actually, I should change that #else to:\n#elif defined(__aarch32__)\n(to be future-proof)",
      "parentUuid": "d6ccbb3a_1c34cae1",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "72916d9e_53a68d38",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-26T19:43:11Z",
      "side": 1,
      "message": "Okay, one last comment, I swear. :D\n(Maybe)\n\nThat code I posted looks good to me. But it doesn\u0027t address the issue of \"These won\u0027t be defined when building for old kernels and glibc\". THAT seems to be why all these other libraries define them themselves. They seem to all say \"We copied these bits from hwcap.h\".\n\n\nSo I am okay with either:\n- Using #include \u003casm/hwcap.h\u003e and these defines, or\n- Defining our own values and saying they came from asm/hwcap.h.\n\n\nIf we use our own defines, we\u0027ll have the broadest range of support. So that is probably the route we should take.\n\nBut we still want to have the separate code paths for AArch32 and AArch64.",
      "parentUuid": "302e4160_5524a96d",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c4b9de63_8a604955",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-29T11:34:33Z",
      "side": 1,
      "message": "\u003e But we still want to have the separate code paths for AArch32 and AArch64.\n\nAgree, I provided an idea for that over here [1]\n\n[1] https://chromium-review.googlesource.com/c/chromium/src/+/864582/10/third_party/zlib/arm.c#51\n\nI\u0027d prefer that we use #include \u003casm/hwcap.h\u003e, rather than define our own since we not sure if they changed meaning in earlier Linux.\n\n(And a sandboxed process can use it btw, since the value is stored in the process environment preamble, just before the argc/argv variables.)",
      "parentUuid": "72916d9e_53a68d38",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c11991f1_2c3aedbb",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-29T22:49:13Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c4b9de63_8a604955",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "659b95fa_586f305a",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 54,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "#ifdef not needed: the build file rules exclude this file when this feature is disabled.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e93e5333_de8668e5",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 54,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:31:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "659b95fa_586f305a",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a2f9d76f_7b347ab9",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 60,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Not used.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "773ca344_ef9304e5",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 60,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:31:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a2f9d76f_7b347ab9",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1d2710ba_c14d405c",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 64,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Not used.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3263065f_46045c2d",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.c",
        "patchSetId": 13
      },
      "lineNbr": 64,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:31:06Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1d2710ba_c14d405c",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b2c470a_c5f7f23b",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 5,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-02-02T01:19:37Z",
      "side": 1,
      "message": "nit: zlib style uses FILENAME_H\n\nand a matching  \n \n#endif  /* FILENAME_H */\n\nPlease fix everywhere.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f49e0685_a58234f5",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "bool.  The natural type of any CPU is int, and can also be and very useful aid in debugging (eg., AT_HWCAP/2 problem). Please use int here and below.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "89a6ef17_385779b3",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:29:25Z",
      "side": 1,
      "message": "Using bool helps to document the purpose and the possible states of this flag.\n\nPlease check:\nhttps://softwareengineering.stackexchange.com/questions/145323/when-should-you-use-bools-in-c\n\nQuote: \"When choosing variable types and variable names you want your intent to be as clear as possible. If you choose a bool (boolean) type, it is clear there are only two acceptable values: true or false. If you use an int (integer) type, it is no longer clear that the intent of that variable can only be 1 or 0 or whatever values you chose to mean true and false\".\n\nIn the end everything will treated using an \u0027rn\u0027 register, no to mention that the number of instructions used are the same:\nhttps://godbolt.org/g/UJvQ9a",
      "parentUuid": "f49e0685_a58234f5",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "411dbaad_cb2970ab",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-25T23:02:21Z",
      "side": 1,
      "message": "If we plan to be built using an old C standard, bool may not be available.\nBut if we are using an old C standard, we might not have access to a new-enough libc to use HWCAP_CRC32 / HWCAP2_CRC32 anyway.\n\nNevertheless, we should probably use a BOOL to attempt to support as much as possible. The x86 feature detection does this:\nhttps://cs.chromium.org/chromium/src/third_party/zlib/x86.c?l\u003d66\u0026rcl\u003dca112b210e77187e6d64158c3a3e5a2365f4231f\n\n\nThey should probably also have a more bool-y name.\nIdeally, it could be something like is_crc32_supported. But in an attempt to minimize name collision, these have all been prefixed with \"arm_\". I think that prefix makes sense -- we\u0027re inside contrib/optimizations/arm.\nSo maybe arm_is_crc32_supported.\n\nThey should probably be ZLIB_INTERNAL. All of this should be, really.",
      "parentUuid": "89a6ef17_385779b3",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9e95f3bd_60d4bd2b",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-29T11:34:33Z",
      "side": 1,
      "message": "\u003e If we plan to be built using an old C standard, bool may not be available.\n\nOne success of zlib has been it\u0027s portability, and bool might not be available everywhere.  We should be able to include this file without guards on any zlib port.  Using _int_ gives us that.  Please use int.",
      "parentUuid": "411dbaad_cb2970ab",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c89c93e3_5f3b51c6",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-02-01T20:52:47Z",
      "side": 1,
      "message": "But old C compilers which require int will fail for other reasons: The include for the intrinsics.\n\nAt the end of the day, the minimum compiler requirement for contrib/optimizations/arm/ guarantees bool is supported.\n\nIf someone needs to use an old C compiler, they cannot use contrib/optimizations/arm/.\n\n\n\nIt may be possible to use a new compiler set to an old standard. That seems like a rare case though. And importantly, I don\u0027t think that is a case we want to support. Anything inside contrib/ becomes our responsibility to support. The cost of supporting everything becomes very high and provides us little benefit. It isn\u0027t worth it.",
      "parentUuid": "9e95f3bd_60d4bd2b",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8462a353_56fef970",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 9,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-02-02T01:19:37Z",
      "side": 1,
      "message": "The amount of back/for on this matter should be a warning to us that we\u0027re giving upstream the opportunity quibble about it.  You yourself mentioned that in a code review with me the other day, you called it \"risk\".\n\nYour points about compiler support are true and all, and I see Adenilson\u0027s points about type usage, but what I see is the potential that you\u0027ll need to re-explain it all to upstream (and that adds risk).\n\nIt has been said in many places that the \"job of the maintainer is to say no\". So if your give the maintainer any excuse they\u0027ll say \"no\", simply because they are too busy and short on time, dealing with better patches that do follow the ways of zlib. \n\nThis patch has diverged from the ways of zlib in various places, adding risk.  If we follow the ways of zlib, risk is minimized.  Looking back at the code reviews for the Intel patch [1], reviewers did not question the use of int for the x86 feature enables at all, it was a non-issue.\n\nIf you want to make it an issue upstream, you increase the risk of the maintainer saying \"no\" since portability is what they value over all else (its one of the key reasons that zlib has been successful).  If you use int, the maintainer has few reasons to say \"no\", imho, but if you use bool, I\u0027m not so sure.\n\n[1] https://codereview.chromium.org/552123005",
      "parentUuid": "c89c93e3_5f3b51c6",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c6782eaa_41394930",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 14,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Used anywhere?",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a778352_229ec8e6",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 14,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:29:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c6782eaa_41394930",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "82afe030_1a7cce31",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 16,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Used anywhere?",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f91c8424_069397ab",
        "filename": "third_party/zlib/contrib/optimizations/arm/arm_features.h",
        "patchSetId": 13
      },
      "lineNbr": 16,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:29:25Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "82afe030_1a7cce31",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f55dff0d_271f686c",
        "filename": "third_party/zlib/contrib/optimizations/arm/armv8_crc32.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "4, what is 4?  I\u0027d understand 8 or 64, but not quite sure why the 4. Perhaps it\u0027s hangover from an earlier version of this code?",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a09754f_c1e3eb27",
        "filename": "third_party/zlib/contrib/optimizations/arm/armv8_crc32.c",
        "patchSetId": 13
      },
      "lineNbr": 38,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T20:34:16Z",
      "side": 1,
      "message": "Yep, a leftover (but not a hangover).\n:-P",
      "parentUuid": "f55dff0d_271f686c",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bda70ef2_0431ead1",
        "filename": "third_party/zlib/contrib/optimizations/arm/armv8_crc32.h",
        "patchSetId": 13
      },
      "lineNbr": 14,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "zlib solves with z_size_t, let\u0027s use that.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "018ad4f4_e1782e25",
        "filename": "third_party/zlib/contrib/optimizations/arm/armv8_crc32.h",
        "patchSetId": 13
      },
      "lineNbr": 14,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T21:13:17Z",
      "side": 1,
      "message": "I rather not because we lack any control on what zlib will ship or define in the future.\n\nAnother advantage is that in this way this code can be easily tested standalone.\n\nFinally, I know for sure what is going to be the real size of a \u0027size_t\u0027 (something important while using NEON).",
      "parentUuid": "bda70ef2_0431ead1",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e3fdce62_45852e05",
        "filename": "third_party/zlib/contrib/optimizations/arm/armv8_crc32.h",
        "patchSetId": 13
      },
      "lineNbr": 14,
      "author": {
        "id": 1189229
      },
      "writtenOn": "2018-01-25T23:02:21Z",
      "side": 1,
      "message": "I think I agree with Noel.\n\nIf we need a specific size, we should use a fixed-size type.\nIf we need a specific size for different targets, we probably want our own define.\nBut if we are using it for a length (for this API, I think we are) we probably do want to use z_size_t. We\u0027ll need to manually convert to a fixed-sized type but I think that is the correct thing to do.",
      "parentUuid": "018ad4f4_e1782e25",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc7f9828_7c6114e6",
        "filename": "third_party/zlib/contrib/optimizations/inflate.c",
        "patchSetId": 13
      },
      "lineNbr": 210,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "No need to check features here.  inflate calls crc32(0, Z_NULL,0) before ever using the crc32 routine right? (please check). And your crc32 automatically arm_check_features() when it does.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b97852a_b903a0e6",
        "filename": "third_party/zlib/contrib/optimizations/inflate.c",
        "patchSetId": 13
      },
      "lineNbr": 210,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T21:18:12Z",
      "side": 1,
      "message": "Helps to keep the symmetry (plus I\u0027m planning to remove the intel stub code).",
      "parentUuid": "fc7f9828_7c6114e6",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "194a937c_0475f150",
        "filename": "third_party/zlib/contrib/optimizations/inflate.c",
        "patchSetId": 13
      },
      "lineNbr": 210,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-29T11:34:33Z",
      "side": 1,
      "message": "No need for the symmetry.  We can remove arm_check_features() now since it\u0027s not needed.",
      "parentUuid": "9b97852a_b903a0e6",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "30bc0763_bdac577c",
        "filename": "third_party/zlib/contrib/optimizations/inflate.c",
        "patchSetId": 13
      },
      "lineNbr": 210,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-29T20:14:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "194a937c_0475f150",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a593a099_b3e5bc44",
        "filename": "third_party/zlib/crc32.c",
        "patchSetId": 13
      },
      "lineNbr": 36,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "#if not needed, like our other #include, you can #include these files without the #if guard I believe. If not, please make it so.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce84b146_f00fea3d",
        "filename": "third_party/zlib/crc32.c",
        "patchSetId": 13
      },
      "lineNbr": 261,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "Nice attempt, but a little hard to read through here. To make it plain, cargo cult (copy) the if (buf ...) test into your feature define below.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6919b08d_521654c7",
        "filename": "third_party/zlib/deflate.c",
        "patchSetId": 13
      },
      "lineNbr": 289,
      "author": {
        "id": 1109754
      },
      "writtenOn": "2018-01-25T17:46:32Z",
      "side": 1,
      "message": "No need to check features here.  deflate calls crc32(0, Z_NULL,0) before ever using the crc32 routine right? (please check). And your crc32 automatically arm_check_features() when it does.",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5948c9a8_940e29ef",
        "filename": "third_party/zlib/deflate.c",
        "patchSetId": 13
      },
      "lineNbr": 289,
      "author": {
        "id": 1145695
      },
      "writtenOn": "2018-01-25T21:18:12Z",
      "side": 1,
      "message": "Ditto.",
      "parentUuid": "6919b08d_521654c7",
      "revId": "2e698affa47313d2693ceb3445b5ab1ddd629035",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}