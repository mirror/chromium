{
  "comments": [
    {
      "key": {
        "uuid": "c9f9da4a_030bf376",
        "filename": "chrome/browser/chrome_browser_main_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 72,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "Many of the previous CL iterations have the same issue, but I forgot to ask about it. What\u0027s the lifetime of ChildProcessCrashObserver vs. g_browser_process-\u003elocal_state()? Is it possible for ChildProcessCrashObserver to call the callback that wraps IncreaseCrashCount() after the object g_browser_process-\u003elocal_state() points to has been destroyed?",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d33193e_2ae43ca2",
        "filename": "chrome/browser/chrome_browser_main_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 72,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "g_browser_process-\u003elocal_state() is available till shutdown, it should have same lifetime as g_browser_process.\n\nhttps://cs.chromium.org/chromium/src/chrome/browser/browser_shutdown.cc?l\u003d167",
      "parentUuid": "c9f9da4a_030bf376",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "306848f2_34828829",
        "filename": "chrome/browser/chrome_browser_main_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 72,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T23:43:21Z",
      "side": 1,
      "message": "Yes, since BrowserProcessImpl\u0027s |local_state_| member is a unique_ptr, they share the same lifetime.\n\nShutdownPreThreadsStop() is not used on Android though. I see ShutdownPostThreadsStop() in the same file which is similarly non-Android, and it deletes |g_browser_process|. I don\u0027t see any other place that deletes |g_browser_process|, so I\u0027m wondering if Chrome on Android even has a concept of shutdown. Does it just get killed by the OS instead?\n\nCrashDumpObserver OTOH, is a LazyInstance and can potentially outlive |g_browser_process|. Or maybe because desktop style shutdown does not happen on Android, then this is probably ok. I guess it all depends on how shutdown works on Android. Please check make sure.",
      "parentUuid": "1d33193e_2ae43ca2",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0cc54ede_66cc5963",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 22,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "So if |increase_crash_cb| becames a base::Closure, then you need to write a small adaptor and use it here, with |increase_crash_cb_| remaining as a base::Callback\u003cvoid(bool)\u003e.\n\nbase::Bind(\u0026IncreaseCrashHelper, increase_crash_cb);",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4ee6cf01_7f8a1163",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 22,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0cc54ede_66cc5963",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b6fd4e2c_9c91214b",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 25,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "Can you mention why you added this explicit shutdown behavior?",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e6d4e6e_611efc03",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 25,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "I don\u0027t it\u0027s necessary here. I was referring other code and some of them have it.",
      "parentUuid": "b6fd4e2c_9c91214b",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "073443fc_7a868dc2",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.h",
        "patchSetId": 21
      },
      "lineNbr": 18,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "Didn\u0027t think of this earlier, but it might be a nicer interface to take a base::Closure instead, with the contract being that ChildProcessCrashObserver will only call the base::Closure when it determines that the closure needs to be called. See other comments that help explain what would change as a result.",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b3ba56a2_393cd642",
        "filename": "components/crash/content/browser/child_process_crash_observer_android.h",
        "patchSetId": 21
      },
      "lineNbr": 18,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "073443fc_7a868dc2",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7ab8cc8d_8e3a082c",
        "filename": "components/crash/content/browser/crash_dump_manager_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 114,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "Just: increase_crash_count \u003d is_running || is_paused;",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f15f2c02_159bcc75",
        "filename": "components/crash/content/browser/crash_dump_manager_android.cc",
        "patchSetId": 21
      },
      "lineNbr": 114,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7ab8cc8d_8e3a082c",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ea9a4ffb_d4d31bd0",
        "filename": "components/crash/content/browser/crash_dump_manager_android.h",
        "patchSetId": 21
      },
      "lineNbr": 34,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "Document what the return value means. Since it does not mean success or failure.",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "153bd0ff_cae26498",
        "filename": "components/crash/content/browser/crash_dump_manager_android.h",
        "patchSetId": 21
      },
      "lineNbr": 34,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ea9a4ffb_d4d31bd0",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "67fe9456_bc841993",
        "filename": "components/metrics/stability_metrics_helper.cc",
        "patchSetId": 21
      },
      "lineNbr": 169,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "If ChildProcessCrashObserver can take a base::Closure, then you can just remove this and assume IncreaseCrashCount() would only get called if it was set to true.",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3d5eea85_4af89310",
        "filename": "components/metrics/stability_metrics_helper.cc",
        "patchSetId": 21
      },
      "lineNbr": 169,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "67fe9456_bc841993",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c997ed67_ba2188eb",
        "filename": "components/metrics/stability_metrics_helper.cc",
        "patchSetId": 21
      },
      "lineNbr": 173,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "nit: Probably don\u0027t need this, since you are already in the metrics namespace. See the function above for examples. Same on the next line.",
      "range": {
        "startLine": 173,
        "startChar": 30,
        "endLine": 173,
        "endChar": 39
      },
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "15e15e81_0a2c853c",
        "filename": "components/metrics/stability_metrics_helper.cc",
        "patchSetId": 21
      },
      "lineNbr": 173,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c997ed67_ba2188eb",
      "range": {
        "startLine": 173,
        "startChar": 30,
        "endLine": 173,
        "endChar": 39
      },
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1aca65a9_adc132ff",
        "filename": "components/metrics/stability_metrics_helper.h",
        "patchSetId": 21
      },
      "lineNbr": 52,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "style: Capitalize the \"i\" in increase. If you are not sure of all the style guide rules, look around in the existing code and try to blend in.",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9dd1eb84_8d177bd4",
        "filename": "components/metrics/stability_metrics_helper.h",
        "patchSetId": 21
      },
      "lineNbr": 52,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done. I was writing Java for a while and haven\u0027t changed my mind back to C++..",
      "parentUuid": "1aca65a9_adc132ff",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6b509b5c_82465e4d",
        "filename": "content/shell/browser/shell_browser_main_parts.cc",
        "patchSetId": 21
      },
      "lineNbr": 179,
      "author": {
        "id": 1001934
      },
      "writtenOn": "2017-08-22T03:01:20Z",
      "side": 1,
      "message": "If ChildProcessCrashObserver can take a base::Closure, then you can just pass in base::Bind(\u0026base::DoNothing) here.",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2cd29cb2_65e055e5",
        "filename": "content/shell/browser/shell_browser_main_parts.cc",
        "patchSetId": 21
      },
      "lineNbr": 179,
      "author": {
        "id": 1117450
      },
      "writtenOn": "2017-08-22T17:51:00Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6b509b5c_82465e4d",
      "revId": "416d11cb63ccf9c38834a6f086571d260bbb096a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}