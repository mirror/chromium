{
  "comments": [
    {
      "key": {
        "uuid": "b2bb95c6_5e507497",
        "filename": "media/audio/audio_debug_recording_manager.h",
        "patchSetId": 6
      },
      "lineNbr": 55,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "Remove",
      "range": {
        "startLine": 55,
        "startChar": 32,
        "endLine": 55,
        "endChar": 52
      },
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c060f69a_12316393",
        "filename": "media/audio/audio_debug_recording_manager.h",
        "patchSetId": 6
      },
      "lineNbr": 55,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:54:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b2bb95c6_5e507497",
      "range": {
        "startLine": 55,
        "startChar": 32,
        "endLine": 55,
        "endChar": 52
      },
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f0b27998_060a02dd",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 7,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "These includes go below after system includes.",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ec4f9d72_3616b07f",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 7,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:54:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f0b27998_060a02dd",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d391959a_693ddf87",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 283,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "Initialize at declaration.",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1963b6f5_96637280",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 283,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:58:23Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d391959a_693ddf87",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "00e64f85_1f39bd50",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 292,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "I wonder if we should allow the functions being called from different threads/sequences. What\u0027s the rationale for that?",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a67be84_dfd51810",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 292,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:54:24Z",
      "side": 1,
      "message": "This should only be called from AudioDebugRecordingManager\u0027s sequence, since AudioDebugRecordingManager now makes a direct call to AudioDebugRecordingWriter::StartRecording, it no longer calls AudioDebugRecordingHelper that posts a task with AudioDebugRecordingFileWriter::Start.",
      "parentUuid": "00e64f85_1f39bd50",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7f24985c_dba252ad",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 292,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T14:10:25Z",
      "side": 1,
      "message": "OK, then let\u0027s keep the sequence checker. Or was there another reason for removing it?",
      "parentUuid": "8a67be84_dfd51810",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d69341c_f7dfcbba",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "|file_writer_| could be concurrently accessed here and in StartRecording(), if they are called from different sequences.",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae77a666_e591bae5",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:54:24Z",
      "side": 1,
      "message": "That shouldn\u0027t happen, based on line 292 comment.",
      "parentUuid": "8d69341c_f7dfcbba",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37b6f836_82aff60c",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 313,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T14:10:25Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "ae77a666_e591bae5",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "40292f63_d98ad4c3",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 330,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T14:10:25Z",
      "side": 1,
      "message": "OnData() is called from the soundcard thread so |file_writer_| can\u0027t be accessed here safely.",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49cc5a0d_21737ccb",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 333,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T12:10:57Z",
      "side": 1,
      "message": "Is this still valid with the sequence check removed?",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "036d88e0_5b441330",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 333,
      "author": {
        "id": 1247905
      },
      "writtenOn": "2017-12-06T12:54:24Z",
      "side": 1,
      "message": "I think so, for the same reasons from line 292.",
      "parentUuid": "49cc5a0d_21737ccb",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aec2349b_ce10d3a4",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 333,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T14:10:25Z",
      "side": 1,
      "message": "Oh, sorry, this is not affected at all since |file_writer_| is the of the inner class, and it\u0027s deleted on the same task runner.",
      "parentUuid": "036d88e0_5b441330",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b3d35d3b_2bf68312",
        "filename": "media/audio/audio_debug_recording_writer.cc",
        "patchSetId": 6
      },
      "lineNbr": 338,
      "author": {
        "id": 1002285
      },
      "writtenOn": "2017-12-06T14:10:25Z",
      "side": 1,
      "message": "Here, |file_write_| we could get a valid pointer, but if there\u0027s a context switch between that and posting the task, and StopRecording() is run in its entirety before continuing here, the delete task will be posted before this task and we have a use after free when this task is finally run.\n\nI\u0027m not sure how to solve this easily from the top of my head, maybe it\u0027s not possible to remove the extra thread hop without introducing a lock. We can look at it more closely offline.",
      "revId": "1b463974e42a4d96c0cebfcab20f60936ee3d4c2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}