{
  "comments": [
    {
      "key": {
        "uuid": "b3ae7c9e_c1b7e7d9",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/FullscreenActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1116074
      },
      "writtenOn": "2017-08-25T00:22:30Z",
      "side": 1,
      "message": "I have a few questions around the change here: (I think I understand the general idea, please let me know if my comments indicate that I dont :) ).\n\n- So do we think the reason for that glimpse of a second tab is because we are detaching the old tab early? Since we are still launching the new activity, doesn\u0027t that mean visually we should be seeing the new FA at the same time? Or is it that we lose the visuals for the tab on CTA because we are detaching? I would have expected it to not be so since we are never calling hide on the tab.\n\nMaybe sharing a video of the current situation might help to talk over it since there might actually be more visual glitches in this specific transition?\n\nAnd for sever(), can we make use of Tab.detach() in any way. It would be fine to change it slightly, but would be nice if we have a single call for \"detach but don\u0027t do any intent stuff\"\n\nI wonder we even need everything in sever/detach. We do need the removeTab. We need updateWindowAndroid mostly because of the way I built the logic (set to null and set to non-null separately.) We may not need the null setting for TabContentManager actually.",
      "range": {
        "startLine": 49,
        "startChar": 12,
        "endLine": 49,
        "endChar": 17
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82a19973_230839dd",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/FullscreenActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-29T09:30:00Z",
      "side": 1,
      "message": "Sorry for my delayed response! Yes, I\u0027d prefer to reuse the code in detach instead of making sever.\n\nYou can see the effect in the first video here: https://bugs.chromium.org/p/chromium/issues/detail?id\u003d757878#c4 . You get a glimpse of the background Tab (youtube) when the current Tab is entering fullscreen.\n\nI believe what is happening is:\n- We detach the Tab from CTA.\n- Since the Tab is detached we see the background Tab (I assume TabModel#removeTab triggers this).\n- Android creates the FA and the Tab is attached to that.\n\nBut you\u0027re saying that we should only see the background Tab if we call hide on the detached Tab? Couldn\u0027t hide be called by TabModel#removeTab?",
      "parentUuid": "b3ae7c9e_c1b7e7d9",
      "range": {
        "startLine": 49,
        "startChar": 12,
        "endLine": 49,
        "endChar": 17
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "04d825ca_f7005d14",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/FullscreenActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1116074
      },
      "writtenOn": "2017-08-31T22:24:43Z",
      "side": 1,
      "message": "I see. So I do know that hide is not getting called on removeTab, but looks like the old Activity\u0027s model is calling select tab when we remove the other and that probably triggers a show on the next tab. So the reparented tab still doesn\u0027t get hidden, but the tab behind is selected and shown.\n\nSadly, we do have to select and show it for general case, since in a multi window world we have to assume the old activity is still alive and maybe still showing at least partially. So then your design does makes sense in the way that, we wait to reparent until we can have the focus in the new activity and draw UI to avoid seeing the transitional effects in the old activity.",
      "parentUuid": "82a19973_230839dd",
      "range": {
        "startLine": 49,
        "startChar": 12,
        "endLine": 49,
        "endChar": 17
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "839739b2_ae908f99",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/FullscreenActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 122,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-24T16:00:56Z",
      "side": 1,
      "message": "The logic for sending Tabs back from FullscreenActivity to ChromeTabbedActivity is pretty much the same, its the CTA -\u003e FA transition that has changed.",
      "range": {
        "startLine": 122,
        "startChar": 24,
        "endLine": 122,
        "endChar": 50
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "880623ae_5d1e253d",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/FullscreenActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 122,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-29T15:22:39Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "839739b2_ae908f99",
      "range": {
        "startLine": 122,
        "startChar": 24,
        "endLine": 122,
        "endChar": 50
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "86fbd48a_8d69d975",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/tab/Tab.java",
        "patchSetId": 1
      },
      "lineNbr": 1417,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-24T16:00:56Z",
      "side": 1,
      "message": "This is basically \u0027detach\u0027 above but without the parts that fiddle with the intent.",
      "range": {
        "startLine": 1417,
        "startChar": 16,
        "endLine": 1417,
        "endChar": 21
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7e2ec130_04a8b21c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/tab/Tab.java",
        "patchSetId": 1
      },
      "lineNbr": 1417,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-29T15:22:39Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "86fbd48a_8d69d975",
      "range": {
        "startLine": 1417,
        "startChar": 16,
        "endLine": 1417,
        "endChar": 21
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "afef16ae_63a96d99",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/tab/Tab.java",
        "patchSetId": 1
      },
      "lineNbr": 1420,
      "author": {
        "id": 1116074
      },
      "writtenOn": "2017-08-25T00:22:30Z",
      "side": 1,
      "message": "onDestroy for the old activity will destroy the tab and any related things.",
      "range": {
        "startLine": 1420,
        "startChar": 57,
        "endLine": 1420,
        "endChar": 61
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bfbe3606_01db110d",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/tab/Tab.java",
        "patchSetId": 1
      },
      "lineNbr": 1420,
      "author": {
        "id": 1149979
      },
      "writtenOn": "2017-08-29T15:22:39Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "afef16ae_63a96d99",
      "range": {
        "startLine": 1420,
        "startChar": 57,
        "endLine": 1420,
        "endChar": 61
      },
      "revId": "cea5a322aa0d277a8f428b976a277bb3a10fb462",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}