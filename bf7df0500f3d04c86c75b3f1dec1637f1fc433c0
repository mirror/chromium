{
  "comments": [
    {
      "key": {
        "uuid": "55b6eaf8_ff76a1ed",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-10-26T19:47:01Z",
      "side": 1,
      "message": "nit: delete this comment and add a single blank line between each method definition",
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a5f8d501_001e844b",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 13,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-26T20:36:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "55b6eaf8_ff76a1ed",
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2ae5b00_5daf16f3",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-10-26T19:47:01Z",
      "side": 1,
      "message": "it seems like this (and the other methods in this file) should all pass true to the callback, no? i assume that you\u0027re trying to simulate success here. i think that base::nullopt should only be passed if you\u0027re trying to simulate failed d-bus calls.",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b5a1d4ce_ef4c2d09",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-26T20:36:10Z",
      "side": 1,
      "message": "In the original CL for fake_image_loader_client https://codereview.chromium.org/2450923002, it does try to simulate a failure. Then the CL https://chromium-review.googlesource.com/c/chromium/src/+/666944 to switch from callback.Run(DBUS_METHOD_CALL_FAILURE, \"\") to std::move(callback).Run(base::nullopt), it keep simulating the failure which is consistent. \nBut for other fake_*_client (e.g. fake_cryptohome_client), they do simulate success and returns true for bool callback. \nMaybe there is some in-consistence here across different fake_*_clients?",
      "parentUuid": "e2ae5b00_5daf16f3",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "aeba7b66_376cec89",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-10-26T21:16:19Z",
      "side": 1,
      "message": "i think it mostly depends on what it\u0027s being used for. as i generally understand it, Fake*Client classes are used for two things:\n\n- unit tests\n- OS_CHROMEOS builds of chrome that are being run on developers\u0027 workstations\n\nfor the first case, you\u0027re testing code that uses this class, so you probably want some way to simulate successful calls, calls that return false, and calls that return nullopt (i.e. d-bus error). the usual way to do that is to add a member that contains the result that will be returned, along with a setter like set_result(base::Optional result) that can be called from tests to control the behavior.\n\nfor the second case, i don\u0027t have a good idea about the desired behavior. will this class ever get called in that place, or does ImageLoaderClient only get exercised when running on an actual chrome os device?",
      "parentUuid": "b5a1d4ce_ef4c2d09",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e9022e28_d5d55e07",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-26T21:47:31Z",
      "side": 1,
      "message": "FakeImageLoaderClient is never used as unit test, so I think second case applies here. Each method in ImageLoaderClient here is to send a dbus signal to imageloader to invoke its corresponding APIs (RegisterComponent -\u003e RegisterComponent, LoadComponent -\u003e LoadComponent, RequestComponentVersion -\u003e getComponentVersion, etc.). Imageloader (and its dbus API) exists only on a real device. So in the case of running chrome on developers\u0027 workstations, desired behavior is failure due to missing imageloader.",
      "parentUuid": "aeba7b66_376cec89",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7532ef1b_30cafedf",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-26T23:12:51Z",
      "side": 1,
      "message": "And I think unit test is not necessary in this case for FakeImageLoaderClient since its logic is  just to map each method to its corresponding imageloader API in a linear fashion and unit test is unable to verity method call since imageloader is not availble.",
      "parentUuid": "e9022e28_d5d55e07",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "007b0c38_15f63b0e",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-10-26T23:54:15Z",
      "side": 1,
      "message": "thanks for the explanation!\n\nre unit tests, i was referring to testing the code that calls the ImageLoaderClient interface. that looks like it\u0027s chrome/browser/component_updater/cros_component_installer_unittest.cc, right? if you wanted to verify that that code does the right thing when ImageLoaderClient reports success, you\u0027d probably want to update FakeImageLoaderClient to support returning arbitrary values.",
      "parentUuid": "7532ef1b_30cafedf",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "48cb1570_c99d7c7e",
        "filename": "chromeos/dbus/fake_image_loader_client.cc",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-27T16:44:09Z",
      "side": 1,
      "message": "I see. The test cros_component_installer_unittest isn\u0027t testing OnCustomInstall (invokes ImageLoaderClient) since it\u0027s a callback used by its parent class. Thanks for pointing this out, I will try to leverage Fake*Client for my unit test next time.",
      "parentUuid": "007b0c38_15f63b0e",
      "range": {
        "startLine": 29,
        "startChar": 26,
        "endLine": 29,
        "endChar": 39
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7fdbdc4a_53fe6ef8",
        "filename": "chromeos/dbus/image_loader_client.h",
        "patchSetId": 2
      },
      "lineNbr": 41,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-10-26T19:47:01Z",
      "side": 1,
      "message": "nit: \"Removes\", \"returns\"",
      "range": {
        "startLine": 41,
        "startChar": 5,
        "endLine": 41,
        "endChar": 11
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "446d2cc6_7442d8f7",
        "filename": "chromeos/dbus/image_loader_client.h",
        "patchSetId": 2
      },
      "lineNbr": 41,
      "author": {
        "id": 1178302
      },
      "writtenOn": "2017-10-26T20:36:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7fdbdc4a_53fe6ef8",
      "range": {
        "startLine": 41,
        "startChar": 5,
        "endLine": 41,
        "endChar": 11
      },
      "revId": "bf7df0500f3d04c86c75b3f1dec1637f1fc433c0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}