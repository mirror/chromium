{
  "comments": [
    {
      "key": {
        "uuid": "cba475a2_2d12df58",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 78,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "s/kNoChromeAccount/kNoChromePrimaryAccount",
      "range": {
        "startLine": 78,
        "startChar": 2,
        "endLine": 78,
        "endChar": 18
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0b78f4d1_200e9413",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 78,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cba475a2_2d12df58",
      "range": {
        "startLine": 78,
        "startChar": 2,
        "endLine": 78,
        "endChar": 18
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d05cba03_db0e4043",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 80,
      "author": {
        "id": 1258891
      },
      "writtenOn": "2018-01-31T15:41:01Z",
      "side": 1,
      "message": "IIUC, this will log whether the account that we sign out of was the Chrome account. I think the purpose of the request in https://bugs.chromium.org/p/chromium/issues/detail?id\u003d801607 was specifically about knowing if sync was enabled for an account that we sign out of, which could still be true or false even if it was the Chrome account right?",
      "range": {
        "startLine": 80,
        "startChar": 17,
        "endLine": 80,
        "endChar": 30
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14cc2941_f577eda2",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 80,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-01-31T15:55:17Z",
      "side": 1,
      "message": "The chrome authenticated account and the sync account are the same thing.\n\nIt may be possible that somehow the user is signed into chrome but then disabled all datatypes in sync, in which case we could consider them to be authenticated but not syncing. I think this is enough of an edge case to be neglected, but let me know if you want to make that distinction.",
      "parentUuid": "d05cba03_db0e4043",
      "range": {
        "startLine": 80,
        "startChar": 17,
        "endLine": 80,
        "endChar": 30
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22ca8e5c_e931a05b",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 80,
      "author": {
        "id": 1258891
      },
      "writtenOn": "2018-02-01T17:01:56Z",
      "side": 1,
      "message": "Thanks David!\n\nThat makes sense that almost all signed in to Chrome users are syncing right now. I think we would expect more users to be signed in and not syncing in a Dice world though right? Maybe the metric would be more future proof if we make it explictly about sync?",
      "parentUuid": "14cc2941_f577eda2",
      "range": {
        "startLine": 80,
        "startChar": 17,
        "endLine": 80,
        "endChar": 30
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c001704b_f3cf1914",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 80,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T17:27:28Z",
      "side": 1,
      "message": "\"almost all signed in to Chrome users are syncing right now.\"\nThere is no difference between these two. Signed to Chrome and signed to Sync is the exact same thing, and there are no plans to change this in the future.\n\nWe use the term \"Chrome account\" everywhere currently so I would not want to rename this histogram to use \"Sync account\", it would be confusing.",
      "parentUuid": "22ca8e5c_e931a05b",
      "range": {
        "startLine": 80,
        "startChar": 17,
        "endLine": 80,
        "endChar": 30
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e94b6a4_dea128bd",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 80,
      "author": {
        "id": 1258891
      },
      "writtenOn": "2018-02-02T09:54:19Z",
      "side": 1,
      "message": "Thanks for the clarifications off-thread. I understand now that \"Authenticated\" means that sync is on, and that users that don\u0027t enable sync after going through a Dice content area login aren\u0027t counted as \"authenticated\".\n\nLGTM :)",
      "parentUuid": "c001704b_f3cf1914",
      "range": {
        "startLine": 80,
        "startChar": 17,
        "endLine": 80,
        "endChar": 30
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a76a95d3_d9ef3f1b",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 81,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "s/kChromeAccountIsFirstGaiaAccount/kChromePrimaryAccountIsFirstGaiaAccount",
      "range": {
        "startLine": 81,
        "startChar": 2,
        "endLine": 81,
        "endChar": 34
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e2cc166_a9c99f8f",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 81,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a76a95d3_d9ef3f1b",
      "range": {
        "startLine": 81,
        "startChar": 2,
        "endLine": 81,
        "endChar": 34
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a92ff1d6_42d66730",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 84,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "s/kChromeAccountIsOtherGaiaAccount/kChromePrimaryAccountIsSecondaryGaiaAccount",
      "range": {
        "startLine": 84,
        "startChar": 2,
        "endLine": 84,
        "endChar": 34
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e59a5830_a820896b",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 84,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a92ff1d6_42d66730",
      "range": {
        "startLine": 84,
        "startChar": 2,
        "endLine": 84,
        "endChar": 34
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0ad6a62a_5328da5b",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 88,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "kChromePrimaryAccountIsNotInGaiaAccounts",
      "range": {
        "startLine": 88,
        "startChar": 2,
        "endLine": 88,
        "endChar": 35
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa0fc1ee_08087eea",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 88,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0ad6a62a_5328da5b",
      "range": {
        "startLine": 88,
        "startChar": 2,
        "endLine": 88,
        "endChar": 35
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8df39c2f_85e77b0d",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 156,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "s/chrome_primary_account/chrome_primary_account_id",
      "range": {
        "startLine": 156,
        "startChar": 23,
        "endLine": 156,
        "endChar": 45
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "98150553_79ff2c63",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 385,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "I think knowing the state ChromeAccountStateInGaiaCookies here would simplify the code below. Suggested change:\n\nChromeAccountStateInGaiaCookies sign_out_mode \u003d ChromeAccountStateInGaiaCookies(..);\nUMA_HISTOGRAM_ENUMERATION(kChromeAccountStateOnWebSignoutHistogram, sign_out_mode,\n                          kChromeAccountStateInGaiaCookiesCount);\nif (sign_out_mode \u003d\u003d kChromeAccountIsFirstGaiaAccount || kChromeAccountIsOtherGaiaAccount) {\n       RecordDiceResponseHeader(kSignoutPrimary);\n\n      // If Dice migration is not complete, the token for the main account must\n      // not be deleted when signing out of the web.\n      if (!signin::IsDiceEnabledForProfile(signin_client_-\u003eGetPrefs()))\n        continue;\n\n      VLOG(1) \u003c\u003c \"[Dice] Signing out all accounts.\";\n      signin_manager_-\u003eSignOutAndRemoveAllAccounts(\n          signin_metrics::SERVER_FORCED_DISABLE,\n          signin_metrics::SignoutDelete::IGNORE_METRIC);\n  return;\n}\n\n// Just revoke tokens for the secondary accounts.\n...",
      "range": {
        "startLine": 385,
        "startChar": 14,
        "endLine": 385,
        "endChar": 29
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a425e9f8_90cac476",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 385,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "I did this on purpose:\n* if we want to remove the histogram when dice is launched, it\u0027s better to keep the code separate\n* I want to cherry pick this on beta, so it\u0027s better if the change does not affect other code.\n\nHowever, I just realized that this histogram is actually very similar to the other histogram RecordDiceResponseHeader(). So we can just add the new calls together with these, and have a very small change in the end. The new version is much simpler.\n\nI think I will have merge conflicts anyway, so it probably won\u0027t make too much of a difference on that side.",
      "parentUuid": "98150553_79ff2c63",
      "range": {
        "startLine": 385,
        "startChar": 14,
        "endLine": 385,
        "endChar": 29
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c065989e_5f0c7085",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 423,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "I do not understand why we need \"signin::IsDiceEnabledForProfile(signin_client_-\u003eGetPrefs())\" in here (sorry for this additional question that has nothing to do with your CL).",
      "range": {
        "startLine": 423,
        "startChar": 6,
        "endLine": 423,
        "endChar": 68
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7598cb6a_245c7f64",
        "filename": "chrome/browser/signin/dice_response_handler.cc",
        "patchSetId": 7
      },
      "lineNbr": 423,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "This is a good question.\n\nI put this specifically so that it will be easier to remove the \"if\" when dice is fully enabled and we remove the flags.\nWhen Dice will be enabled secondary_accounts.size() \u003d\u003d account_infos.size() will always be true, but I think it\u0027s not very easy to see, and maybe we would be scared to remove that test in the future. With this version of the code, it\u0027s obvious that it\u0027s safe to remove it.",
      "parentUuid": "c065989e_5f0c7085",
      "range": {
        "startLine": 423,
        "startChar": 6,
        "endLine": 423,
        "endChar": 68
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd88a6f1_1a195a74",
        "filename": "tools/metrics/histograms/enums.xml",
        "patchSetId": 7
      },
      "lineNbr": 4734,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "Add \"Gaia\": \"in Gaia cookies.\"",
      "range": {
        "startLine": 4734,
        "startChar": 63,
        "endLine": 4734,
        "endChar": 70
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea8f9db0_9084cdce",
        "filename": "tools/metrics/histograms/enums.xml",
        "patchSetId": 7
      },
      "lineNbr": 4734,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2018-02-01T13:53:06Z",
      "side": 1,
      "message": "Add \"primary\": Chrome primary account",
      "range": {
        "startLine": 4734,
        "startChar": 31,
        "endLine": 4734,
        "endChar": 38
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f162079b_65db6793",
        "filename": "tools/metrics/histograms/enums.xml",
        "patchSetId": 7
      },
      "lineNbr": 4734,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "bd88a6f1_1a195a74",
      "range": {
        "startLine": 4734,
        "startChar": 63,
        "endLine": 4734,
        "endChar": 70
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "36aa519f_3ab5cbdb",
        "filename": "tools/metrics/histograms/enums.xml",
        "patchSetId": 7
      },
      "lineNbr": 4734,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2018-02-01T15:58:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ea8f9db0_9084cdce",
      "range": {
        "startLine": 4734,
        "startChar": 31,
        "endLine": 4734,
        "endChar": 38
      },
      "revId": "0820cf2bde64eadcb8bfc16df8c81470242fdd67",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}