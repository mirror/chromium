{
  "comments": [
    {
      "key": {
        "uuid": "285b13b2_544bb802",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 269,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T00:56:36Z",
      "side": 1,
      "message": "What is ETA for this? When prod server is ready. And if it is not ready, what is the benefit to include code that does not work for users?",
      "range": {
        "startLine": 268,
        "startChar": 18,
        "endLine": 269,
        "endChar": 16
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8f863e7_b8ba60e2",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 269,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-26T23:07:42Z",
      "side": 1,
      "message": "Perhaps, in a week.\nBut we also have a problem with dogfooding/bug bashing (we want to test as fresh functionality as possible, of course). Currently, only dev-channel (and up), but no Canary devices can access the prod server. And there might be big gaps (several weeks) between Dev builds.\nSo, it seems a right thing to land changes with new functionality as soon as possible, making them work with both old and new server, and then wait when both server and dev channel become ready, as opposed to waiting for the server, then landing the client-side CL, then waiting for dev channel release.",
      "parentUuid": "285b13b2_544bb802",
      "range": {
        "startLine": 268,
        "startChar": 18,
        "endLine": 269,
        "endChar": 16
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9499921_6cfde5b2",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 269,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T23:20:40Z",
      "side": 1,
      "message": "ack, it is good to add bug number instead of (vadimt)",
      "parentUuid": "b8f863e7_b8ba60e2",
      "range": {
        "startLine": 268,
        "startChar": 18,
        "endLine": 269,
        "endChar": 16
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "23fa460e_debb8a9e",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 269,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-26T23:52:17Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b9499921_6cfde5b2",
      "range": {
        "startLine": 268,
        "startChar": 18,
        "endLine": 269,
        "endChar": 16
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6cfd4434_f1334c02",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T23:20:40Z",
      "side": 1,
      "message": "nit: else is not required:\n\nif (!head..) {\n  ...\n  return true; or false actually?\n}\n\n....",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9094f110_a254237f",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-26T23:52:17Z",
      "side": 1,
      "message": "We shouldn\u0027t early return here. The return value should be true, as the header is optional. Returning false would indicate an invalid card that should be ignored.\nIf the header is missing, we are using result_url_ populated in ::Start()",
      "parentUuid": "6cfd4434_f1334c02",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f6b77675_48a784c4",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T23:57:34Z",
      "side": 1,
      "message": "I mean:\n\n\n  if (!headers-\u003eGetNormalizedHeader(kSearchAnswerIssuedQuery, \u0026issued_query)) {\n    VLOG(1) \u003c\u003c \"Warning: \" \u003c\u003c kSearchAnswerIssuedQuery\n            \u003c\u003c \" header is not present\";\n    return true;\n  }\n\n  // The header contains the autocompleted query that corresponds to the card\n  // contents. Use it for the open-URL, and for deduplication with the omnibox\n  // search results.\n  result_url_ \u003d\n      template_url_service_-\u003eGetDefaultSearchProvider()\n          -\u003eurl_ref()\n          .ReplaceSearchTerms(TemplateURLRef::SearchTermsArgs(\n                                  base::UTF8ToUTF16(issued_query)),\n                              template_url_service_-\u003esearch_terms_data());\n  \n  return true;\n}",
      "parentUuid": "9094f110_a254237f",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e3c89a7_96d0ca8f",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-27T00:19:16Z",
      "side": 1,
      "message": "This is fragile, as we may want to parse more headers below, and they\u0027d be ignored in the case of early return.",
      "parentUuid": "f6b77675_48a784c4",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3adf10ae_9f3c7ba3",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-27T00:28:40Z",
      "side": 1,
      "message": "we need to follow \"guard clause pattern:\". I am doing review based on current code. We will arrange code accordingly when need this. In this code, pattern above does apply..",
      "parentUuid": "4e3c89a7_96d0ca8f",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "55b7b5d7_2d8925ea",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 273,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-07-27T01:55:18Z",
      "side": 1,
      "message": "I\u0027m fine with the current structure. While there is a prevalence of early returns over if/else blocks at the end of functions, it seems to me this is done mostly when there isn\u0027t a reason to do one or the other. Here, there is a reason. We want to able to, and are likely to, add code after the current block.\n\nI think it\u0027s good to leave code in a state where it\u0027s easy to read and easy to add to. The structure of the code for the single case suggests that the structure can be extended to parsing extra headers. An early return for the single case doesn\u0027t seem to be generalizable to multiple headers, if we will need to revert back to a single return at the end for multiple headers.\n\nPut another way, if I came to this code without understanding anything and wanted to parse another header, I\u0027d probably just copy-paste the first one, and it would be nice if a naive approach yielded the correct behavior.\n\nPersonally, I see patterns as guidelines, that can be broken if there are good reasons. Hope this helps!\n\n\n\nHaving said all that, it might be worth inverting the logic here so that the error case is in the else clause.\n\nif (hasThing())\n  doWork()\nelse\n  warn(error)\n\nseems more natural than\n\nif (!hasThing())\n  warn(error)\nelse\n  doWork()",
      "parentUuid": "3adf10ae_9f3c7ba3",
      "range": {
        "startLine": 273,
        "startChar": 4,
        "endLine": 273,
        "endChar": 8
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d6b0b56_a079051f",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 282,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T23:20:40Z",
      "side": 1,
      "message": "These lines look identical to L94-98. Would it be possible to extract to this to separate function?",
      "range": {
        "startLine": 277,
        "startChar": 4,
        "endLine": 282,
        "endChar": 76
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea1fb824_e7891566",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 282,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-26T23:52:17Z",
      "side": 1,
      "message": "Not worth it IMHO, as in ~1 week I\u0027ll check in the code that will remove the other copy (when the server change ends up in prod). This is the part of cleanup covered by the above TODO.",
      "parentUuid": "2d6b0b56_a079051f",
      "range": {
        "startLine": 277,
        "startChar": 4,
        "endLine": 282,
        "endChar": 76
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f63b3700_ed2848fd",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 282,
      "author": {
        "id": 1136699
      },
      "writtenOn": "2017-07-26T23:57:34Z",
      "side": 1,
      "message": "This is few min work that keeps code well structured.",
      "parentUuid": "ea1fb824_e7891566",
      "range": {
        "startLine": 277,
        "startChar": 4,
        "endLine": 282,
        "endChar": 76
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "77a69053_27c4e31d",
        "filename": "chrome/browser/ui/app_list/search/answer_card/answer_card_search_provider.cc",
        "patchSetId": 1
      },
      "lineNbr": 282,
      "author": {
        "id": 1116056
      },
      "writtenOn": "2017-07-27T00:19:16Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f63b3700_ed2848fd",
      "range": {
        "startLine": 277,
        "startChar": 4,
        "endLine": 282,
        "endChar": 76
      },
      "revId": "60849d33316d5588a4653f7a8ebe5654eac88132",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}