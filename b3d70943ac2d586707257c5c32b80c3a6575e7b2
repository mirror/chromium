{
  "comments": [
    {
      "key": {
        "uuid": "bf4555d1_e061cd40",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsBottomSheetContent.java",
        "patchSetId": 1
      },
      "lineNbr": 457,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-12-06T17:00:00Z",
      "side": 1,
      "message": "I think a better way to do this is ensuring that the toolbar\u0027s #isLocationBarShownInNTP check returns true when the toolbar is translated for the NTP, rather than exposing the toolbar background method. Then the toolbar code can handle updating its background accordingly.",
      "revId": "b3d70943ac2d586707257c5c32b80c3a6575e7b2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "60d3c3e8_350533aa",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsBottomSheetContent.java",
        "patchSetId": 1
      },
      "lineNbr": 457,
      "author": {
        "id": 1115980
      },
      "writtenOn": "2017-12-12T14:29:01Z",
      "side": 1,
      "message": "I looked into that, but it seems #isLocationBarShownInNTP is not called at the right times to make that sufficient. For example, it is not called at all while the sheet contents are scrolled or when the sheet is dragged.",
      "parentUuid": "bf4555d1_e061cd40",
      "revId": "b3d70943ac2d586707257c5c32b80c3a6575e7b2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e746e8e_c10f9507",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsBottomSheetContent.java",
        "patchSetId": 1
      },
      "lineNbr": 457,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-12-12T16:07:43Z",
      "side": 1,
      "message": "Instead of relying on #isLocationBarShownInNtp, we could try overriding computeVisualState() in BottomToolbarPhone to return NEW_TAB_NORMAL when a normal NTP is showing. Bottom/ToolbarPhone.java should be notified when a new tab is created/hidden via #onTabOrModelChanged() which already makes a call to updateVisualsForToolbarState().\n\nDoes the toolbar background need to get set back to white when the sheet is scrolled/dragged? What happens if we leave it transparent? BottomSheet sets a background color on the entire container while the sheet is open so that may be sufficient to ensuring the toolbar appears to have a white background.\n\nIf we need to know when the sheet is dragged, BottomToolbarPhone has a BottomSheetObserver method that can be used to determine when the sheet offset changes if there\u0027s some edge case we need to handle there.\n\nI definitely think we should keep ToolbarPhone.VisualState private. If BottomToolbarPhone needs additional methods to notify it of sheet/content movement so that it can correctly compute state (or BottomSheet needs to expose new methods), that\u0027d be preferable to directly exposing #updateToolbarBackground.",
      "parentUuid": "60d3c3e8_350533aa",
      "revId": "b3d70943ac2d586707257c5c32b80c3a6575e7b2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96e40c32_80ed1b2c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsBottomSheetContent.java",
        "patchSetId": 1
      },
      "lineNbr": 457,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-12-13T01:23:07Z",
      "side": 1,
      "message": "It turns out my recommendation to use NEW_TAB_NORMAL has a lot of pitfalls related to animations.\n\nAdditionally, to answer my own question about why this needs to get set back to white -- when the sheet is closing the toolbar needs a white background or the Doodle sliding beneath it looks really odd. Additionally, when the RecyclerView content is scrolled beneath the toolbar we need the background to be white.\n\nI have a CL out that exposes a new set #setShownInNtp() so that the toolbar bg is only set to transparent while the toolbar is closed.",
      "parentUuid": "0e746e8e_c10f9507",
      "revId": "b3d70943ac2d586707257c5c32b80c3a6575e7b2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db4313ec_8a170f28",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsBottomSheetContent.java",
        "patchSetId": 1
      },
      "lineNbr": 457,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-12-13T01:23:51Z",
      "side": 1,
      "message": "s/while the toolbar is closed/while the toolbar is translated.",
      "parentUuid": "96e40c32_80ed1b2c",
      "revId": "b3d70943ac2d586707257c5c32b80c3a6575e7b2",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}