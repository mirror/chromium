{
  "comments": [
    {
      "key": {
        "uuid": "4123997d_ec7599a0",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 8
      },
      "lineNbr": 290,
      "author": {
        "id": 1000602
      },
      "writtenOn": "2017-06-21T00:16:12Z",
      "side": 1,
      "message": "Woah I\u0027ve never seen this type of thing before. I found it very hard to read and took quite some time but it may just be because I\u0027m not familiar with all the nuance of gtest/mock.\n\nIn my experience, tests are often clearer (easier to write, read, debug) if you just implement your own Mock/Fake subclasses that do whatever is needed. e.g. in this case it wouldn\u0027t have been hard to have the MockBridge just hold an instance variable of channels which could be modified by the test and returned (probably the same class could be used for all tests). \n\nSeparately, I also tend to prefer to use base::RunLoop+QuitClosure rather than RunUntilIdle equivalents because it makes the semantics more well-defined.\n\nBut with that said, I don\u0027t think it\u0027s necessary to rewrite this now, just something to keep in mind for the future.",
      "revId": "7b9fe78b3bb2af3d4d95b97383aef8cc0ebfdcca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edddc034_6cf86214",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 8
      },
      "lineNbr": 290,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-21T10:36:56Z",
      "side": 1,
      "message": "Thanks for your thoughts - will definitely bear in mind in future. I agree it\u0027s hard to see what\u0027s going on here, and it *was* tricky to debug during development (doesn\u0027t help there\u0027s multiple mocks involved either). I\u0027m not at all familiar with nuances of gtest/mock either, so there could well be a nicer way of doing this. I quite like your idea of using a Fake subclass. (Or how about even using a real bridge?! I don\u0027t know if the jni calls would work from a unit test though.. but maybe from a browser test?)",
      "parentUuid": "4123997d_ec7599a0",
      "revId": "7b9fe78b3bb2af3d4d95b97383aef8cc0ebfdcca",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}