{
  "comments": [
    {
      "key": {
        "uuid": "635a540c_54af75eb",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 30,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "Please use Nullable from android.support.annotation package.",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 33
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dc331a8_9050bdf5",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 30,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "635a540c_54af75eb",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 30,
        "endChar": 33
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0b4408df_01bdc98e",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 55,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "There are two problems here:\n1. getActivity will return null, because Fragment is not attached yet.\n2. Fragment can be reattached to another activity if it\u0027s instance is retained (see https://developer.android.com/reference/android/app/Fragment.html#setRetainInstance(boolean)). Indirectly retaining reference to Activity can create a leak here. This being said, this leak won\u0027t actually happen, because SigninManager gets application context from passed Context, but it\u0027s impossible to understand from reading this file only.\n\nIf you want to cache SigninManager instance here, please use ContextUtils.getApplicationContext(). I\u0027d keep the old approach with getting it whenever necessary, though.",
      "range": {
        "startLine": 55,
        "startChar": 43,
        "endLine": 55,
        "endChar": 56
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f84f4d02_66700cb6",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 55,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0b4408df_01bdc98e",
      "range": {
        "startLine": 55,
        "startChar": 43,
        "endLine": 55,
        "endChar": 56
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "520876ce_b87a7b19",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 87,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "I find save/load naming a bit misleading here as it creates impression that you save preferences in persistent storage.",
      "range": {
        "startLine": 87,
        "startChar": 8,
        "endLine": 87,
        "endChar": 23
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1449f33_621a5ed0",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 87,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "This function got removed in the new implementation.",
      "parentUuid": "520876ce_b87a7b19",
      "range": {
        "startLine": 87,
        "startChar": 8,
        "endLine": 87,
        "endChar": 23
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5d9d7d2d_f94923b7",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 97,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "The old ordering in this method was matching the ordering in XML file, so can you please keep it?",
      "range": {
        "startLine": 94,
        "startChar": 0,
        "endLine": 97,
        "endChar": 82
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1fcbe61_b56794c7",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 97,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5d9d7d2d_f94923b7",
      "range": {
        "startLine": 94,
        "startChar": 0,
        "endLine": 97,
        "endChar": 82
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a317d388_212fe537",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 137,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-09-01T23:53:36Z",
      "side": 1,
      "message": "nit: s/Preference Screen/PreferenceScreen",
      "range": {
        "startLine": 137,
        "startChar": 17,
        "endLine": 137,
        "endChar": 18
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e2342cba_c89d4e0b",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 137,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "The function got removed in the new implementation.",
      "parentUuid": "a317d388_212fe537",
      "range": {
        "startLine": 137,
        "startChar": 17,
        "endLine": 137,
        "endChar": 18
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3595a91c_c8b47a05",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 185,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "This line will add preferences to the end of the list and violate ordering specified in XML. This issue is a tricky one to solve, so let\u0027s discuss it offline whenever you have time.",
      "range": {
        "startLine": 185,
        "startChar": 0,
        "endLine": 185,
        "endChar": 88
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0662a1d4_6b41e90b",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 185,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-09-01T23:53:36Z",
      "side": 1,
      "message": "This should add the preference based on its \"order\", with ties being broken by putting preferences in alphabetical order. Right now our ordering comes from XML. We should check whether Preference objects retain their order when added/removed from the PreferenceScreen (we can check via Preference#getOrder()).\n\nIf they don\u0027t retain their order from XML, we can try adding android:order to the preferences in main_preferences.xml and see if that makes the ordering sticky.",
      "parentUuid": "3595a91c_c8b47a05",
      "range": {
        "startLine": 185,
        "startChar": 0,
        "endLine": 185,
        "endChar": 88
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d4a315a_37466605",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 185,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "After some offline discussions, Boris and I decided that maybe a more flexible way of loading preferences would be to remove the XML file altogether and add them programmatically. The preferences were, indeed, added in the same order as the one defined in the XML so there were no problems when it came to that but at the same time we weren\u0027t able to find a place in the documentation that stated the order will be maintained. We also think that changing the implementation altogether will provide a cleaner approach to the whole problem. What do you think of the current implementation (patch #6)?",
      "parentUuid": "0662a1d4_6b41e90b",
      "range": {
        "startLine": 185,
        "startChar": 0,
        "endLine": 185,
        "endChar": 88
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fa4e6129_92dfbfd3",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 185,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-09-05T18:44:17Z",
      "side": 1,
      "message": "I like that the XML defined preferences make it was easy to add a new preference and that our implementation matches the Android documentation for how to create settings screens (https://developer.android.com/guide/topics/ui/settings.html). Unless we have a really compelling reason, I\u0027d like to go with the standard approach so that we don\u0027t have to author our documentation explaining how our preferences work.\n\nIs your concern is that there isn\u0027t Android documentation explicitly stating what happens to ordering when preferences are programatically added/removed? If so, would using the android:order attribute in the XML help alleviate that concern?\n\nWe could also set android:orderingFromXml\u003d\"false\" up to make it very explicit. The Android documentation is clear that android:order will be used when orderingFromXml is false. https://developer.android.com/reference/android/preference/PreferenceGroup.html#attr_android:orderingFromXml",
      "parentUuid": "7d4a315a_37466605",
      "range": {
        "startLine": 185,
        "startChar": 0,
        "endLine": 185,
        "endChar": 88
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f23ddfd9_b70a6f11",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 185,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-06T12:40:49Z",
      "side": 1,
      "message": "I added android:order and android:orderingFromXML to the XML file, thanks!",
      "parentUuid": "fa4e6129_92dfbfd3",
      "range": {
        "startLine": 185,
        "startChar": 0,
        "endLine": 185,
        "endChar": 88
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "20b87a2a_44458488",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-09-01T23:53:36Z",
      "side": 1,
      "message": "Can we save all preferences in a LinkedHashMap? That would keep a consistent ordering while allowing for fast lookups. Or just a regular HashMap if all we need is look ups and not in-order iteration.",
      "range": {
        "startLine": 197,
        "startChar": 0,
        "endLine": 201,
        "endChar": 9
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "49a4e9cd_01d44beb",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 201,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "This function got removed in the new implementation.",
      "parentUuid": "20b87a2a_44458488",
      "range": {
        "startLine": 197,
        "startChar": 0,
        "endLine": 201,
        "endChar": 9
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "096253a9_59aee2a9",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 228,
      "author": {
        "id": 1209769
      },
      "writtenOn": "2017-09-01T12:38:09Z",
      "side": 1,
      "message": "Nit: no space here.",
      "range": {
        "startLine": 228,
        "startChar": 31,
        "endLine": 228,
        "endChar": 32
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2d79b91d_22a00c46",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 228,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-09-01T23:53:36Z",
      "side": 1,
      "message": "I didn\u0027t know you could declare Runnables this way, very interesting.",
      "range": {
        "startLine": 228,
        "startChar": 27,
        "endLine": 228,
        "endChar": 51
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e79c4ef_19d04f7e",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 228,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2d79b91d_22a00c46",
      "range": {
        "startLine": 228,
        "startChar": 27,
        "endLine": 228,
        "endChar": 51
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d9e41f12_6872ec1c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/preferences/MainPreferences.java",
        "patchSetId": 4
      },
      "lineNbr": 228,
      "author": {
        "id": 1227839
      },
      "writtenOn": "2017-09-04T16:37:18Z",
      "side": 1,
      "message": "The space is automatically added by \"git cl format\". After some offline discussion, replaced it with \u0027() -\u003e updatePreferences()\u0027 to bypass the weird formatting.",
      "parentUuid": "096253a9_59aee2a9",
      "range": {
        "startLine": 228,
        "startChar": 31,
        "endLine": 228,
        "endChar": 32
      },
      "revId": "ed801a9a74e6d9bd9ee6cc9da89627ee47b27b1e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}