{
  "comments": [
    {
      "key": {
        "uuid": "cbbb4de2_ce93e6e2",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-11-10T00:27:46Z",
      "side": 1,
      "message": "this class just abstracts out common display-power code that\u0027s shared between PowerButtonController and TabletPowerButtonController. launching a note-taking app in response to the stylus being ejected feels out of scope for it.\n\nplease do this from some other place that\u0027s more specific to lock screen note-taking apps instead.",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6a0593c3_b226964b",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1147616
      },
      "writtenOn": "2017-11-10T00:48:13Z",
      "side": 1,
      "message": "For this condition, it seems it doesn\u0027t handle the case of auto screen off due to user inactivity.\n\nNot this CL related, I found chrome doesn\u0027t report stylus rejected as user activity. Thus, stylus rejected doesn\u0027t turn screen on for user-inactivity screen off.\n\nAnd I agree with Dan, PowerButton* code doesn\u0027t look like a good host for note-taking impl.",
      "parentUuid": "cbbb4de2_ce93e6e2",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dcbfc08_6455229b",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000232
      },
      "writtenOn": "2017-11-10T17:56:26Z",
      "side": 1,
      "message": "yeah, I didn\u0027t find adding this logic to PowerButton* class ideal either - the reason was that this is where setting screen state due to stylus ejection was done.\n\nThough, the main connection of this class to power button is that it\u0027s owned by power button classes (there doesn\u0027t seem to be anything power button specific in the class logic itself) - it seems like it could be easily generalized into display_power_controller that can be used by both power button and lock screen apps code (and maybe its ownership can be moved to ash/shell.h). Let me look into doing this.",
      "parentUuid": "6a0593c3_b226964b",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "00f036b1_6eb611ea",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-11-11T06:49:07Z",
      "side": 1,
      "message": "sorry, but i don\u0027t think that renaming PowerButtonDisplayController is the right approach here either. this is a helper class used by the power button classes; they use it to force the display off, and it handles turning the display back on in response to various events.\n\nDisplayPowerController isn\u0027t an appropriate name for it since there\u0027s other unrelated code related to displays\u0027 power states (see e.g. https://cs.chromium.org/chromium/src/ui/display/manager/chromeos/display_configurator.h?q\u003dSetDisplayPower\u0026sq\u003dpackage:chromium\u0026l\u003d229). please keep the current name for this class.\n\nwhy can\u0027t a lock-screen-note-taking-specific class observe stylus eject events directly and handle launching the app itself? is the problem that you need additional information about the display state to determine whether you should launch the app? if you explain more about what you need, we can try to figure out a cleaner way of getting the information to the right place.\n\n(feel free to move this discussion to the bug, which seems like it might be a better place to nail down the design of this.)",
      "parentUuid": "7dcbfc08_6455229b",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "921aa228_1464570e",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000232
      },
      "writtenOn": "2017-11-11T07:36:31Z",
      "side": 1,
      "message": "It\u0027s not so much about determining whether to launch the app or not.\nThe problem this is trying to solve is keeping the display off until the app is shown (when the stylus gets ejected), and POwerButtonDisplayController handling of stylus removal event conflicts with that.",
      "parentUuid": "00f036b1_6eb611ea",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b1b9b0a9_09a12262",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-11-12T07:30:04Z",
      "side": 1,
      "message": "if the app isn\u0027t able to appear immediately, is it possible to fix this by making the app (or some other layer) initially appear as a solid black window that can be drawn immediately? that seems like it\u0027ll have the same effect while also keeping all of the complexity in one place instead of introducing new dependencies between different parts of ash.",
      "parentUuid": "921aa228_1464570e",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "03eb6f25_faa217b2",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000232
      },
      "writtenOn": "2017-11-13T19:17:28Z",
      "side": 1,
      "message": "I tried doing that (i.e. showing a black window immediately when the stylus is removed), and it didn\u0027t fix the issue with the lock screen UI flashing for a moment.",
      "parentUuid": "b1b9b0a9_09a12262",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce262ff7_71274a9b",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-11-13T22:58:21Z",
      "side": 1,
      "message": "if the main need here is to synchronize with the lock screen UI, is there any way that you could hook in with that code? jdufault@ might have ideas about the best way to do that.",
      "parentUuid": "03eb6f25_faa217b2",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a73471bc_0a97f9ec",
        "filename": "ash/system/power/power_button_display_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 148,
      "author": {
        "id": 1000232
      },
      "writtenOn": "2017-11-15T00:12:53Z",
      "side": 1,
      "message": "It\u0027s not really about synchronizing with the lock screen UI - it\u0027s related to lock screen in sense that it is the lock screen that is shown bellow the app window.\nThe problem is that there is a race between a window shown when stylus is ejected being painted and display turned on (at least on kevin).\nEven when I changed lock screen UI to show a full screen black layout on stylus removal, I was seeing this issue - i.e. original lock screen UI flashing before the black layer is shown over the UI.\n\nThe current approach I\u0027m looking into should minimize dependency between lock screen note and power button code - separating code for requesting display to be forced off  out of power_button_display_controller (display_forced_off_setter), and then have both lock screen note code and power_button_display_controller use this common class to request display to be forced off.\nWDYT about something like that? If this seems acceptable, I\u0027ll probably separate that part into another cl (to reduce the size here).",
      "parentUuid": "ce262ff7_71274a9b",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97b516bc_91ad8bb6",
        "filename": "ash/system/power/tablet_power_button_controller_test_api.h",
        "patchSetId": 5
      },
      "lineNbr": 36,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2017-11-10T00:27:46Z",
      "side": 1,
      "message": "why is this part of TabletPowerButtonController\u0027s test api? it doesn\u0027t seem to have much to do with that class.\n\nnote also that we don\u0027t use TabletPowerButtonController on eve.",
      "revId": "42a9100e2fa3d0be5ad67c2eeb36c9d89859448c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}