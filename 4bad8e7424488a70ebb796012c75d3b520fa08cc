{
  "comments": [
    {
      "key": {
        "uuid": "7f11900b_0d39d36e",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-12-08T18:55:48Z",
      "side": 1,
      "message": "AFAIK, Offline pages have https:// virtual URL and chrome:// URLs, so I believe this CL actually changes the counting.\n\nIs there another way to filter out session restoring web states?",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9136eca3_04adbd81",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-12-08T19:23:56Z",
      "side": 1,
      "message": "How about if either URL of virtual URL is chrome://?\n\nThe other option I tried (but shot down) was to detect if this is a file:///...restore_session.html. It doesn\u0027t work because whether to count or not depends on which page is being restored.",
      "parentUuid": "7f11900b_0d39d36e",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab56e533_a5c40950",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1116027
      },
      "writtenOn": "2017-12-11T14:54:42Z",
      "side": 1,
      "message": "I don\u0027t think offline pages should be ignored. If user is online, even opening an offline page will cause a reload (at least it looks like there is a reload). The test is mostly there for chrome://newtab.",
      "parentUuid": "9136eca3_04adbd81",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33988a22_b4aa764f",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-12-11T17:23:30Z",
      "side": 1,
      "message": "If I understand Sylvain\u0027s other comment correctly, I think this metric is trying to measure how \"far\" a user can go (in terms of number of page loads) before switching to an evicted tab. Higher is better because the cost of reviving of evicted tab is incurred less frequently.\n\nAssuming this, I agree with Sylvain that it seems more correct to count offline page as a page load because it appears to the user like one. Eugene, would you agree that this is the correct end state?\n\nSeparately there\u0027s the question of how to roll out this change. Is anyone looking at this UMA metric regularly that we need to notify of the expected change? I\u0027m not sure how noticeable the change will be. For example, the bug was shipped in M61. There is only a mild decrease in the metric in 95th percentile compared to M60, and it\u0027s hard to tell if it\u0027s due to the bug or part of the larger decreasing trend that seemed to have started around M56. I wonder if the impact on UMA metric for fixing this bug would be like a tree falling in a forest no one knows about... in which case, I think we should probably just ship the fix.",
      "parentUuid": "ab56e533_a5c40950",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d5ed3a0d_677df2ff",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-12-11T18:09:15Z",
      "side": 1,
      "message": "I agree that it would be better not to ignore offline pages. But current code does ignore them. The important property of any metric is to be able to compare the results across the releases. \n\nFrom my understanding the purpose of this CL is to fix the DCHECK, not to make this metric correct. I agree with Sylvain in abstract (offline pages should not be ignored), but in this specific CL we should not change the metric behavior.",
      "parentUuid": "33988a22_b4aa764f",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2ba11d2f_a94586d5",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-12-11T18:09:15Z",
      "side": 1,
      "message": "\u003e How about if either URL of virtual URL is chrome://?\nSorry, forgot to send the reply, which was \"SGTM\"",
      "parentUuid": "9136eca3_04adbd81",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "179e0988_c43d9320",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-12-11T20:11:43Z",
      "side": 1,
      "message": "I\u0027m concerned that strictly following metrics preserving process here is creating more work for little gain. If we were to preserve the behavior, I\u0027ll add the \"either URL or virtual URL\" comparison, file a bug, and add a TODO to correct this metric. Then for someone to fix the bug, they need to add another metric so we can track both old and new behaviors, wait a release, and cut over to new metric. I suspect that work will not be prioritized and we\u0027ll end up with just a little bit more code and an extra bug.\n\nGiven that the CL that introduced the bug didn\u0027t trip up any metric monitoring from release to release, I question how important it really was to be able to compare this metric from release to release.\n\nThat said, I\u0027m not a Bling owner, so I\u0027ll acquiesce if you feel strongly about this.",
      "parentUuid": "d5ed3a0d_677df2ff",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cb9a63f8_0ce33c0a",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder.mm",
        "patchSetId": 2
      },
      "lineNbr": 373,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-12-11T21:49:59Z",
      "side": 1,
      "message": "I think this metric is used for SadTab CMP. Peter, are you OK to have a change in Sad Tab CMP count in the next release?",
      "parentUuid": "179e0988_c43d9320",
      "range": {
        "startLine": 373,
        "startChar": 25,
        "endLine": 373,
        "endChar": 38
      },
      "revId": "4bad8e7424488a70ebb796012c75d3b520fa08cc",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}