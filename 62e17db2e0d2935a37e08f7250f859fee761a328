{
  "comments": [
    {
      "key": {
        "uuid": "891994dd_60451859",
        "filename": "third_party/WebKit/Source/core/editing/VisiblePosition.cpp",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1002258
      },
      "writtenOn": "2017-08-31T01:30:59Z",
      "side": 1,
      "message": "Could you implement PositionTemplate::IsValidFor() and\nPwA::IsValidFor(doc) { return position_.IsValidFor(doc); }\nVP::IsValidFor(doc) { return position_with_affinity.IsValidFor(doc); }\n\nWe may want to change VS::IsValidFor() and SelectionTemplate::IsValidFor(),\nto utilize Pos::IsValidFor(), but it is another story.\n\nBTW, VP depends on DOM tree and style, so we should check dom_tree_version\nand style_version. ctro and getter should check both dom_tree_version and\nstyle_version, but we have too many use sites not to allow checking now.\n\nWe may wan to introduce StrictVisiblePosition or utilize\nDocumentLifecycle::DisallowTransitionScope somehow. I have no clear idea\nyet.",
      "revId": "62e17db2e0d2935a37e08f7250f859fee761a328",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3a2dd70_ad6e8e47",
        "filename": "third_party/WebKit/Source/core/editing/VisiblePosition.cpp",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1229332
      },
      "writtenOn": "2017-08-31T18:41:17Z",
      "side": 1,
      "message": "Wait, dom_tree_version_ and style_version_ only exist when DCHECK is enabled, right? Do we only need to check these in DCHECK-enabled builds? Or do we want to expose them in all builds?",
      "parentUuid": "891994dd_60451859",
      "revId": "62e17db2e0d2935a37e08f7250f859fee761a328",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e39ea931_cbb07f9f",
        "filename": "third_party/WebKit/Source/core/editing/VisiblePosition.cpp",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1002258
      },
      "writtenOn": "2017-09-01T02:02:24Z",
      "side": 1,
      "message": "Usage of VP::IsValid() is very limited. We can\u0027t use it everywhere at this\ntime. In the future, we should use it like EphemeralRange and\nSelectionInTempalte. But, now is not at time to do so.\n\nVP::IsValidFor(doc) and VS::IsValidFor(doc) are short term solution.\nIn the perfect world, we don\u0027t need to have them, since our code\nwill not allow to use VP and VS once DOM tree/style changed.\n\nAnyway, please make VP::IsValidFor(doc) to call PwA::IsValidFor(doc) to\ncall Pos::IsValidFor(doc).\n\nPosInFlatTree::IsValidFor(doc) should traverse ancestros until document\nor null instead of PosInDOMTree::IsValidFor(doc) uses IsConnected().\n\nWe\u0027ll replace PosIn{Flat,DOM}Tree::IsConnected/IsOrphan() to\nIsValidFor(doc). Because Pos::IsConnected() isn\u0027t detect whether\nPosition is moved to another document or not.\n\n[1] http://crbug.com/761173 PositionTemplate::IsConnected/IsOrphan don\u0027t\nwork for flat tree",
      "parentUuid": "d3a2dd70_ad6e8e47",
      "revId": "62e17db2e0d2935a37e08f7250f859fee761a328",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90c4d0b8_87b09132",
        "filename": "third_party/WebKit/Source/core/editing/VisiblePosition.cpp",
        "patchSetId": 1
      },
      "lineNbr": 190,
      "author": {
        "id": 1229332
      },
      "writtenOn": "2017-09-01T03:06:22Z",
      "side": 1,
      "message": "\u003e Anyway, please make VP::IsValidFor(doc) to call PwA::IsValidFor(doc) to\ncall Pos::IsValidFor(doc).\n\nI think I did this already in the latest version of the CL. I\u0027m also checking dom_tree_version_ and style_version_, but I don\u0027t think that\u0027s right, since these fields only exist in DCHECK-enabled builds.\n\n\u003e PosInFlatTree::IsValidFor(doc) should traverse ancestros until document\nor null instead of PosInDOMTree::IsValidFor(doc) uses IsConnected().\n\nThis I still need to do.",
      "parentUuid": "e39ea931_cbb07f9f",
      "revId": "62e17db2e0d2935a37e08f7250f859fee761a328",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}