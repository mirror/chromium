{
  "comments": [
    {
      "key": {
        "uuid": "72c85c37_a537b61e",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-08T02:10:18Z",
      "side": 1,
      "message": "mouse_handler_ \u003d std::make_unique\u003cWebContentMouseHandler\u003e(this, web_contents);",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6bf2b6d5_fb97104e",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 1003016
      },
      "writtenOn": "2017-12-08T18:15:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "72c85c37_a537b61e",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "98f3b9da_b27b8e72",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-08T02:10:18Z",
      "side": 1,
      "message": "note WebContentsMouseHandler has some lifetime issues - https://bugs.chromium.org/p/chromium/issues/detail?id\u003d739245\n\nI think that will be fixed in m65.",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bed303bf_ea0158cb",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1003016
      },
      "writtenOn": "2017-12-08T18:15:30Z",
      "side": 1,
      "message": "The issue in this bug is that the web_contents can go away and |mouse_handler_| still gets events? Since SaveCardBubbleControllerImpl is a WebContentsObserver for WasHidden/WasDestroyed and will call into this method to reset |mouse_handler_|, I think we should be covered?",
      "parentUuid": "98f3b9da_b27b8e72",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5c4f614_36c41da9",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 73,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-11T11:39:13Z",
      "side": 1,
      "message": "yeah - that should cover it (except for the case of SaveCardBubbleControllerImpl accidentally not calling Hide()). I still want WebContentsMouseHandler to control it\u0027s lifetime better, but you can leave that with me.",
      "parentUuid": "bed303bf_ea0158cb",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f8e2bb02_721a6af3",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-08T02:10:18Z",
      "side": 1,
      "message": "There\u0027s also a fun lifetime issue specifically for SaveCardBubbleViews, related to controller_ being set null here\n\n https://bugs.chromium.org/p/chromium/issues/detail?id\u003d624560\n\nI think you are now exposing the dialog to the same lifetime issue on |mouse_handler_|. Specifically, the SaveCardBubbleControllerImpl destructor only calls Hide() when it still has a non-null |save_card_bubble_view_|, but the view can actually still exist and receive events at that point.",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a3545121_31814f54",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 1003016
      },
      "writtenOn": "2017-12-08T18:15:30Z",
      "side": 1,
      "message": "I\u0027d forgotten about this, good catch. I\u0027m clearing the controller_ and mouse_handler_ in WindowClosing as well, and there doesn\u0027t appear to be a case anymore where one side would retain a pointer inappropriately. Do you think this improves the situation?",
      "parentUuid": "f8e2bb02_721a6af3",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6bf95f88_096f4c13",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-11T11:39:13Z",
      "side": 1,
      "message": "Yeah - that\u0027s the theory. I\u0027m not sure what a regression test for it would look like though. You might get a nag on issue 624560, but IMO think the crash rate is too low to put much effort into fixing (one crash in m58, one crash in m62).",
      "parentUuid": "a3545121_31814f54",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5544877e_f48a4893",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-08T02:10:18Z",
      "side": 1,
      "message": "mouse_handler_ \u003d nullptr",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b6f02b9_75099b58",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.cc",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 1003016
      },
      "writtenOn": "2017-12-08T18:15:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5544877e_f48a4893",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5358ead9_02cc27fb",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.h",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 1002092
      },
      "writtenOn": "2017-12-08T02:10:18Z",
      "side": 1,
      "message": "This will also cause the bubble to close on some key events, per\n\nvoid LocationBarBubbleDelegateView::WebContentMouseHandler::OnKeyEvent(\n    ui::KeyEvent* event) {\n  if ((event-\u003ekey_code() \u003d\u003d ui::VKEY_ESCAPE ||\n       web_contents_-\u003eIsFocusedElementEditable()) \u0026\u0026\n      event-\u003etype() \u003d\u003d ui::ET_KEY_PRESSED)\n    bubble_-\u003eCloseBubble();\n}\n\ndo you want that as well?",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8a7694f_920c6840",
        "filename": "chrome/browser/ui/views/autofill/save_card_bubble_views.h",
        "patchSetId": 1
      },
      "lineNbr": 111,
      "author": {
        "id": 1003016
      },
      "writtenOn": "2017-12-08T18:15:30Z",
      "side": 1,
      "message": "Yes, that\u0027s nice.",
      "parentUuid": "5358ead9_02cc27fb",
      "revId": "412abcb6bf81ab588b90a94b4018797aacb06fcd",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}