{
  "comments": [
    {
      "key": {
        "uuid": "1fae2a08_46272988",
        "filename": "google_apis/gaia/gaia_auth_consumer.cc",
        "patchSetId": 11
      },
      "lineNbr": 52,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-23T10:43:31Z",
      "side": 1,
      "message": "Should this be \"\u003d default\"?",
      "range": {
        "startLine": 52,
        "startChar": 38,
        "endLine": 52,
        "endChar": 55
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1382356_39a536aa",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Is this an expected case. If not, then we should at least log this using VLOG(1).",
      "range": {
        "startLine": 22,
        "startChar": 34,
        "endLine": 22,
        "endChar": 47
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8ff4fee_4f403a97",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "I left this logging out because the root cause will have logged it either in DecodeIdToken or in GetServiceFlags. However, I can add it here for safety as well, in case we forget to log the root cause.",
      "parentUuid": "f1382356_39a536aa",
      "range": {
        "startLine": 22,
        "startChar": 34,
        "endLine": 22,
        "endChar": 47
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "edd2d737_b3a5455d",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 31,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Should this return a std::unique_ptr\u003cbase::Value\u003e. It could return nullptr in case of error.",
      "range": {
        "startLine": 31,
        "startChar": 27,
        "endLine": 31,
        "endChar": 40
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "83d56425_42a3fd23",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 31,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "edd2d737_b3a5455d",
      "range": {
        "startLine": 31,
        "startChar": 27,
        "endLine": 31,
        "endChar": 40
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6efebd9a_51e88700",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 33,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "s/decoded_payload/out_decoded_payload",
      "range": {
        "startLine": 33,
        "startChar": 34,
        "endLine": 33,
        "endChar": 49
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7994e05d_945d3f25",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 33,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "I\u0027ve changed to return it instead.",
      "parentUuid": "6efebd9a_51e88700",
      "range": {
        "startLine": 33,
        "startChar": 34,
        "endLine": 33,
        "endChar": 49
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c2efe005_1f9242da",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 38,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Let\u0027s use VLOG() as we have it in production if we ever need to debug this on a client (e.g. if GAIA eng are making changes and need to test this).",
      "range": {
        "startLine": 38,
        "startChar": 9,
        "endLine": 38,
        "endChar": 16
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "abf152b2_64e4add0",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 38,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c2efe005_1f9242da",
      "range": {
        "startLine": 38,
        "startChar": 9,
        "endLine": 38,
        "endChar": 16
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1fede533_e286f06b",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 47,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Ditto about log.",
      "range": {
        "startLine": 47,
        "startChar": 9,
        "endLine": 47,
        "endChar": 16
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7a705656_66ff503e",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 47,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1fede533_e286f06b",
      "range": {
        "startLine": 47,
        "startChar": 9,
        "endLine": 47,
        "endChar": 16
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2bc805fd_942a34f1",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 53,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Ditto about log.",
      "range": {
        "startLine": 53,
        "startChar": 40,
        "endLine": 53,
        "endChar": 47
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "830bb637_b6f0b4fc",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 53,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2bc805fd_942a34f1",
      "range": {
        "startLine": 53,
        "startChar": 40,
        "endLine": 53,
        "endChar": 47
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab5bf463_14db4898",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "Optional: DCHECK(service_flags.empty());",
      "range": {
        "startLine": 62,
        "startChar": 45,
        "endLine": 62,
        "endChar": 46
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2bfe2529_c4dd32c4",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "s/service_flags/out_service_flags",
      "range": {
        "startLine": 62,
        "startChar": 30,
        "endLine": 62,
        "endChar": 43
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d5cd0552_4fae0f75",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2bfe2529_c4dd32c4",
      "range": {
        "startLine": 62,
        "startChar": 30,
        "endLine": 62,
        "endChar": 43
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "394fcf7e_0fc69216",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.cc",
        "patchSetId": 11
      },
      "lineNbr": 62,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ab5bf463_14db4898",
      "range": {
        "startLine": 62,
        "startChar": 45,
        "endLine": 62,
        "endChar": 46
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dfb45b86_00c375ff",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 19,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "It looks like this class is not a real class, just a collection of static methods. I think we should do the following:\n1. Add a namespace gaia to this file (this lives in /google_apis/gaia/, so it should have namespace gaia - this was not done initially, but I think that is bad).\n\nOption 1:\n2. Remove the class and just keep one method IsChildAccountFromIdToken(const std::string\u0026 id_token). Maybe my proposed name is not the best (let me know if you have a better one).\n3. Move all internal static methods and constants in an anonymous namespace in the implementation file.\n\nOption 2:\n2. Keep the OAuth2IdTokenDecoder, make the constructor and destructor private.\n3. Make methods DecodeIdToken and GetServiceFlags non-static.\n4. Instantiate a Decoder in IsChildAccount and use it to decode the token.\n\nOption 2 is more extendable in the future if we want to use more than the big IsChildAccount. Option 1 is probably easier to implement now.",
      "range": {
        "startLine": 19,
        "startChar": 2,
        "endLine": 19,
        "endChar": 22
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c766a236_28f6862a",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 19,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Thank you for explaining these options in detail.\n\nI\u0027ve implemented Option 1. I think it\u0027s cleaner for our current purposes, and we can migrate to Option 2 if it becomes necessary.\n\nDo you think the filename is still appropriate?",
      "parentUuid": "dfb45b86_00c375ff",
      "range": {
        "startLine": 19,
        "startChar": 2,
        "endLine": 19,
        "endChar": 22
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f2a79368_3f7bdf62",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 19,
      "author": {
        "id": 1003168
      },
      "writtenOn": "2017-11-22T21:56:28Z",
      "side": 1,
      "message": "Mihai Sardarescu\n\u003e It looks like this class is not a real class, just a collection of static methods.\n\n\nI above suggested just adding a function to anonymous namespace in gaia_auth_fetcher.cc , so we would not need this file at all. We could include decoded id_token to GaiaAuthConsumer::ClientOAuthResult , so that consumers will receive full data and can later fetch any information from it they want.\n\nI still believe this is simpler, shorter and more flexible solution. It will supply consumers of GaiaAuthFetcher() with fully decoded response data.\n\nMihai, WDYT?",
      "parentUuid": "c766a236_28f6862a",
      "range": {
        "startLine": 19,
        "startChar": 2,
        "endLine": 19,
        "endChar": 22
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa8dbbde_fdde5a75",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 19,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-23T10:43:31Z",
      "side": 1,
      "message": "I partially agree with Alexander:\n* It could make sense to have the GaiaAuthFetcher always decode the response data (but in that case, I\u0027d say we should extract from that data all information that Chrome needs from the id_token string and just expose a bool is_child_account in the ClientOAuthResult (in the future it may add more information extracted from the service flags). I think the main advantage would be that we do not need to parse the same information multiple times if we need to decode more stuff from the service flags.\n* Personally, I like the fact that the decoder is a separate file for 2 reasons: a) it makes the file of the fetcher shorter by separating decoding, b) it allows an easier way to add unit tests for the decoder.",
      "parentUuid": "f2a79368_3f7bdf62",
      "range": {
        "startLine": 19,
        "startChar": 2,
        "endLine": 19,
        "endChar": 22
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "45ecd091_9b07c497",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "This should be a reference:\nconst std::string\u0026 id_token",
      "range": {
        "startLine": 22,
        "startChar": 29,
        "endLine": 22,
        "endChar": 46
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c36fed5_6911963c",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "This function requires a comment.",
      "range": {
        "startLine": 22,
        "startChar": 14,
        "endLine": 22,
        "endChar": 28
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edab72b8_7118ca1a",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "45ecd091_9b07c497",
      "range": {
        "startLine": 22,
        "startChar": 29,
        "endLine": 22,
        "endChar": 46
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1481a8f6_c9b99905",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 22,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8c36fed5_6911963c",
      "range": {
        "startLine": 22,
        "startChar": 14,
        "endLine": 22,
        "endChar": 28
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "594e8b8d_de705e5c",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 25,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-22T10:48:32Z",
      "side": 1,
      "message": "These constants are not needed in the header file - move the to the .cc file.",
      "range": {
        "startLine": 25,
        "startChar": 20,
        "endLine": 25,
        "endChar": 44
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b411f953_cbe798ef",
        "filename": "google_apis/gaia/oauth2_id_token_decoder.h",
        "patchSetId": 11
      },
      "lineNbr": 25,
      "author": {
        "id": 1246429
      },
      "writtenOn": "2017-11-22T16:31:04Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "594e8b8d_de705e5c",
      "range": {
        "startLine": 25,
        "startChar": 20,
        "endLine": 25,
        "endChar": 44
      },
      "revId": "d3d25ba12ab6154b6aab3bf244d1e17803462dbf",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}