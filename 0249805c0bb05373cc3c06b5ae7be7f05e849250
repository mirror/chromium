{
  "comments": [
    {
      "key": {
        "uuid": "f6a3177a_f998f7ed",
        "filename": "chrome/browser/io_thread.h",
        "patchSetId": 13
      },
      "lineNbr": 165,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Matt: I\u0027d like your thoughts on this - and if you have a better suggestion. Offering static methods for testing makes me sad, as it usually highlights an opportunity to improve our hermeticism or testing - but I can also understand that we don\u0027t really have any way to plum the dependencies down.\n\nIn the context of a Servicified world, this seems untenable, so if there are iterative suggestions to be made now to improve it, that\u0027d be great. Alternatively, if you\u0027re comfortable with that being part of the Servification effort, rather than this, I can live with that.\n\n(Note: This is similar to the ProfileIOData method we have already, so further if there\u0027s a way you can see to combine these so we only have one method, that also seems desirable)",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7ef7d69f_e3e91a70",
        "filename": "chrome/browser/io_thread.h",
        "patchSetId": 13
      },
      "lineNbr": 165,
      "author": {
        "id": 1115968
      },
      "writtenOn": "2018-01-26T19:16:14Z",
      "side": 1,
      "message": "Post-servicification, things are likely to work in a similar fashion, sadly, unless someone dedicates time to figuring out a better way to do this - there\u0027s already a way to mock out URLLoaderFactories (The URLRequest constructor) on profile URLRequestContexts.\n\nSeems like the only better way to do things (in a full integration test) would be to make things replaceable at runtime, or have a standard way to override creation of portions of the network stack that work along the same fundamental lines as this method currently does (We could, for instance, pall a callback the URLRequestContextBuilder, or the URLRequestContext before first use, and have it manipulate it to its hearts content.  In a post-servicification world, we\u0027d be passing the NetworkContextParams instead, I guess, which isn\u0027t quite as powerful).\n\nOne option for just sharing code in this particular case (for the current code) would be to inject a CertVerifierFactory instead, and make both the IOThread and ProfileIOData use it (Possibly with a parameter identifying what they\u0027re creating it for), but not sure that gets us a whole lot.",
      "parentUuid": "f6a3177a_f998f7ed",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c3505555_5eb4b1f7",
        "filename": "chrome/browser/io_thread.h",
        "patchSetId": 13
      },
      "lineNbr": 165,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T19:34:33Z",
      "side": 1,
      "message": "Matt: That actually sounds like a really great idea! It also seems to fit with how I was thinking we might servificy some of this CT effort, which I\u0027ve been trying to dedicate background mental cycles to. If you decide to explore this route in the future as part of S13N, I\u0027d love to be a part of it - and if we (//net OWNERs) don\u0027t get to it before the April CT launch, I\u0027d love to revisit it and possibly drive that once I have more time. Naively, I think it\u0027d make a lot of my qualms about some of the testability of various cert-and-IO-thingies go away, which is why I\u0027m uncomfortably excited about the prospect - even with the NetworkContextParams limitations :)",
      "parentUuid": "7ef7d69f_e3e91a70",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "134a7fae_0c3d7c51",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 44,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Document",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c383cc85_50b66351",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 44,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "134a7fae_0c3d7c51",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "698c0d73_a6f21ea3",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 57,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Document",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5552b906_485c146f",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 57,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "698c0d73_a6f21ea3",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d570b717_0a503c4e",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Document",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "335f056e_856ee6ad",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 87,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d570b717_0a503c4e",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2101bf42_3e188833",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 106,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "I\u0027m having trouble parsing the \u0027initiated by a profile request context\u0027, since it seems like in 119-123, you support the browser process as well",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "73900b21_b8a9f2fe",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 106,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "Ah I used to have 2 separate test fixtures, but merged them without updating this comment. Fixed.",
      "parentUuid": "2101bf42_3e188833",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "19e402cf_ec177132",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 145,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "From a testing standpoint, this seems to introduce a dependency on the set of trusted logs we have, and a dependency on a Real Cert. Is there a way we can reduce those dependencies to fully hermetic copies?\n\nIf something goes wrong with these tests, or we want to build on them, I would have no idea on how to do that - hence the concern :)",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3c52a46b_63e8121e",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 145,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "I had a look and it didn\u0027t appear to be trivial to override the log list, which is what is needed. That\u0027s why I opted to add a TODO (below) and I can put together a separate change to enable overriding the log list. The dependency on a Real Cert shouldn\u0027t be a problem, as it can\u0027t expire from the point of view of the test (cert verification is hard-coded to succeed).",
      "parentUuid": "19e402cf_ec177132",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d650e3e7_c8092b98",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 163,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Why is https://cs.chromium.org/chromium/src/content/public/test/browser_test_base.h?rcl\u003dc50b0d294e3252bf88e2780a2c4143e5442bbcf1\u0026l\u003d51 insufficient for this use case?",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8d91f4d_c2a3a090",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 163,
      "author": {
        "id": 1115968
      },
      "writtenOn": "2018-01-26T19:16:14Z",
      "side": 1,
      "message": "I\u0027m not sure.  It looks to me like we\u0027re just overriding the HostResolverProc (i.e., GetAddrInfo), so I\u0027d think the hard-coded checks for localhost would be hit (They aren\u0027t for MockHostResolver, but that has a default rule to make everything to 127.0.0.1).",
      "parentUuid": "d650e3e7_c8092b98",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e81c12d2_347f44e0",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 163,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "The hard-coded checks for localhost are exactly the problem this bypasses. I can\u0027t use the RuleBasedHostResolverProc because it doesn\u0027t get called for lookups of \"localhost\". Instead, I need to go directly to the HostCache and add an entry so that it appears as though a DNS lookup has been performed for \"localhost\".",
      "parentUuid": "d8d91f4d_c2a3a090",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b4ac612c_a72dbe78",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 198,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T18:52:03Z",
      "side": 1,
      "message": "Matt: Could you review this for the Right Way?",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "24bd5203_a42e5915",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 198,
      "author": {
        "id": 1000193
      },
      "writtenOn": "2018-01-26T19:18:07Z",
      "side": 1,
      "message": "Matt: I wasn\u0027t sure if you were still commenting, but you may have missed this question :)",
      "parentUuid": "b4ac612c_a72dbe78",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8e85f3d5_5ab9c1d1",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 198,
      "author": {
        "id": 1115968
      },
      "writtenOn": "2018-01-26T19:22:52Z",
      "side": 1,
      "message": "Thanks!  Missed this.  This is the right way, and will continue to work post-servicification (Assuming cert verified injection is updated to work with the network service, of course).\n\nShould probably check that the returned value is net::OK, though.",
      "parentUuid": "24bd5203_a42e5915",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a1952cc5_cab7670d",
        "filename": "chrome/browser/ssl/certificate_transparency_browsertest.cc",
        "patchSetId": 13
      },
      "lineNbr": 198,
      "author": {
        "id": 1130929
      },
      "writtenOn": "2018-02-05T14:12:07Z",
      "side": 1,
      "message": "I was intentionally not doing that, because the request results in a 404 and so doesn\u0027t return net::OK. If I change the test to register some URL handlers and use one of those, Chrome ends up making at least one extra request as a side-effect which makes the histogram assertions messier.",
      "parentUuid": "8e85f3d5_5ab9c1d1",
      "revId": "0249805c0bb05373cc3c06b5ae7be7f05e849250",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}