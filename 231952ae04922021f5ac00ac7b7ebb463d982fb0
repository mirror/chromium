{
  "comments": [
    {
      "key": {
        "uuid": "fc384c7a_d02fd880",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 135,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-09-19T04:57:01Z",
      "side": 1,
      "message": "probably deserves a comment",
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f10c416a_47552399",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 135,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Done\n\nAs addressed with Changwan\u0027s comment, the new name is self-explained.",
      "parentUuid": "fc384c7a_d02fd880",
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1269fb22_f69d4fcb",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 153,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T18:21:25Z",
      "side": 1,
      "message": "Unless there is a context switch, could you keep the same variable name instead of flipping it into another?\nafter_adjust is somewhat weird grammatically because its after + verb.\nHow about renaming it to from_selection_adjustment and pass it all the way to the Java code?",
      "range": {
        "startLine": 153,
        "startChar": 32,
        "endLine": 153,
        "endChar": 44
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d211e8e0_fd58af73",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 5
      },
      "lineNbr": 153,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1269fb22_f69d4fcb",
      "range": {
        "startLine": 153,
        "startChar": 32,
        "endLine": 153,
        "endChar": 44
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f9df56c4_0ff03534",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1150,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T18:21:25Z",
      "side": 1,
      "message": "We should also check that selection offsets remain the same as when classification started. Otherwise, we shouldn\u0027t trigger selection adjustment.",
      "range": {
        "startLine": 1150,
        "startChar": 17,
        "endLine": 1150,
        "endChar": 31
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa873313_67629b6d",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1150,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "I think the concern you had here is for the situation that selection range is changed during classification, so the |result| here is obsoleted. We have to preserve the original selection inside of SmartSelectionClient I think, so it could be done in a later CL.\n\nWe also need a test to ensure the behavior.",
      "parentUuid": "f9df56c4_0ff03534",
      "range": {
        "startLine": 1150,
        "startChar": 17,
        "endLine": 1150,
        "endChar": 31
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e72472d6_4b3949a4",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1151,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T18:21:25Z",
      "side": 1,
      "message": "remove? The assertion here doesn\u0027t make much sense.",
      "range": {
        "startLine": 1151,
        "startChar": 16,
        "endLine": 1151,
        "endChar": 32
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "19b84ff2_81304ded",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1151,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e72472d6_4b3949a4",
      "range": {
        "startLine": 1151,
        "startChar": 16,
        "endLine": 1151,
        "endChar": 32
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cf9e5d2f_c37f2a7b",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1152,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T18:21:25Z",
      "side": 1,
      "message": "How about setting mClassificationResult as null here?\n\nuser updates selection -\u003e onClassified() -\u003e adjust sent -\u003e user updates selection -\u003e onClassified()\n-\u003e adjust updates selection -\u003e adjust updates selection\n\nThis is a valid path but the second onClassified() causes assertion failure?\n\nIt seems that this type of interactions are very difficult to reason about.\nCould you add robolectric tests for this class?\nRobolectric test is currently the only way to mock out dependencies. Here is an example:\nhttps://cs.chromium.org/chromium/src/content/public/android/junit/src/org/chromium/content/browser/input/ThreadedInputConnectionTest.java?q\u003dthreadedinputconnectiontest\u0026sq\u003dpackage:chromium\u0026l\u003d1",
      "range": {
        "startLine": 1152,
        "startChar": 16,
        "endLine": 1152,
        "endChar": 22
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1eed0dfe_96ee8c0f",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1152,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Done\n\nI had an idea to address this by introduce a boolean flag |mDuringSelectionAdjustment|, then use it to ignore showSelectionMenu() calls in between. but as you suggested, we need test to ensure/validate the behavior. I am actually not sure about how to trigger such case. Will do testing in a separate CL.",
      "parentUuid": "cf9e5d2f_c37f2a7b",
      "range": {
        "startLine": 1152,
        "startChar": 16,
        "endLine": 1152,
        "endChar": 22
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e83118f6_b07fdf0a",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1152,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T21:16:54Z",
      "side": 1,
      "message": "Could you clarify why you want to do testing in a separate CL? Normally, tests help understand behavior of production code and prevent bugs, so it is an unusual practice to split testing from the production code change. If you believe that adding first few tests would change code in a distracting way, could you try to land those tests first and then fix/add test in this CL?",
      "parentUuid": "1eed0dfe_96ee8c0f",
      "range": {
        "startLine": 1152,
        "startChar": 16,
        "endLine": 1152,
        "endChar": 22
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f89bf5c2_f0853afd",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 5
      },
      "lineNbr": 1152,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T22:25:11Z",
      "side": 1,
      "message": "I was thinking although this CL changes not too many lines but touches quite amount of files, so adding more code here introducing more complexity. But as you pointed out, test helps people understand CL, so it actually goes to the other direction. I can write test to cover production code in this CL as a start of a broader testing plan.",
      "parentUuid": "e83118f6_b07fdf0a",
      "range": {
        "startLine": 1152,
        "startChar": 16,
        "endLine": 1152,
        "endChar": 22
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "66b8d820_00e18da2",
        "filename": "content/public/android/java/src/org/chromium/content/browser/webcontents/WebContentsImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 372,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-09-19T18:21:25Z",
      "side": 1,
      "message": "If contextual search is the only other caller, why don\u0027t we merge the call path and have CS pass \u0027false\u0027 as parameter?",
      "range": {
        "startLine": 372,
        "startChar": 16,
        "endLine": 372,
        "endChar": 48
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1e83eb25_790d33f7",
        "filename": "content/public/android/java/src/org/chromium/content/browser/webcontents/WebContentsImpl.java",
        "patchSetId": 5
      },
      "lineNbr": 372,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Just came up with the same idea while addressing Bo\u0027s comment. The original idea was to avoid to change contextual search. But clearly that was not a good idea.\n\nDone",
      "parentUuid": "66b8d820_00e18da2",
      "range": {
        "startLine": 372,
        "startChar": 16,
        "endLine": 372,
        "endChar": 48
      },
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c0392b7d_2ebb8415",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/WebContents.java",
        "patchSetId": 5
      },
      "lineNbr": 253,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-09-19T04:57:01Z",
      "side": 1,
      "message": "don\u0027t add to public interface (ie content_public for java) unless there\u0027s an embedder calling the method\n\ninside content, it\u0027s fine to cast to impl type instead",
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1abbc793_1fe92396",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/WebContents.java",
        "patchSetId": 5
      },
      "lineNbr": 253,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-09-19T20:39:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c0392b7d_2ebb8415",
      "revId": "231952ae04922021f5ac00ac7b7ebb463d982fb0",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}