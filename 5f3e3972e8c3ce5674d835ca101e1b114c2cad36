{
  "comments": [
    {
      "key": {
        "uuid": "83b36c25_23c63437",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 235,
      "author": {
        "id": 1003330
      },
      "writtenOn": "2017-11-13T23:18:07Z",
      "side": 1,
      "message": "QQ: I assume the tightness for visual rects means every pixel inside the rect are guaranteed to be fully opaque?",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cba278b8_e8035add",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 235,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2017-11-14T00:03:59Z",
      "side": 1,
      "message": "Yes if we assume the source rect is opaque.",
      "parentUuid": "83b36c25_23c63437",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f4d1a50_14130a14",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 249,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2017-11-11T01:49:20Z",
      "side": 1,
      "message": "This ensures the clip rect covers all clipped contents. That is, applying the clip in ancestor state won\u0027t clip out anything that should not be clip out.\n\nBecause of this new path, I have to change the return type from \"const FloatClipRect\u0026\" to \"FloatClipRect\". I\u0027m not sure how this will affect performance, but in GeometryMapper::LocalToAncestorClipRectInternal() we actually avoid one cache lookup (old line 310).",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b4b1fc6_a650c71b",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 249,
      "author": {
        "id": 1003330
      },
      "writtenOn": "2017-11-13T23:18:07Z",
      "side": 1,
      "message": "I\u0027m really unsure what should be the semantics of the function when there is any pixel-moving effects, and I think any caller not explicitly handling that is doing it wrong.\n\nCan we make it a DCHECK that none of the intermediate effect moves pixel, then do the fast path only? If not, what will break?",
      "parentUuid": "2f4d1a50_14130a14",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1332446_e5f29b95",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 249,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2017-11-14T00:03:59Z",
      "side": 1,
      "message": "I think the semantics of the function should be \"applying the clip in ancestor state won\u0027t clip out anything that should not be clip out\" (which need to be more precise though). For the case of pixel-moving filters, the semantics is similar to the case when there are transforms: the result clip rect is a bounding box of transformed clip rect when a transform is applied.\n\nIt looks like a burden for the caller to check for pixel-moving effects before calling this method, like in https://chromium-review.googlesource.com/c/chromium/src/+/753540.\n\nActually the method is named slow, but it\u0027s not very slow in normal cases. It\u0027s just slower than the fast LocalToAncestorClipRectInternal() by times of number of effect nodes from local_state to ancestor_state (not included).\n\nIt seems that not only pixel-moving effects make a clip rect not tight. A clip-path doesn\u0027t move pixel but it also makes the clip rect which is the bounding rect of the clip-path not tight.",
      "parentUuid": "3b4b1fc6_a650c71b",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "824310a2_9fd2a1cc",
        "filename": "third_party/WebKit/Source/platform/graphics/paint/GeometryMapper.cpp",
        "patchSetId": 11
      },
      "lineNbr": 249,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2017-11-15T03:57:23Z",
      "side": 1,
      "message": "Actually this function now has the same semantics as cc clip mapping (https://cs.chromium.org/chromium/src/cc/trees/clip_node.h?dr\u003dCSs\u0026l\u003d35): in a bottom-up mapping, a clip shrinks a clip rect; a pixel-moving filter expands a clip rect. I hadn\u0027t fully understood the concept until I started to work on this patch.\n\nThe caller can check effect node before calling this function to skip the slow path, but the slow path is needed for completeness (otherwise a caller wants such semantics has no way to get it.)",
      "parentUuid": "f1332446_e5f29b95",
      "revId": "5f3e3972e8c3ce5674d835ca101e1b114c2cad36",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}