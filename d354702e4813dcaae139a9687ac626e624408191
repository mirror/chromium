{
  "comments": [
    {
      "key": {
        "uuid": "55a36eae_fb075a8d",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/webapps/WebApkInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-11-27T00:54:45Z",
      "side": 1,
      "message": "Why is this a set?\n\nThe current web share target spec states that there is only one share target in the manifest (https://wicg.github.io/web-share-target/). This might change in the future, but for now we can assume that we\u0027ll only ever get one share target (since it\u0027s a syntax error to list more than one).\n\nThe proto having a repeated field is future proof, but until we know what a multiple share target world looks like spec-wise (each ShareTarget may possibly get more fields, e.g. an identifying name to go with each target), we should stick to a single String for the share template throughout. Having just a set of strings here is almost certainly not going to match what the multiple share target world will be - +mgiuca (spec author) who I chatted with on this.\n\nIs there a case now where this set will (validly) have more than one element in it?",
      "range": {
        "startLine": 42,
        "startChar": 12,
        "endLine": 42,
        "endChar": 15
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e950d13_d670ef30",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/webapps/WebApkInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1115963
      },
      "writtenOn": "2017-11-27T06:07:44Z",
      "side": 1,
      "message": "+1\n\n\u003e Having just a set of strings here is almost certainly not going to match what the multiple share target world will be\n\nIndeed. Because if we do allow multiple share targets, we will certainly have to add at least one more field: \"name\", which will let the user agent distinguish the different share targets in the UI by name (so this data structure will certainly need to change). Having just a set of strings representing different URL templates is nonsensical, since we would never be able to present to the user two or more URL templates without names.",
      "parentUuid": "55a36eae_fb075a8d",
      "range": {
        "startLine": 42,
        "startChar": 12,
        "endLine": 42,
        "endChar": 15
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "100eae68_9ccd68c9",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/webapps/WebApkInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-01T03:01:58Z",
      "side": 1,
      "message": "I have changed this to just be a string. I now extract the share target info from the first activity which can handle share intents. As the spec is now, the WebAPK server will only generate WebAPKs with a single ShareActivity which can handle Android share intents.",
      "parentUuid": "4e950d13_d670ef30",
      "range": {
        "startLine": 42,
        "startChar": 12,
        "endLine": 42,
        "endChar": 15
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d88c51ec_599f6aa2",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/webapps/WebApkInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1115963
      },
      "writtenOn": "2017-12-01T03:12:10Z",
      "side": 1,
      "message": "Great. Let\u0027s just make sure that it\u0027s future proof in case we want to add multiple targets one day. (I think the proto allows this, right?)",
      "parentUuid": "100eae68_9ccd68c9",
      "range": {
        "startLine": 42,
        "startChar": 12,
        "endLine": 42,
        "endChar": 15
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "053119dc_0d0f20d7",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/webapps/WebApkInfo.java",
        "patchSetId": 1
      },
      "lineNbr": 42,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-01T03:51:46Z",
      "side": 1,
      "message": "I think that the current design is future proof. Matt, let me know if you see something which can be improved.\n\nThe share target in the proto sent to the server is a repeated field. https://cs.chromium.org/chromium/src/chrome/browser/android/webapk/webapk.proto?rcl\u003d4a7469f71620aa241876bed601f931fcdbbec87e\u0026l\u003d92\nThe WebAPK AndroidManifest format scales to multiple share targets. https://cs.chromium.org/chromium/src/chrome/android/webapk/shell_apk/AndroidManifest.xml?rcl\u003d62acf2e5e95be89098a3f7e9a136d9d2f2b6c24e\u0026l\u003d40",
      "parentUuid": "d88c51ec_599f6aa2",
      "range": {
        "startLine": 42,
        "startChar": 12,
        "endLine": 42,
        "endChar": 15
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dbc310fd_22a990b0",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkInfoTest.java",
        "patchSetId": 1
      },
      "lineNbr": 132,
      "author": {
        "id": 1117405
      },
      "writtenOn": "2017-11-13T19:55:40Z",
      "side": 1,
      "message": "Nit: How about changing WebApkTestHelper#registerWebApkWithMetaData() to have a List\u003cString\u003e as input, not List\u003cActivityInfo\u003e?",
      "range": {
        "startLine": 132,
        "startChar": 81,
        "endLine": 132,
        "endChar": 91
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c51034b_7a7a1f65",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkInfoTest.java",
        "patchSetId": 1
      },
      "lineNbr": 132,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-11-21T03:20:09Z",
      "side": 1,
      "message": "I think that List\u003cActivityInfo\u003e is more extensible. Given that we don\u0027t make much use of the new parameter yet, it does not really matter either way in my opinion.",
      "parentUuid": "dbc310fd_22a990b0",
      "range": {
        "startLine": 132,
        "startChar": 81,
        "endLine": 132,
        "endChar": 91
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c4ca4e9c_a15bb7d1",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkInfoTest.java",
        "patchSetId": 1
      },
      "lineNbr": 371,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-11-27T00:54:45Z",
      "side": 1,
      "message": "Is this testing a circumstance that can actually happen at the moment (i.e. can WebAPKs have more than 2 activities - the main one and at most a single ShareTarget activity?)",
      "range": {
        "startLine": 371,
        "startChar": 16,
        "endLine": 371,
        "endChar": 72
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0cbf9138_7258cbeb",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkInfoTest.java",
        "patchSetId": 1
      },
      "lineNbr": 371,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-01T03:01:58Z",
      "side": 1,
      "message": "Yes, this is testing a circumstance that does happen. Each WebAPK has a MainActivity and a ShareActivity. MainActivity.java does not have an intent filter for share intents",
      "parentUuid": "c4ca4e9c_a15bb7d1",
      "range": {
        "startLine": 371,
        "startChar": 16,
        "endLine": 371,
        "endChar": 72
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca622506_0208a09b",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkUpdateManagerUnitTest.java",
        "patchSetId": 1
      },
      "lineNbr": 854,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-12-01T04:13:12Z",
      "side": 1,
      "message": "This test could be retained right, with the small change of shareUrlTemplates.clear() -\u003e shareUrlTemplate \u003d ?",
      "range": {
        "startLine": 837,
        "startChar": 0,
        "endLine": 854,
        "endChar": 5
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d7c7a19_c74f2e38",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkUpdateManagerUnitTest.java",
        "patchSetId": 1
      },
      "lineNbr": 854,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-06T00:42:00Z",
      "side": 1,
      "message": "I could retain the test. I don\u0027t want to because I feel like the logic being tested is too simple. I think that it is important to have tests for when:\n- the logic for whether an update should be requested is more complicated than checking for int/string equality\n- the attribute being compared has a surprising default value",
      "parentUuid": "ca622506_0208a09b",
      "range": {
        "startLine": 837,
        "startChar": 0,
        "endLine": 854,
        "endChar": 5
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f203276a_ea540de3",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkUpdateManagerUnitTest.java",
        "patchSetId": 1
      },
      "lineNbr": 854,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-12-06T03:16:37Z",
      "side": 1,
      "message": "The logic may be simple now, but it may become more complex in the future. Perhaps there will be some transformation applied to the templates, or some other internal refactoring. Java is also prone to \u003d\u003d vs .equals() bugs. I think there is always value in simple unit tests like this.\n\nThis could even be extended by having one pass with two identical share templates, and ensuring that an upgrade is not requested.",
      "parentUuid": "7d7c7a19_c74f2e38",
      "range": {
        "startLine": 837,
        "startChar": 0,
        "endLine": 854,
        "endChar": 5
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1ade82dc_d9624a32",
        "filename": "chrome/android/junit/src/org/chromium/chrome/browser/webapps/WebApkUpdateManagerUnitTest.java",
        "patchSetId": 1
      },
      "lineNbr": 854,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-06T16:08:10Z",
      "side": 1,
      "message": "I have brought back the test testing whether an update is requested when the share templates are different\n\nWe already have a test for two identical share templates: testUpdateNotNeeded\ndefaultManifestData() sets the share template to be non-empty",
      "parentUuid": "f203276a_ea540de3",
      "range": {
        "startLine": 837,
        "startChar": 0,
        "endLine": 854,
        "endChar": 5
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c38a17b6_2b7ffed2",
        "filename": "chrome/browser/android/shortcut_info.h",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-11-27T00:54:45Z",
      "side": 1,
      "message": "This shouldn\u0027t be a vector until it is legal under the spec to have multiple share targets (https://wicg.github.io/web-share-target/).",
      "range": {
        "startLine": 92,
        "startChar": 2,
        "endLine": 92,
        "endChar": 29
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "afaf2c39_cc4d1624",
        "filename": "chrome/browser/android/shortcut_info.h",
        "patchSetId": 1
      },
      "lineNbr": 92,
      "author": {
        "id": 1176654
      },
      "writtenOn": "2017-12-01T03:01:58Z",
      "side": 1,
      "message": "Ok, changed this back to not a vector",
      "parentUuid": "c38a17b6_2b7ffed2",
      "range": {
        "startLine": 92,
        "startChar": 2,
        "endLine": 92,
        "endChar": 29
      },
      "revId": "d354702e4813dcaae139a9687ac626e624408191",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}