{
  "comments": [
    {
      "key": {
        "uuid": "889e4c25_46364fd1",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder_egtest.mm",
        "patchSetId": 1
      },
      "lineNbr": 233,
      "author": {
        "id": 1134915
      },
      "writtenOn": "2017-06-19T15:09:12Z",
      "side": 1,
      "message": "This is probably not the best fix, but a first baseline for this WIP CL. Can you advise on how to evolve it to a better standard?",
      "range": {
        "startLine": 233,
        "startChar": 15,
        "endLine": 233,
        "endChar": 56
      },
      "revId": "1ddbebaad201d901901aaed46f8915f98f55a1ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eeac6b75_d418fc62",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder_egtest.mm",
        "patchSetId": 1
      },
      "lineNbr": 233,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2017-06-20T17:52:50Z",
      "side": 1,
      "message": "Do we understand why this is failing on iOS 9 iPhone simulator?\n\nOriginally, the matcher |WebViewContainingText| waits for the web view to contain specific text, however, a matcher should not wait, and that\u0027s why this line was replaced by |waitForWebViewContainingText|, so |waitForWebViewContainingText| is probably the right way to go. I think we need to figure out why |waitForWebViewContainingText| doesn\u0027t work for this test, maybe there is a bug in the helper functions.",
      "parentUuid": "889e4c25_46364fd1",
      "range": {
        "startLine": 233,
        "startChar": 15,
        "endLine": 233,
        "endChar": 56
      },
      "revId": "1ddbebaad201d901901aaed46f8915f98f55a1ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97edbc5e_fb94a3da",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder_egtest.mm",
        "patchSetId": 1
      },
      "lineNbr": 233,
      "author": {
        "id": 1134915
      },
      "writtenOn": "2017-06-21T09:42:41Z",
      "side": 1,
      "message": "It is failing on the line below: it waits for 3 tabs to open, but there are only two. I guess it\u0027s because this matcher matches on the first tab and doesn\u0027t really wait for the two others to open. So only the second has the time to open, not the third.\n\nI added a [[GREYUIThreadExecutor sharedInstance] drainUntilIdle]; and it fixes the test. See latest patch. The issue might just be this test that waits for something to appear that is similar to something already on screen.",
      "parentUuid": "eeac6b75_d418fc62",
      "range": {
        "startLine": 233,
        "startChar": 15,
        "endLine": 233,
        "endChar": 56
      },
      "revId": "1ddbebaad201d901901aaed46f8915f98f55a1ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0454ed53_4c4ecfe9",
        "filename": "ios/chrome/browser/metrics/tab_usage_recorder_egtest.mm",
        "patchSetId": 1
      },
      "lineNbr": 233,
      "author": {
        "id": 1164104
      },
      "writtenOn": "2017-06-21T16:27:51Z",
      "side": 1,
      "message": "ha! I see, it\u0027s because all the three tabs we open have the same URL and the same content, so [ChromeEarlGrey waitForWebViewContainingText:kURL1FirstWord]; doesn\u0027t really help at all as it always succeeds no matter which tab we\u0027re in.\n\nHow about?\n\n  for (NSUInteger i \u003d 0; i \u003c numberOfTabs; i++) {\n    chrome_test_util::OpenNewTab();\n    [ChromeEarlGrey loadURL:url1];\n    [ChromeEarlGrey waitForWebViewContainingText:kURL1FirstWord];\n    chrome_test_util::AssertMainTabCount(i + 1);\n  }\n\nAnd remove the chrome_test_util::AssertMainTabCount(numberOfTabs);\n\nI think this way it\u0027s clearer that we\u0027re waiting for the tab to be opened instead of other UI parts. Let me know how you think of it.\n\nIn either cause, could you please add a short comment explaining why [ChromeEarlGrey waitForWebViewContainingText:kURL1FirstWord]; alone doesn\u0027t work?",
      "parentUuid": "97edbc5e_fb94a3da",
      "range": {
        "startLine": 233,
        "startChar": 15,
        "endLine": 233,
        "endChar": 56
      },
      "revId": "1ddbebaad201d901901aaed46f8915f98f55a1ff",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}