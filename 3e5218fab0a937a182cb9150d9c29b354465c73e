{
  "comments": [
    {
      "key": {
        "uuid": "19738050_3768fe72",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2017-11-27T07:30:03Z",
      "side": 1,
      "message": "How about changing this function to take a proto as an argument instead of strings and an int, so that you will never need to edit this file when adding a new field to the proto?\n\nThe same goes for AuthenticateUser().",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f53f1db_786eff4f",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1161264
      },
      "writtenOn": "2017-11-27T08:25:13Z",
      "side": 1,
      "message": "The reason we\u0027re switching to proto for the D-Bus call is because it\u0027s a major hassle adding/modifying parameters as it crosses the Chrome OS/Chrome boundary. This is not the case for this method - it\u0027s all Chrome. If we switched this function to take a proto, then the caller would have to serialize the proto and the interface would be less readable.",
      "parentUuid": "19738050_3768fe72",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54606753_6fcfb66c",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2017-11-27T08:39:04Z",
      "side": 1,
      "message": "Generally speaking, D-Bus client classes should contain minimal code which is needed to pass arguments to the service process crossing the process boundary for better test coverage, and this also applies to proto packing code.\nhttps://chromium.git.corp.google.com/chromiumos/docs/+/master/dbus_in_chrome.md#Keep-your-class-minimal\n\nThe only user of JoinAdDomain() and AuthenticateUser() is chromeos/login/auth/authpolicy_login_helper.cc, and I think moving proto packing code to there wouldn\u0027t affect the readability.",
      "parentUuid": "6f53f1db_786eff4f",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6145635_35185f1f",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1161264
      },
      "writtenOn": "2017-11-27T09:08:09Z",
      "side": 1,
      "message": "OK, testability is a good argument. I looked around a bit and most similar examples I found used protos as input args. However, for output args it seems common to translate the args in the client and not pass them to observers (random example: PowerManagerClientImpl::PeripheralBatteryStatusReceived). Would it make sense to clarify in the docs that proto (de-)serialization shouldn\u0027t be part of clients? Right now it says \"client classes should ... serialize and deserialize D-Bus message arguments\", so you could argue that proto serialization is part of that.\n\nNote that password_fd isn\u0027t part of the proto since a D-Bus file descriptor can\u0027t be represented in proto, so it should probably remain a separate input argument.",
      "parentUuid": "54606753_6fcfb66c",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36e037e5_7682bb5c",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1000169
      },
      "writtenOn": "2017-11-27T09:25:58Z",
      "side": 1,
      "message": "Proto serialization (i.e. proto -\u003e bytes) happens in MessageWriter::AppendProtoAsArrayOfBytes() and it\u0027s OK to have both proto \u0026 D-Bus message serialization in the client class.\nNot having proto construction (i.e. parameters -\u003e proto) in the client class makes the C++ interface consistent with that of D-Bus, and makes more code tested.\nI know there are already many bad existing examples as it\u0027s tempting to put more code in this directory, but it\u0027d be appreciated if you could put your business logic in the feature\u0027s own directory which has a more appropriate ownership.\n\nIf you have any ideas to improve the documentation, I and derat@ would be happy to review CLs :)",
      "parentUuid": "e6145635_35185f1f",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87350d94_22361544",
        "filename": "chromeos/dbus/auth_policy_client.cc",
        "patchSetId": 5
      },
      "lineNbr": 67,
      "author": {
        "id": 1111144
      },
      "writtenOn": "2017-11-27T11:28:10Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "36e037e5_7682bb5c",
      "revId": "3e5218fab0a937a182cb9150d9c29b354465c73e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}