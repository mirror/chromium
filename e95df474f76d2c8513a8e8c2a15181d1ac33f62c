{
  "comments": [
    {
      "key": {
        "uuid": "7679a87c_3b075d2a",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 158,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-10-30T17:11:16Z",
      "side": 1,
      "message": "This function basically says the whole model changed. Isn\u0027t only a single WebContents changing when the RenderViewHost changes?",
      "range": {
        "startLine": 158,
        "startChar": 15,
        "endLine": 158,
        "endChar": 29
      },
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1f9a08d_bf06f3ae",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 175,
      "author": {
        "id": 1001216
      },
      "writtenOn": "2017-10-27T19:04:00Z",
      "side": 1,
      "message": "This seems a little unexpected to me, but maybe it works (for now)?\n\nThe dialog seems to be specifically about a process, so I\u0027m surprised to find that it just kills the current main frame process in Cancel().  That means it can\u0027t work for OOPIFs, and indeed, it doesn\u0027t seem to appear for a frozen OOPIF.\n\nIt also seems unexpected for the new process to commit and already be unresponsive, but maybe that\u0027s possible if the timing is just right?  If the new process is unresponsive here, does the TabUpdated() call below effectively change which URLs/titles are displayed in the dialog to reflect the new process rather than the old one?  Can we verify that?\n\nI feel like we could have much more confidence in this dialog (and fixing this stubborn bug) if we made the dialog specific to a given process, opening a separate dialog for the new process if it proves to be unresponsive.  That would also give us a chance to support OOPIFs, where we need to know which process is the unresponsive one and thus needs to be killed.\n\nThat said, that would be a bigger change, so if this fixes the bug and doesn\u0027t introduce new issues, maybe we can proceed with it for the short term.  We should definitely include a test so that we don\u0027t regress it with the followup refactor.",
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a9c89ee2_c0159fb6",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 175,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-27T19:12:25Z",
      "side": 1,
      "message": "The WebContentsObserver code doesn\u0027t deal with OOPIFs it only looks at the main frame. If a OOPIF is hung it won\u0027t tell the user. kenrb@ and I talked about this.. but I\u0027ll leave it to site isolation team to decide what to do there.",
      "parentUuid": "c1f9a08d_bf06f3ae",
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "530bb41c_70538dcf",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 175,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-27T21:02:48Z",
      "side": 1,
      "message": "Yes, I think we might want to think more carefully about whether this dialog should appear for an OOPIF, and how it should look like in that case.  Currently it says \"Page unresponsive\", and and we\u0027d at least need to change \"Page\" to \"Subframe\" or something like that for a hung OOPIF.  It also isn\u0027t clear that the user cares, since the main page is still functional.  On the other hand, IIUC, the hung dialog comes up after you try to interact with the hung widget, so if the user was trying to do something inside the OOPIF, maybe it does make sense to bring this dialog up, allow the user to kill the OOPIF process, and then reload it via right-click?  I don\u0027t know if most users will understand this flow though.\n\nIt does seem like a bigger change, so maybe we could file a bug for it and follow up separately?\n\nA separate question is: given that a hung OOPIF can\u0027t bring up this dialog, there\u0027s no way hung OOPIFs could contribute to these renderer hang crash reports, right?",
      "parentUuid": "a9c89ee2_c0159fb6",
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7ccad5a3_b9b6146e",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 175,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-27T21:12:18Z",
      "side": 1,
      "message": "hung OOPIFs shouldn\u0027t contribute to it... Let\u0027s fix this and see what happens with the metrics though.\n\nI agree that is a larger change.",
      "parentUuid": "530bb41c_70538dcf",
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "01e19ff1_c3b20853",
        "filename": "chrome/browser/ui/views/hung_renderer_view.cc",
        "patchSetId": 3
      },
      "lineNbr": 175,
      "author": {
        "id": 1001216
      },
      "writtenOn": "2017-10-27T21:16:25Z",
      "side": 1,
      "message": "To be clear, I don\u0027t expect us to fix OOPIF support in this CL.  :)  That\u0027s just one of the issues I noticed with the class.  I\u0027ll file a bug for that work.\n\nI\u0027m more concerned about the other things I noted:\n1) The dialog isn\u0027t tied to a process.  If we miss any kind of notification of process swap, we\u0027ll kill the wrong one, which feels fragile.\n2) It seems odd to repurpose the dialog for the new process, which seems unlikely to be marked unresponsive at the same time as the old process shows its dialog.  Would we not get a separate dialog in the case that the new process becomes unresponsive?  (If not, let\u0027s confirm whether the code here correctly updates the list of affected pages, and let\u0027s put some comments in.\n\nI can file a bug for the longer term refactoring and OOPIF support if we decide that there aren\u0027t problems with this short term approach.",
      "parentUuid": "530bb41c_70538dcf",
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0f72bf09_c011eb19",
        "filename": "chrome/browser/ui/views/hung_renderer_view.h",
        "patchSetId": 3
      },
      "lineNbr": 84,
      "author": {
        "id": 1000763
      },
      "writtenOn": "2017-10-30T17:11:16Z",
      "side": 1,
      "message": "Please add a comment.",
      "range": {
        "startLine": 84,
        "startChar": 7,
        "endLine": 84,
        "endChar": 17
      },
      "revId": "e95df474f76d2c8513a8e8c2a15181d1ac33f62c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}