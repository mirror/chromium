{
  "comments": [
    {
      "key": {
        "uuid": "b7abecae_0adffac6",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 51,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-08-29T16:31:53Z",
      "side": 1,
      "message": "why not create it in the constructor and make it final? Doing so here also makes it possible to override an existing tracker if the recycler view decides to create more than one view holder.\n\nAlso preferably don\u0027t make this an instance method. The view holder is static, so just create it with `new SuggestionsCarousel.ViewHolder(parent)`",
      "range": {
        "startLine": 51,
        "startChar": 8,
        "endLine": 51,
        "endChar": 26
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0412d738_b4e5bd2c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 51,
      "author": {
        "id": 1195464
      },
      "writtenOn": "2017-08-29T17:11:49Z",
      "side": 1,
      "message": "Because I want the ImpressionTracker to record only once when the carousel is shown inside the bottom sheet. So I use the wasTriggered() method to filter through all other shows of the caousel (like if the user scrolls up and down furiously). BUT the SuggestionCarousel is an object that is retained when the bottom sheet is closed. So, the impression tracker is also retained and its private field - mTriggered - always stays true after the first \u0027show\u0027. Thus, no suggestions are ever recorded again ;( .\n\nWhat I can do, is move all this code inside the ViewHolder itself? Then the ImpressionTracker will be final and will live until we close the bottom sheet. \n\nAny other suggestions?",
      "parentUuid": "b7abecae_0adffac6",
      "range": {
        "startLine": 51,
        "startChar": 8,
        "endLine": 51,
        "endChar": 26
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "233385da_b3386a22",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 51,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-08-29T17:32:11Z",
      "side": 1,
      "message": "okay so we need to reset the internal state of the carousel when the bottom sheet is pulled up. This is something we also do for tiles and suggestions, through methods called from onContentShown. \n\nWe currently update the carousel there too, but trough individual methods. The content class still does everything. I\u0027d suggest moving the logic of maybeUpdateContextualSuggestions into SuggestionsCarousel to something like reset() or refresh(), and reset the impression tracker there?",
      "parentUuid": "0412d738_b4e5bd2c",
      "range": {
        "startLine": 51,
        "startChar": 8,
        "endLine": 51,
        "endChar": 26
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "262d58f8_9624c6f6",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 51,
      "author": {
        "id": 1195464
      },
      "writtenOn": "2017-08-30T12:53:32Z",
      "side": 1,
      "message": "We create a new viewholder each time the bottom sheet is pulled up. That means that every time we reset the impression tracker, we need to give it a new recycler view. This is very ugly if I try to do it from the suggestions carousel and also, it seems like it belongs in the view holder. The view holder is the thing that holds the view and shows it to the screen. So this is also where we should record that the carousel is shown.",
      "parentUuid": "233385da_b3386a22",
      "range": {
        "startLine": 51,
        "startChar": 8,
        "endLine": 51,
        "endChar": 26
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d4dc8a1d_2b7074db",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 51,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-09-04T17:39:33Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "262d58f8_9624c6f6",
      "range": {
        "startLine": 51,
        "startChar": 8,
        "endLine": 51,
        "endChar": 26
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a20c37c8_4fe5f359",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-08-29T16:31:53Z",
      "side": 1,
      "message": "probably could be lambda if you initialise the tracker in the constructor.",
      "range": {
        "startLine": 56,
        "startChar": 16,
        "endLine": 56,
        "endChar": 28
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5aa1e82_6f05e22f",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1195464
      },
      "writtenOn": "2017-08-30T12:53:32Z",
      "side": 1,
      "message": "That means that I cant make the field final as the lambda expression would use the final field (mImpressionTracker), which will not be initialized at the time of creating the lambda expression. I moved it to the view holder. I like lambdas :D",
      "parentUuid": "a20c37c8_4fe5f359",
      "range": {
        "startLine": 56,
        "startChar": 16,
        "endLine": 56,
        "endChar": 28
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "329b2191_cdf52b07",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-09-04T17:39:33Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "e5aa1e82_6f05e22f",
      "range": {
        "startLine": 56,
        "startChar": 16,
        "endLine": 56,
        "endChar": 28
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9fce9926_b4aebdcd",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 90,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-08-29T16:31:53Z",
      "side": 1,
      "message": "asserting this is not considered best practice anymore, see https://chromium-review.googlesource.com/c/chromium/src/+/633444 and linked conversation",
      "range": {
        "startLine": 90,
        "startChar": 15,
        "endLine": 90,
        "endChar": 21
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2ea0761d_18e46f9d",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 90,
      "author": {
        "id": 1195464
      },
      "writtenOn": "2017-08-30T12:53:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9fce9926_b4aebdcd",
      "range": {
        "startLine": 90,
        "startChar": 15,
        "endLine": 90,
        "endChar": 21
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f91fa9d4_c0b9b05c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 119,
      "author": {
        "id": 1123275
      },
      "writtenOn": "2017-08-29T16:31:53Z",
      "side": 1,
      "message": "defensively check that the state is SCROLL_STATE_DRAGGING ? Implementation detail could or something else could trigger event changes but the above state explicitly mentions user intervention.",
      "range": {
        "startLine": 119,
        "startChar": 80,
        "endLine": 119,
        "endChar": 88
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e3200c3_14f9236f",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/suggestions/SuggestionsCarousel.java",
        "patchSetId": 4
      },
      "lineNbr": 119,
      "author": {
        "id": 1195464
      },
      "writtenOn": "2017-08-30T12:53:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f91fa9d4_c0b9b05c",
      "range": {
        "startLine": 119,
        "startChar": 80,
        "endLine": 119,
        "endChar": 88
      },
      "revId": "f2dc7b93dfb5387e9c73beecec56f39bea9c6fec",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}