{
  "comments": [
    {
      "key": {
        "uuid": "cfc08a9b_db6bd074",
        "filename": "content/browser/renderer_host/input/input_router_impl.cc",
        "patchSetId": 47
      },
      "lineNbr": 271,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "Why is this being added to the InputRouterImpl? This class doesn\u0027t use Chrome IPC anymore for InputHostMsgs.",
      "range": {
        "startLine": 271,
        "startChar": 53,
        "endLine": 271,
        "endChar": 69
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a00e0124_6b13613c",
        "filename": "content/browser/renderer_host/input/input_router_impl.cc",
        "patchSetId": 47
      },
      "lineNbr": 271,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "In InputHandlerProxy::HitTestTouchEvent, we changed the return val from DID_NOT_HANDLE to DID_HANDLE_NON_BLOCKING, which means that compositor is sending an ACK. That ACK is bundled with a whitelisted touch action and sent as a mojo message. As a result, when the main thread computes the real touch action, it won\u0027t send the touch action to the browser because the event has been ACKed from the compositor. That\u0027s why we need this extra IPC message. Does that make sense?",
      "parentUuid": "cfc08a9b_db6bd074",
      "range": {
        "startLine": 271,
        "startChar": 53,
        "endLine": 271,
        "endChar": 69
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3f331a75_67e4b59b",
        "filename": "content/browser/renderer_host/input/input_router_impl.cc",
        "patchSetId": 47
      },
      "lineNbr": 271,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-16T14:36:04Z",
      "side": 1,
      "message": "I think you probably want to change CancelTouchTimeout to be SetTouchAction message here:\n\nhttps://cs.chromium.org/chromium/src/content/common/input/input_handler.mojom?q\u003dinput_handler.mojo\u0026sq\u003dpackage:chromium\u0026l\u003d159\n\nThen that would be using mojo and not ChromeIPC",
      "parentUuid": "a00e0124_6b13613c",
      "range": {
        "startLine": 271,
        "startChar": 53,
        "endLine": 271,
        "endChar": 69
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9cce73be_704a2e79",
        "filename": "content/browser/renderer_host/input/input_router_impl.cc",
        "patchSetId": 47
      },
      "lineNbr": 271,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-17T12:10:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3f331a75_67e4b59b",
      "range": {
        "startLine": 271,
        "startChar": 53,
        "endLine": 271,
        "endChar": 69
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1eae413f_7c69642d",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 175,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "Looking at the GesturePinchUpdate there is a zoom disabled value. I\u0027m not sure what sets it but it seems to dicard the pinch event if it is set. Should we handle that?",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed856a5e_424fe53f",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 175,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "I don\u0027t think we need to worry about it here. The |zoom_disabled| bit is checked here:\nhttps://cs.chromium.org/chromium/src/ui/events/blink/input_handler_proxy.cc?dr\u0026sq\u003dpackage:chromium\u0026l\u003d431\n\nIf that bit is true, then the InputHandlerProxy::HandleInputEvent() returns DROP_EVENT. My understanding is that if it is DROP_EVENT, the event won\u0027t even get to the TouchActionFilter, is that correct?",
      "parentUuid": "1eae413f_7c69642d",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "847f7071_9f52c7d8",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 175,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-16T14:36:04Z",
      "side": 1,
      "message": "The TouchActionFilter is *before* the InputHandlerProxy as it runs on the browser side before the events are sent to the InputHandlerProxy.",
      "parentUuid": "ed856a5e_424fe53f",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b72b64a8_b4c65cf9",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 175,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-17T12:10:50Z",
      "side": 1,
      "message": "Thanks for pointing it out. I have addressed this issue and added a new test case in the AccumulatedPinchScaleWithKnownTouchAction, to verify that the pinch scale will NOT accumulate if zoom_disabled is true.",
      "parentUuid": "847f7071_9f52c7d8",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "70dadf7d_2a050497",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 259,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "This kind of looks dubious... Can we make it look like line 252 where value() is on the RHS.",
      "range": {
        "startLine": 259,
        "startChar": 26,
        "endLine": 259,
        "endChar": 31
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "707ae097_8572bf31",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 259,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "70dadf7d_2a050497",
      "range": {
        "startLine": 259,
        "startChar": 26,
        "endLine": 259,
        "endChar": 31
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "638d9050_0b4fa015",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 260,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "Should a GestureScrollUpdate be synthesized if there are pending accumulated scroll deltas? So as not to delay the event until the next input event that may or may not come in?",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42a93140_aba1e3f9",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 260,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "I am leaning towards \"This is a TODO item\" :)\nThere are two cases fit here:\n1. scroll begin--\u003ea few scroll update--\u003escroll end\n2. scroll begin--\u003epinch begin--\u003ea few pinch update--\u003epinch end\n\nSay that the main thread is too busy and the real touch action is never computed, even after scroll end and pinch end. IMHO the right thing to do is to drop all the event and all the accumulated value, because we don\u0027t know whether they are allowed or not. If we do synthesize a scroll update or a pinch update to account for the accumulated value, what if the accumulated value is not allowed?",
      "parentUuid": "638d9050_0b4fa015",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "680100ed_769289fb",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 260,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-16T14:36:04Z",
      "side": 1,
      "message": "That is certainly a difference in the behavior than todays. I didn\u0027t think you intended to have any behavioral changes. From a performance point of view as soon as the touch action is known we should dispatch any accumulated delta instead of waiting around.",
      "parentUuid": "42a93140_aba1e3f9",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab5ac275_b7caa93d",
        "filename": "content/browser/renderer_host/input/touch_action_filter.cc",
        "patchSetId": 47
      },
      "lineNbr": 260,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-17T12:10:50Z",
      "side": 1,
      "message": "I put some more comments (TODO) here.\n\nI changed the InputHandlerProxy to use a flag to switch between the current behavior and this new behavior. If this change cause something bad to happen, we can easily disable the flag.\n\nMy thoughts are: it is probably rare to have the real touch action unknown until the scroll / pinch end (We will add UMA to measure that). If metrics indicate that this does happen often, we should either disable the flag or find a better way to handle this problem. For the initial version, I think it is fine to go with this behavior (drop all the accumulated delta if the real touch action is unknown).\n\nLocally I have tried enabling/disabling the flag, and I can see that when the flag is disabled, all touch actions are blocked on main.",
      "parentUuid": "680100ed_769289fb",
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c51365c9_00915a48",
        "filename": "content/browser/renderer_host/input/touch_action_filter_unittest.cc",
        "patchSetId": 47
      },
      "lineNbr": 925,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "Should this test that when the touch action is set a gesture event is sent for the accumulated delta?",
      "range": {
        "startLine": 925,
        "startChar": 28,
        "endLine": 925,
        "endChar": 0
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a4ac8c5a_cfac0bf4",
        "filename": "content/browser/renderer_host/input/touch_action_filter_unittest.cc",
        "patchSetId": 47
      },
      "lineNbr": 925,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "We do have that tested in the next test \"WhiteListedWithKnownRealTouchAction\". In that test, the whitelisted touch action is PanX, and we accumulate all the scroll deltaY. Later on the real touch action is Auto, and the accumulated scroll deltaY is applied.",
      "parentUuid": "c51365c9_00915a48",
      "range": {
        "startLine": 925,
        "startChar": 28,
        "endLine": 925,
        "endChar": 0
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "011983c1_bd60c274",
        "filename": "content/renderer/render_widget.cc",
        "patchSetId": 47
      },
      "lineNbr": 2385,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-11T21:04:16Z",
      "side": 1,
      "message": "Please don\u0027t mix and match chrome IPC and mojo IPC. It looks like you want to define a new mojo message.",
      "range": {
        "startLine": 2385,
        "startChar": 11,
        "endLine": 2385,
        "endChar": 38
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "534a5676_f03e9bc6",
        "filename": "content/renderer/render_widget.cc",
        "patchSetId": 47
      },
      "lineNbr": 2385,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-12T11:00:35Z",
      "side": 1,
      "message": "Based on our offline discussion, my understanding is that a mojo message for touch action is bundled with an ACK. Right now the compositor is sending an ACK with whitelisted touch action. So the main thread won\u0027t send another message because there is nothing to ACK. That\u0027s why we need an extra message to the browser to set the real touch action.",
      "parentUuid": "011983c1_bd60c274",
      "range": {
        "startLine": 2385,
        "startChar": 11,
        "endLine": 2385,
        "endChar": 38
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3c670ac3_876b6783",
        "filename": "content/renderer/render_widget.cc",
        "patchSetId": 47
      },
      "lineNbr": 2385,
      "author": {
        "id": 1123071
      },
      "writtenOn": "2017-10-16T14:36:04Z",
      "side": 1,
      "message": "See the other comment.. InputHostMsg_ is replaced with Mojo but here you are mixing them.",
      "parentUuid": "534a5676_f03e9bc6",
      "range": {
        "startLine": 2385,
        "startChar": 11,
        "endLine": 2385,
        "endChar": 38
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8366a711_63253cc0",
        "filename": "content/renderer/render_widget.cc",
        "patchSetId": 47
      },
      "lineNbr": 2385,
      "author": {
        "id": 1148154
      },
      "writtenOn": "2017-10-17T12:10:50Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "3c670ac3_876b6783",
      "range": {
        "startLine": 2385,
        "startChar": 11,
        "endLine": 2385,
        "endChar": 38
      },
      "revId": "feb00ba83d99ae80688cf06007de4e3c9187ea43",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}