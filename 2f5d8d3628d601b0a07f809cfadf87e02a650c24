{
  "comments": [
    {
      "key": {
        "uuid": "2db20350_cc7d9c36",
        "filename": "content/common/service_worker/service_worker_container.mojom",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-11-06T17:25:12Z",
      "side": 1,
      "message": "\"its client\" -\u003e \"this service worker client\"\n\nDon\u0027t need to to say \"(browser-\u003erenderer)\".",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c1712b46_8105a998",
        "filename": "content/common/service_worker/service_worker_container.mojom",
        "patchSetId": 4
      },
      "lineNbr": 108,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2db20350_cc7d9c36",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e0b8f56b_9da0e870",
        "filename": "content/common/service_worker/service_worker_container.mojom",
        "patchSetId": 4
      },
      "lineNbr": 109,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-11-06T17:25:12Z",
      "side": 1,
      "message": "Can this change from uint32 to blink.mojom.WebFeature like SetController() uses?",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "09ea4c13_3ba8d40a",
        "filename": "content/common/service_worker/service_worker_container.mojom",
        "patchSetId": 4
      },
      "lineNbr": 109,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e0b8f56b_9da0e870",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "514bee04_ea37d119",
        "filename": "content/renderer/service_worker/service_worker_dispatcher.h",
        "patchSetId": 4
      },
      "lineNbr": 126,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-06T03:55:34Z",
      "side": 1,
      "message": "Why we need this |WorkerToProviderMap|? It seems never be used..",
      "range": {
        "startLine": 126,
        "startChar": 8,
        "endLine": 126,
        "endChar": 27
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "21a02b6c_498d5d47",
        "filename": "content/renderer/service_worker/service_worker_dispatcher.h",
        "patchSetId": 4
      },
      "lineNbr": 126,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T07:57:57Z",
      "side": 1,
      "message": "According to git blame, crrev.com/261533003 is the initial patch to introduce WorkerToProviderMap. I think we could remove that.",
      "parentUuid": "514bee04_ea37d119",
      "range": {
        "startLine": 126,
        "startChar": 8,
        "endLine": 126,
        "endChar": 27
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cdaf95b5_fe1d0cd8",
        "filename": "content/renderer/service_worker/service_worker_dispatcher.h",
        "patchSetId": 4
      },
      "lineNbr": 126,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "21a02b6c_498d5d47",
      "range": {
        "startLine": 126,
        "startChar": 8,
        "endLine": 126,
        "endChar": 27
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "01ff5d93_111d8a08",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 116,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T07:57:57Z",
      "side": 1,
      "message": "nit:  \u003d default",
      "range": {
        "startLine": 116,
        "startChar": 62,
        "endLine": 116,
        "endChar": 2
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b08a0313_297bb091",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 116,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "01ff5d93_111d8a08",
      "range": {
        "startLine": 116,
        "startChar": 62,
        "endLine": 116,
        "endChar": 2
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "149aed3e_d0670b2b",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 298,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T07:57:57Z",
      "side": 1,
      "message": "Can we have a unit test for CountFeature?",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "86bce574_9394b275",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 298,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "149aed3e_d0670b2b",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f3eb8e1_10b31360",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 305,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T07:57:57Z",
      "side": 1,
      "message": "nit: how about move this to the beginning of this function?",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "938ecaf7_28d3b50d",
        "filename": "content/renderer/service_worker/service_worker_provider_context.cc",
        "patchSetId": 4
      },
      "lineNbr": 305,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9f3eb8e1_10b31360",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7e0f2f63_16500dcb",
        "filename": "content/renderer/service_worker/service_worker_provider_context.h",
        "patchSetId": 4
      },
      "lineNbr": 113,
      "author": {
        "id": 1000128
      },
      "writtenOn": "2017-11-06T17:25:12Z",
      "side": 1,
      "message": "Keep a comment about \"For service worker clients. Returns the feature usage of its controller.\"",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "edaed47b_54b64fa1",
        "filename": "content/renderer/service_worker/service_worker_provider_context.h",
        "patchSetId": 4
      },
      "lineNbr": 113,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Done, nice reminding, thanks.",
      "parentUuid": "7e0f2f63_16500dcb",
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1d98d5c9_597aa62a",
        "filename": "content/renderer/service_worker/web_service_worker_provider_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 242,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T07:57:57Z",
      "side": 1,
      "message": "Could we finally remove GetProviderClient() from SWDispatcher, too?",
      "range": {
        "startLine": 242,
        "startChar": 6,
        "endLine": 242,
        "endChar": 40
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a2a774f_4f28f528",
        "filename": "content/renderer/service_worker/web_service_worker_provider_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 242,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-06T08:04:11Z",
      "side": 1,
      "message": "Ahh, sorry I completely missed PostMessage. We still need to keep it. (but could we keep the pointer in WebSWProviderImpl?)",
      "parentUuid": "1d98d5c9_597aa62a",
      "range": {
        "startLine": 242,
        "startChar": 6,
        "endLine": 242,
        "endChar": 40
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06679e3a_158a159a",
        "filename": "content/renderer/service_worker/web_service_worker_provider_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 242,
      "author": {
        "id": 1223459
      },
      "writtenOn": "2017-11-07T08:53:46Z",
      "side": 1,
      "message": "Thanks, we cannot ensure the lifetime of the pointer if keep it in WebSWProviderImpl, please see the comments in https://chromium-review.googlesource.com/c/chromium/src/+/648659/6/content/child/service_worker/web_service_worker_provider_impl.cc#214",
      "parentUuid": "0a2a774f_4f28f528",
      "range": {
        "startLine": 242,
        "startChar": 6,
        "endLine": 242,
        "endChar": 40
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c2759e7_9c8b2df9",
        "filename": "content/renderer/service_worker/web_service_worker_provider_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 242,
      "author": {
        "id": 1161621
      },
      "writtenOn": "2017-11-08T02:00:33Z",
      "side": 1,
      "message": "I think we can make each WebSWProviderImpl manage its own WebSWProviderClient now, rather than managing a provider client map inside SWDispatcher.\nBecause here (https://cs.chromium.org/chromium/src/content/renderer/service_worker/service_worker_dispatcher.cc?rcl\u003dd4f91d118274c0f0583e7a6f196be6c48da4acc9\u0026l\u003d256) is the last one usage to the map |provider_clients_|, now this logic disappears. We just need to put a pointer of WebSWProviderClient as member of WebSWProviderImpl, update this member in SetClient() and check the member\u0027s nullity whenever we want to use it, all these logic just happen inside WebSWProviderImpl.",
      "parentUuid": "06679e3a_158a159a",
      "range": {
        "startLine": 242,
        "startChar": 6,
        "endLine": 242,
        "endChar": 40
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8f483c88_0511b4ff",
        "filename": "content/renderer/service_worker/web_service_worker_provider_impl.cc",
        "patchSetId": 4
      },
      "lineNbr": 242,
      "author": {
        "id": 1125915
      },
      "writtenOn": "2017-11-08T05:14:26Z",
      "side": 1,
      "message": "Ah, I didn\u0027t realize falken has already mentioned about that. \nAs Leon said, I also think we can have |provider_client_| as a member of WebSWProviderImpl. We cannot guarantee the lifetime of |provider_client_| so that |provider_client_| should be nullified at RemoveProviderClient() because there are no clear ownership between blink::SWContainer (which is WebSWProviderClient) and blink::SWContextClient (which is the owner of WebSWProviderImpl). I guess they basically should be tied with the ExecutionContext\u0027s lifecycle, but I\u0027m still not sure of that.\nSo we need to check whether |provider_client_| is null or not for every Mojo call.\n\n// Sorry I was missing that PostMessageToClients is actually a member of WebSWProviderImpl. Once |provider_client_| could be the member of it, we no longer use GetProviderClient().",
      "parentUuid": "0c2759e7_9c8b2df9",
      "range": {
        "startLine": 242,
        "startChar": 6,
        "endLine": 242,
        "endChar": 40
      },
      "revId": "2f5d8d3628d601b0a07f809cfadf87e02a650c24",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}