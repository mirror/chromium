{
  "comments": [
    {
      "key": {
        "uuid": "e3e07c71_5f2d12f3",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/toolbar/ToolbarManager.java",
        "patchSetId": 1
      },
      "lineNbr": 337,
      "author": {
        "id": 1135279
      },
      "writtenOn": "2017-11-08T16:43:12Z",
      "side": 1,
      "message": "Of the options I tried, this seems the most reasonable. I tried adding plumbing to invalidate the bitmap and set the toolbar as \u0027ready for capture\u0027, but I would still need to remove the check for Android O since this happens on other platforms. I can add a todo to remove this down the line; this is one of many issues that I believe can be fixed by doing an in-memory reparent of the tab rather than relying on the intent system. This is easier to merge though. Thoughts?",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 337,
        "endChar": 13
      },
      "revId": "3f263bcc5985a31115d3e390f35989fa6099144e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54faebac_2e1b4f17",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/toolbar/ToolbarManager.java",
        "patchSetId": 1
      },
      "lineNbr": 337,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-11-08T18:37:56Z",
      "side": 1,
      "message": "I think this seems fine, but can you describe why the current system doesn\u0027t work?\n\nAre we not getting new draw calls?  Is the invalidate check not working?  Are we invalidating but saying the toolbar can\u0027t be recaptured?  It would be good to know what about the current system is broken and document that in the CL comment.",
      "parentUuid": "e3e07c71_5f2d12f3",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 337,
        "endChar": 13
      },
      "revId": "3f263bcc5985a31115d3e390f35989fa6099144e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e365da5b_b8e404e2",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/toolbar/ToolbarManager.java",
        "patchSetId": 1
      },
      "lineNbr": 337,
      "author": {
        "id": 1135279
      },
      "writtenOn": "2017-11-08T21:09:37Z",
      "side": 1,
      "message": "I thought the plumbing fix might be O-specific, but I was wrong. The \u0027ready for capture\u0027 flag is not set until the next time the URL is updated. onUrlUpdated is not called initially (and therefore the flag not set) since the reparented tab technically hasn\u0027t updated; I\u0027m not sure if this is the intended behavior. Updated description.",
      "parentUuid": "54faebac_2e1b4f17",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 337,
        "endChar": 13
      },
      "revId": "3f263bcc5985a31115d3e390f35989fa6099144e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b4c7b318_11d6548a",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/toolbar/ToolbarManager.java",
        "patchSetId": 1
      },
      "lineNbr": 337,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-11-08T21:17:47Z",
      "side": 1,
      "message": "Ah, would it make sense to override onReparentingFinished and have this logic there instead?\n\nonShown might be called before onUrlUpdated so it could be undoing the work there?\n\nsetReadyForBitmapCapture was to prevent unnecessary bitmap capturing while the initial page is loading, so this could tweak that behavior slightly where onReparentingFinished would be less likely to change that.",
      "parentUuid": "e365da5b_b8e404e2",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 337,
        "endChar": 13
      },
      "revId": "3f263bcc5985a31115d3e390f35989fa6099144e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0982aac2_9fae45b8",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/toolbar/ToolbarManager.java",
        "patchSetId": 1
      },
      "lineNbr": 337,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-11-08T22:29:21Z",
      "side": 1,
      "message": "Oooh...looks like onActivityAttachmentChanged landed, so maybe that instead of onReparentingFinished (unless you need to cherrypick back, in which case it is probably better to use onReparentingFinished and then switch over in another CL).",
      "parentUuid": "b4c7b318_11d6548a",
      "range": {
        "startLine": 335,
        "startChar": 12,
        "endLine": 337,
        "endChar": 13
      },
      "revId": "3f263bcc5985a31115d3e390f35989fa6099144e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}