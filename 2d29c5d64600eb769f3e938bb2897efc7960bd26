{
  "comments": [
    {
      "key": {
        "uuid": "68ae7aca_fd11fee0",
        "filename": "chrome/browser/signin/chrome_signin_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 412,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "Let\u0027s rename this to:\ns/account_consistency_required/mirror_enabled",
      "range": {
        "startLine": 412,
        "startChar": 15,
        "endLine": 412,
        "endChar": 45
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4bae7ead_521c7a6a",
        "filename": "chrome/browser/signin/chrome_signin_helper_browsertest.cc",
        "patchSetId": 19
      },
      "lineNbr": 3,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2017-11-20T11:49:24Z",
      "side": 1,
      "message": "Is this file specific to ChromeOS? Should it be moved in a ChromeOS subdirectory, and maybe renamed to something more specific?",
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e1447853_f158bd1f",
        "filename": "chrome/browser/signin/chrome_signin_helper_browsertest.cc",
        "patchSetId": 19
      },
      "lineNbr": 7,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2017-11-20T11:49:24Z",
      "side": 1,
      "message": "Just curious: How does this even compile on other platforms that ChromeOS? Is it generally allowed by DEPS to include chromeos files from everywhere?",
      "range": {
        "startLine": 7,
        "startChar": 25,
        "endLine": 7,
        "endChar": 33
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "06dd7d44_d58d82f4",
        "filename": "chrome/browser/supervised_user/child_accounts/child_account_service.cc",
        "patchSetId": 19
      },
      "lineNbr": 196,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "Here and everywhere else where \"Account consistency\" is used in this CL.\n\nAccount consistency is of 2 types depending on the platform:\n* Mirror for mobile (and now for Unicorn on ChromeOS)\n* DICE for desktop (currently under development).\n\nI think we need to make it clear what we mean by account consistency here:\ns/Account consistency/Mirror",
      "range": {
        "startLine": 196,
        "startChar": 7,
        "endLine": 196,
        "endChar": 26
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "738e062c_4c978a14",
        "filename": "chrome/browser/supervised_user/supervised_user_constants.h",
        "patchSetId": 19
      },
      "lineNbr": 12,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "s/kAccountConsistencyRequired/kAccountConsistencyMirrorRequired or kMirrorRequired.",
      "range": {
        "startLine": 12,
        "startChar": 18,
        "endLine": 12,
        "endChar": 45
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4290484b_285cb3b2",
        "filename": "components/signin/core/browser/chrome_connected_header_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 128,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "I think it is confusing that Mirror may be enabled for profiles when Mirror feature is not enabled. We discussed this within the team and we believe the best option here is the followimg:\n1. Remove the function IsAccountConsistencyMirrorEnabled from the //compontens/signin\n2. Stop using IsAccountConsistencyMirrorEnabled in this file and pass a boolean as an argument to the constructor of ChromeConnectedHeaderHelper.\n\nIn this CL, please just implement bullet point 2 above (\"Stop using  IsAccountConsistencyMirrorEnabled in this file ..\"). David will do the follow-up clean-up and remove IsAccountConsistencyMirrorEnabled  from //components/signin.",
      "range": {
        "startLine": 128,
        "startChar": 9,
        "endLine": 128,
        "endChar": 42
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae2a3e4d_08e86e6a",
        "filename": "components/signin/core/browser/chrome_connected_header_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 129,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "s/account_consistency_required_by_profile_/is_mirror_enabled_",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 52
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e7303a01_5925835b",
        "filename": "components/signin/core/browser/chrome_connected_header_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 129,
      "author": {
        "id": 1001438
      },
      "writtenOn": "2017-11-20T11:49:24Z",
      "side": 1,
      "message": "It is not clear to me what is the goal here:\n1) use the whole mirror feature for child accounts (including the AccountReconcilor, ...)\nIn this case, this CL does not do enough. You should conceptually change all the places in the code where IsAccountConsistencyMirrorEnabled() is called.\n\n2) or only use the ChromeConnected header subfeature of Mirror in another context (child accounts).\nIn this case, we should cleanly split that header as a standalone feature, which then can be used both by Mirror and child accounts.",
      "parentUuid": "ae2a3e4d_08e86e6a",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 52
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "07514f5c_00658fc0",
        "filename": "components/signin/core/browser/chrome_connected_header_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 129,
      "author": {
        "id": 1249203
      },
      "writtenOn": "2017-11-20T12:19:07Z",
      "side": 1,
      "message": "From a user\u0027s perspective, can you clarify what else in Mirror that this change currently doesn\u0027t enable?",
      "parentUuid": "e7303a01_5925835b",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 52
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d40055c_b7a308fd",
        "filename": "components/signin/core/browser/chrome_connected_header_helper.cc",
        "patchSetId": 19
      },
      "lineNbr": 129,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T12:29:19Z",
      "side": 1,
      "message": "This change does not enable account consistency in Chrome. Basically, when Mirror is on, the Chrome AccountReconcilor is turned https://cs.chromium.org/chromium/src/components/signin/core/browser/account_reconcilor.cc\n\nAccountReconcilor is a service that continuously monitors the Gaia cookies and Chrome tokens to see any mismatch between the accounts in there. If it notices any difference, it will rebuild the Gaia cookie. Take the following example:\n* User is signed in to Chrome with child account K (both on content area and in Chrome sync).\n* Gaia cookie expires.\n* Account reconcilor adds back account K to Gaia cookie.\n\u003d\u003e user continues to be signed in with the same account in Chrome and on the web.",
      "parentUuid": "07514f5c_00658fc0",
      "range": {
        "startLine": 129,
        "startChar": 12,
        "endLine": 129,
        "endChar": 52
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "51d21dd1_4fb29699",
        "filename": "components/signin/core/browser/signin_header_helper_unittest.cc",
        "patchSetId": 19
      },
      "lineNbr": 459,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "Here and everywhere in this file:\ns/false/false /* is_mirror_enabled */",
      "range": {
        "startLine": 459,
        "startChar": 60,
        "endLine": 459,
        "endChar": 65
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e018f9cd_bc03853c",
        "filename": "components/signin/core/browser/signin_manager_base.cc",
        "patchSetId": 19
      },
      "lineNbr": 45,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "Mirror is more than just sending X-CHROME-CONNECTED header to Google origins - when Mirror is enabled, Chrome ensures account consistency between the browser and the web by continously monitoring the accounts in the Gaia cookies and in the token service and by pushing the accounts from the tokens to the cookies.\n\nIn this CL, only the part of passing the header to Gaia is implemented. Do you want to have full Mirror on (including account reconcilor)? If so, then make sure to create the mirror account reconcilor - see https://cs.chromium.org/chromium/src/chrome/browser/signin/account_reconcilor_factory.cc?rcl\u003d92f669180c3fa4c7190817870ead6155e12fcc78\u0026l\u003d75",
      "range": {
        "startLine": 45,
        "startChar": 32,
        "endLine": 45,
        "endChar": 66
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f93f12d0_a3e9a6ce",
        "filename": "components/signin/core/browser/signin_manager_base.cc",
        "patchSetId": 19
      },
      "lineNbr": 45,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "David: This pref is for Mirror. I would say it would make more sense to register it in https://cs.chromium.org/chromium/src/chrome/browser/signin/account_reconcilor_factory.cc?rcl\u003d92f669180c3fa4c7190817870ead6155e12fcc78\u0026l\u003d65",
      "range": {
        "startLine": 45,
        "startChar": 39,
        "endLine": 45,
        "endChar": 66
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ed0847b8_2363d014",
        "filename": "components/signin/core/browser/signin_pref_names.h",
        "patchSetId": 19
      },
      "lineNbr": 10,
      "author": {
        "id": 1115972
      },
      "writtenOn": "2017-11-20T10:23:38Z",
      "side": 1,
      "message": "s/kAccountConsistencyRequired/kAccountConsistencyMirrorRequired or kAccountConsistencyMirrorEnabled or kMirrorEnabled",
      "range": {
        "startLine": 10,
        "startChar": 18,
        "endLine": 10,
        "endChar": 45
      },
      "revId": "2d29c5d64600eb769f3e938bb2897efc7960bd26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}