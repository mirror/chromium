{
  "comments": [
    {
      "key": {
        "uuid": "fef9c62d_ad91175e",
        "filename": "content/browser/frame_host/render_frame_host_manager.cc",
        "patchSetId": 16
      },
      "lineNbr": 548,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-16T23:19:29Z",
      "side": 1,
      "message": "I\u0027m a bit surprised this CHECK got in your way, since you only call FrameTreeNode::CommitPendingFramePolicy from WebContentsImpl::CreateWithOpener, and this is RenderFrameHostManager::CommitPendingFramePolicy.  Can you share more about how you were hitting this CHECK?",
      "range": {
        "startLine": 547,
        "startChar": 0,
        "endLine": 548,
        "endChar": 11
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "39eaffd0_8b8f025d",
        "filename": "content/browser/frame_host/render_frame_host_manager.cc",
        "patchSetId": 16
      },
      "lineNbr": 548,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-19T18:28:43Z",
      "side": 1,
      "message": "Reverted this change, it wasn\u0027t necessary after all.",
      "parentUuid": "fef9c62d_ad91175e",
      "range": {
        "startLine": 547,
        "startChar": 0,
        "endLine": 548,
        "endChar": 11
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "03773e6f_73c0d745",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-16T23:19:29Z",
      "side": 1,
      "message": "What do you think about naming the new flag |starting_sandbox_flags| and making it a blink::WebSandboxFlags?   Then we can unify these two blocks, and only do the SetPendingSandboxFlags()/CommitPendingFramePolicy() once using that flag.  I.e., would the following work?\n\n1. Move the opener/inherit_flag logic to WebContentsImpl::CreateNewWindow, and use it to set |starting_sandbox_flags| when we create the CreateParams there.  \n\n2. OffscreenTab::Start would just set |starting_sandbox_flags| directly on its CreateParams.\n\n3. Also, it\u0027d be nice to not check kForcePresentationReceiverForTesting here if it\u0027s a layout-test-only flag (is it?).  Perhaps that can be done by setting starting_sandbox_flags, if needed, in CreateParams in Shell::CreateNewWindow?  Or does the use you care about not go through that?\n\n4. We just always do new_root-\u003eSetPendingSandboxFlags(params.starting_sandbox_flags); new_root-\u003eCommitPendingFramePolicy() here.",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee8e4009_5b806649",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-19T18:28:43Z",
      "side": 1,
      "message": "1,2,4: That was my original design but violates layering: OffscreenTab in chrome/ can\u0027t use WebSandboxFlags from Blink.\n\n3: Done.",
      "parentUuid": "03773e6f_73c0d745",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9636aa8e_487e51d5",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-19T21:36:35Z",
      "side": 1,
      "message": "It should be fine to use WebSandboxFlags in chrome/ since it\u0027s just an enum.  We\u0027ve got a whole bunch of other uses of things from third_party/WebKit/public/web in chrome/: https://cs.chromium.org/search/?q\u003d%22%23include+%5C%22third_party/WebKit/%22+file:chrome/\u0026p\u003d2\u0026sq\u003dpackage:chromium\u0026type\u003dcs.  Was there something that actually disallowed that when you tried it?",
      "parentUuid": "ee8e4009_5b806649",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "94a890c0_e08ccc29",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-19T22:01:51Z",
      "side": 1,
      "message": "Yes - it triggered a presubmit rule violation.  I think the relevant file is chrome/browser/DEPS.",
      "parentUuid": "9636aa8e_487e51d5",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ec514a4_1cde69e1",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-19T23:01:52Z",
      "side": 1,
      "message": "I think it\u0027s fine to just add WebSandboxFlags.h to the relevant section in that file:\n\n  # No inclusion of WebKit from the browser, other than strictly enum/POD,\n  # header-only types, and some selected common code.\n  ...\n\nbecause WebSandboxFlags is an enum and hence should be allowed.  (FWIW, I also sanity-checked this by dcheng@ and he agreed that this should be allowed.)",
      "parentUuid": "94a890c0_e08ccc29",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c091b15d_a283dc31",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-20T19:14:32Z",
      "side": 1,
      "message": "Okay, done.  (It\u0027s actually WebPresentationReceiverFlags, since those are the flags needed by OffscreenTab).",
      "parentUuid": "3ec514a4_1cde69e1",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0f78de78_6dbb7fdb",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-20T19:17:09Z",
      "side": 1,
      "message": "Note that I didn\u0027t move the opener flags logic up the stack to CreateNewWindow().  There are several code paths that call into CreateWithOpener(), including Create() and Clone(), so moving this code seemed too risky.",
      "parentUuid": "c091b15d_a283dc31",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fdd7f21d_57d87f57",
        "filename": "content/browser/web_contents/web_contents_impl.cc",
        "patchSetId": 16
      },
      "lineNbr": 711,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-20T21:26:35Z",
      "side": 1,
      "message": "Makes sense.  I can look into that in a followup.",
      "parentUuid": "0f78de78_6dbb7fdb",
      "range": {
        "startLine": 693,
        "startChar": 1,
        "endLine": 711,
        "endChar": 3
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ca831e21_8d94cf82",
        "filename": "content/public/browser/web_contents.h",
        "patchSetId": 16
      },
      "lineNbr": 177,
      "author": {
        "id": 1118209
      },
      "writtenOn": "2017-10-16T23:19:29Z",
      "side": 1,
      "message": "I think it might be useful to name this more generically, so that other features that might want to create a sandboxed tab can use it down the line.  It also will sound less out of place with the other params already here.  (More concrete proposal above.)",
      "range": {
        "startLine": 177,
        "startChar": 9,
        "endLine": 177,
        "endChar": 33
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dfadfc8c_46ae7c1c",
        "filename": "content/public/browser/web_contents.h",
        "patchSetId": 16
      },
      "lineNbr": 177,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-19T18:28:43Z",
      "side": 1,
      "message": "See comments above.",
      "parentUuid": "ca831e21_8d94cf82",
      "range": {
        "startLine": 177,
        "startChar": 9,
        "endLine": 177,
        "endChar": 33
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bbc3b7ff_e25307fe",
        "filename": "third_party/WebKit/public/web/WebSandboxFlags.h",
        "patchSetId": 16
      },
      "lineNbr": 31,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-16T21:21:53Z",
      "side": 1,
      "message": "Assuming these are no longer needed (I see no references), please revert.",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 31,
        "endChar": 43
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "17660378_ef93ddfa",
        "filename": "third_party/WebKit/public/web/WebSandboxFlags.h",
        "patchSetId": 16
      },
      "lineNbr": 31,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-19T18:28:43Z",
      "side": 1,
      "message": "These are to keep WebSandboxFlags.h in sync with SandboxFlags.h in core/dom:\n\nhttps://cs.chromium.org/chromium/src/third_party/WebKit/Source/core/dom/SandboxFlags.h\n\nIf you don\u0027t think this is necessary I can revert it.",
      "parentUuid": "bbc3b7ff_e25307fe",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 31,
        "endChar": 43
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ff2b6c1b_1ed0ca83",
        "filename": "third_party/WebKit/public/web/WebSandboxFlags.h",
        "patchSetId": 16
      },
      "lineNbr": 31,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-20T20:35:03Z",
      "side": 1,
      "message": "Hm, OK this is fine. However, it\u0027s surprising to me that WebPresentationFlags doesn\u0027t actually use kPresentation.",
      "parentUuid": "17660378_ef93ddfa",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 31,
        "endChar": 43
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "05bf5001_c5f4e166",
        "filename": "third_party/WebKit/public/web/WebSandboxFlags.h",
        "patchSetId": 16
      },
      "lineNbr": 31,
      "author": {
        "id": 1001982
      },
      "writtenOn": "2017-10-20T21:59:23Z",
      "side": 1,
      "message": "This flag controls whether a sandboxed frame can start/reconnect a presentation. The receiver flags control what the presented document can do.  Maybe I can rename to kPresentationController (to reflect how the spec talks about these cases) in a followup?",
      "parentUuid": "ff2b6c1b_1ed0ca83",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 31,
        "endChar": 43
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e47a5db_42def2cf",
        "filename": "third_party/WebKit/public/web/WebSandboxFlags.h",
        "patchSetId": 16
      },
      "lineNbr": 31,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-20T22:14:53Z",
      "side": 1,
      "message": "Sounds good to me.",
      "parentUuid": "05bf5001_c5f4e166",
      "range": {
        "startLine": 30,
        "startChar": 0,
        "endLine": 31,
        "endChar": 43
      },
      "revId": "5af182814a98bc73ef990cefeb1c126fad8b5d49",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}