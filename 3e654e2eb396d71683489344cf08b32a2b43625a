{
  "comments": [
    {
      "key": {
        "uuid": "c9f7fa85_7532609f",
        "filename": "ipc/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 189,
      "author": {
        "id": 1104639
      },
      "writtenOn": "2018-01-18T18:23:50Z",
      "side": 1,
      "message": "Could we make mojo/public/interfaces/bindings:bindings a component instead? That should also address this issue, right?\n\nI understand the current overridden_deps support is insufficient. But I hope we could limit the usage of overridden_deps to blink stuff and remove them eventually by splitting up the huge targets (such as blink platform) properly. Making it more powerful and using it in more places IMO is not the right direction.\n\nWDYT? Thanks!",
      "revId": "3e654e2eb396d71683489344cf08b32a2b43625a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8470951e_1808c82b",
        "filename": "ipc/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 189,
      "author": {
        "id": 1255169
      },
      "writtenOn": "2018-01-20T02:23:58Z",
      "side": 1,
      "message": "Even if //mojo/public/interfaces/bindings:bindings were a component I think that overridden_deps would still be needed here.\n\nipc:mojom needs to have a public dependency on whichever mojom target has \"native_struct\" as one of its sources (currently it\u0027s the mojom bindings:bindings target). If that target is part of a different component it would still need to be overridden.\n\nI definitely take your point about wanting to limit to the usage of overridden_deps though. This stuff\u0027s still new to me so if I\u0027ve misunderstood what you meant let me know! I\u0027m happy to change the bindings target if that\u0027s the right thing to do :)",
      "parentUuid": "c9f7fa85_7532609f",
      "revId": "3e654e2eb396d71683489344cf08b32a2b43625a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d928083d_e7244fcc",
        "filename": "ipc/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 189,
      "author": {
        "id": 1104639
      },
      "writtenOn": "2018-01-22T21:59:47Z",
      "side": 1,
      "message": "\"\"\"ipc:mojom needs to have a public dependency on whichever mojom target has \"native_struct\" as one of its sources (currently it\u0027s the mojom bindings:bindings target). If that target is part of a different component it would still need to be overridden.\"\"\"\n\nWhen we make //mojo/public/interfaces/bindings:bindings a separate component, it is no longer \"part of a different component\", right? Have you tried out making  //mojo/public/interfaces/bindings:bindings a mojom_component()?\n\nMaybe I haven\u0027t fully understood the problem here. If that is the case, please help me to better understand it. Thanks! :)",
      "parentUuid": "8470951e_1808c82b",
      "revId": "3e654e2eb396d71683489344cf08b32a2b43625a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "343ba733_313f97ac",
        "filename": "ipc/BUILD.gn",
        "patchSetId": 6
      },
      "lineNbr": 189,
      "author": {
        "id": 1255169
      },
      "writtenOn": "2018-01-23T05:10:08Z",
      "side": 1,
      "message": "Oops yeah you\u0027re right, sorry I misunderstood what your initial comment meant!\n\nI have tried making //mojo/public/interfaces/bindings:bindings it\u0027s own mojom_component. However, I came across a few problems when trying this approach.\n\n//mojo/public/interfaces/bindings:bindings seems very closely entwined with //src/mojo/public/cpp/bindings:bindings (for brevity, I\u0027ll call them interfaces/bindings and cpp/bindings respectively).\n\nOn the one hand, interfaces/bindings needs to depend on cpp/bindings (as defined in the mojom template - //src/mojo/public/tools/bindings/mojom.gni) because the generated files depend on portions of the bindings library.\n\nOn the other hand, cpp/bindings also depends on portions of interfaces/bindings. For example, it takes the generated CPP mojom files as part of its sources and depends on the intermediate targets interfaces/bindings:bindings__generator and interfaces/bindings:bindings_shared__generator.\n\nFor that reason, I\u0027m not sure that it\u0027s possible to break out interfaces/bindings into its own mojom component without introducing a dependency cycle where interfaces/bindings -\u003e cpp/bindings -\u003e interfaces/bindings...\n\nRemoving either dependency - removing the dependency on cpp/bindings from interfaces/bindings e.g. via a flag to the mojom template OR removing the generated files/intermediate targets created by interfaces/bindings from cpp/bindings - leads to undefined symbols and an angry linker :(\n\nI know that it\u0027s undesirable but I think that overridden_deps might be the right solution in this case.\n\nSorry for the long reply, I hope this all makes sense! I\u0027m happy to clarify anything via message or on this review :) Thanks so much for your time in looking at this!",
      "parentUuid": "d928083d_e7244fcc",
      "revId": "3e654e2eb396d71683489344cf08b32a2b43625a",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}