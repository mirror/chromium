{
  "comments": [
    {
      "key": {
        "uuid": "98e62f3f_c9ac3224",
        "filename": "third_party/WebKit/LayoutTests/TestExpectations",
        "patchSetId": 12
      },
      "lineNbr": 699,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-10T10:26:42Z",
      "side": 1,
      "message": "Why this fails? Could you explain briefly?",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fc77988_7b4ded77",
        "filename": "third_party/WebKit/LayoutTests/TestExpectations",
        "patchSetId": 12
      },
      "lineNbr": 699,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T02:30:17Z",
      "side": 1,
      "message": "It fails on this line https://chromium-review.googlesource.com/c/chromium/src/+/808446/12/third_party/WebKit/LayoutTests/external/wpt/shadow-dom/DocumentOrShadowRoot-prototype-elementFromPoint.html#95 (when shadow host\u0027s display is inline) and on the following line (line 96) when shadow\u0027s host display is block or inline-block.\nThe testcase scenario is we\u0027re calling elementFromPoint on document \u0026 shadowroot. The hit-tested text node is a fallback of a slot. Shadow host is \u003ctest-element\u003e and we tried testing 3 different display styles (inline, block, inline-block). All three of them failed.\n\nOn the first case (host display is inline), document.elementFromPoint returns the document element (it should\u0027ve returned the shadow host)\n\nOn the second \u0026 third case (host display is block \u0026 inline-block) shadowRoot.elementFromPoint returns the shadow host/test-element (it should\u0027ve returned the slot parent of the fallback text node)\n\n\nOutput:\nFAIL document.elementFromPoint must return the shadow host and shadowRoot.elementFromPoint must return the slot parent of the fallback text when the hit-tested text node is a fallback content and the host has display: inline assert_equals: expected Element node \u003ctest-element style\u003d\"display: inline;\"\u003e\u003c/test-element\u003e but got Element node \u003chtml\u003e\u003chead\u003e\n    \u003ctitle\u003eShadow DOM and CSSOM View: Docume...\nFAIL document.elementFromPoint must return the shadow host and shadowRoot.elementFromPoint must return the slot parent of the fallback text when the hit-tested text node is a fallback content and the host has display: block assert_equals: expected Element node \u003cslot\u003efallback\u003c/slot\u003e but got Element node \u003ctest-element style\u003d\"display: block;\"\u003e\u003c/test-element\u003e\nFAIL document.elementFromPoint must return the shadow host and shadowRoot.elementFromPoint must return the slot parent of the fallback text when the hit-tested text node is a fallback content and the host has display: inline-block assert_equals: expected Element node \u003cslot\u003efallback\u003c/slot\u003e but got Element node \u003ctest-element style\u003d\"display: inline-block;\"\u003e\u003c/test-element\u003e",
      "parentUuid": "98e62f3f_c9ac3224",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b11f866f_ca7dd621",
        "filename": "third_party/WebKit/LayoutTests/TestExpectations",
        "patchSetId": 12
      },
      "lineNbr": 699,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-11T03:39:14Z",
      "side": 1,
      "message": "I got it. Thanks. That sounds reasonable because incremental shadow dom doesn\u0027t support layout well yet.\n\nYour explanation would be helpful when I start to support layout in incremental shadow dom. Thanks!",
      "parentUuid": "9fc77988_7b4ded77",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "85fda3ab_59f16a44",
        "filename": "third_party/WebKit/LayoutTests/TestExpectations",
        "patchSetId": 12
      },
      "lineNbr": 699,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T04:01:07Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b11f866f_ca7dd621",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "60b45325_31660805",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 262,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-10T10:26:42Z",
      "side": 1,
      "message": "Is this correct?\nWhat happens if a text node is assigned to a slot?\nI think we shouldn\u0027t return a shadow host, which is a parent of a text node, in this case.",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "76f07ed9_1f976f88",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 262,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T02:30:17Z",
      "side": 1,
      "message": "When a text node is assigned to a slot, it is currently returning the shadow host (https://chromium-review.googlesource.com/c/chromium/src/+/808446/12/third_party/WebKit/LayoutTests/external/wpt/shadow-dom/DocumentOrShadowRoot-prototype-elementFromPoint.html#53)\n\nWhat should it return in that case?",
      "parentUuid": "60b45325_31660805",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c3c8732_5f9fed58",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 262,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-11T03:39:14Z",
      "side": 1,
      "message": "It should return a parent element in a flat tree. e.g. assigned slot (or its ancestor) in the shadow tree.\n\nI think this issue doesn\u0027t have to be addressed in this CL. You might ignore this issue for now.",
      "parentUuid": "76f07ed9_1f976f88",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2ea2a29b_ffe35d1a",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 262,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T04:01:07Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "0c3c8732_5f9fed58",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ee20f5af_d4811c9c",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 277,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-10T10:26:42Z",
      "side": 1,
      "message": "I\u0027m afraid that I couldn\u0027t understand what the comment mean clearly.\nCould you explain more details?",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3173095a_4172cc37",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 277,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T02:30:17Z",
      "side": 1,
      "message": "Sorry! So, in some cases when a text node is under a slot, rect_based_node.Get() won\u0027t return the slot even though it should be listed in the elementsFromPoint result. But, we can get the slot from the child text node (but the child text node itself shouldn\u0027t be in the list). The default action is to just skip any non-element nodes but in this case we shouldn\u0027t skip the text node.",
      "parentUuid": "ee20f5af_d4811c9c",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "184bdc4c_8f353c00",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 277,
      "author": {
        "id": 1115903
      },
      "writtenOn": "2018-01-11T03:39:14Z",
      "side": 1,
      "message": "Ack. Thanks. Maybe I have to think this more deeply when I try to add slot in a flat tree.\nFor now, this CL\u0027s approach could be enough.",
      "parentUuid": "3173095a_4172cc37",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc102cd8_d9893255",
        "filename": "third_party/WebKit/Source/core/dom/TreeScope.cpp",
        "patchSetId": 12
      },
      "lineNbr": 277,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-11T04:01:07Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "184bdc4c_8f353c00",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a1c5ded3_4f25d35d",
        "filename": "third_party/WebKit/Source/devtools/front_end/dom_extension/DOMExtension.js",
        "patchSetId": 12
      },
      "lineNbr": 758,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2018-01-11T17:11:24Z",
      "side": 1,
      "message": "This is going to break our old frontends deployed in the wild. What are the symptoms? Something breaks horribly, or a small issue?\n\nAlso, it\u0027s likely to break some webpages which do the same thing. WDYT? Should be worth an intent to at least raise awareness.",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "878e0cb8_ab3c0d73",
        "filename": "third_party/WebKit/Source/devtools/front_end/dom_extension/DOMExtension.js",
        "patchSetId": 12
      },
      "lineNbr": 758,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-12T00:59:44Z",
      "side": 1,
      "message": "Before I added this, this line of test fails: https://cs.chromium.org/chromium/src/third_party/WebKit/LayoutTests/http/tests/devtools/layers/layers-panel-mouse-events.js?l\u003d53 It\u0027s trapped in an infinite loop here. I think before this CL it\u0027s getting out of the loop when innerNode is null, but elementFromPoint isn\u0027t returning null anymore.\n\nCan you elaborate more on some things that may break? I\u0027m not really familiar with the usage of this method. Thanks!",
      "parentUuid": "a1c5ded3_4f25d35d",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "60e85819_d043aa02",
        "filename": "third_party/WebKit/Source/devtools/front_end/dom_extension/DOMExtension.js",
        "patchSetId": 12
      },
      "lineNbr": 758,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2018-01-16T15:09:31Z",
      "side": 1,
      "message": "I am a bit confused here. IIUC, |node.shadowRoot.elementFromPoint(x, y)| may return |node| as a result? Isn\u0027t it supposed to return a node from the shadow tree?",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "59c10d44_e42e4ba9",
        "filename": "third_party/WebKit/Source/devtools/front_end/dom_extension/DOMExtension.js",
        "patchSetId": 12
      },
      "lineNbr": 758,
      "author": {
        "id": 1247388
      },
      "writtenOn": "2018-01-17T08:05:44Z",
      "side": 1,
      "message": "Yes, it may return node/the shadow host. Some cases where this can happen is, for example, when there aren\u0027t any elements in the shadow tree (shadow root only, or just a text node). Other cases can be seen on https://chromium-review.googlesource.com/c/chromium/src/+/808446/12/third_party/WebKit/LayoutTests/external/wpt/shadow-dom/DocumentOrShadowRoot-prototype-elementFromPoint.html#57",
      "parentUuid": "60e85819_d043aa02",
      "revId": "018d878e2c78fda410ce38691c574f749fedade1",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}