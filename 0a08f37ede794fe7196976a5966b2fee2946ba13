{
  "comments": [
    {
      "key": {
        "uuid": "e7348570_9c581ae8",
        "filename": "content/browser/devtools/protocol/input_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 694,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2017-10-13T18:29:19Z",
      "side": 1,
      "message": "I don\u0027t think this is a right way to do it. We state in our protocol [1] that coordinates are in DIP, and this violates it. Also, I don\u0027t get how the new mode affects input, isn\u0027t it for rendering only?\n\n[1] https://cs.chromium.org/chromium/src/third_party/WebKit/Source/core/inspector/browser_protocol.json?rcl\u003d05d62532c8f1547464030cf32ba502e0f8429005\u0026l\u003d4304",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3545ee48_0ad8239c",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 708,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2017-10-13T18:29:19Z",
      "side": 1,
      "message": "Please help me understand this: is metadata.page_scale_factor bogus in the new mode? \nCould you provide example numbers of metadata fields and view size with/without this flag?\nBasically, I want to understand whether we should instead report different page scale factor to the client below.",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8abf6c15_8ddfea2f",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 708,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-13T18:42:39Z",
      "side": 1,
      "message": "\u003e Please help me understand this: is metadata.page_scale_factor bogus in the new mode? \n\u003e Could you provide example numbers of metadata fields and view size with/without this flag?\n\u003e Basically, I want to understand whether we should instead report different page scale factor to the client below.\n\nThe feature is \"device scale factor implemented as zoom, ie page scale\". So when the feature is enabled, page_scale_factor includes *both* device scale and page scale. value of device_scale_factor is not affected.\n\nSo let\u0027s say device scale \u003d 3, (the old concept of) page scale \u003d 2. Then when feature is not enabled:\ndevice_scale_factor \u003d 3, page_scale_factor \u003d 2,\nwhen feature is enabled:\ndevice_scale_factor \u003d 3, page_scale_factor \u003d 6\n\nSo this division converting back to (the old concept of) DIP.\n\n\nIt is kind of fuzzy which part of code has \"page scale factor\" converted to new behavior, which which part does not. I think roughly everything including and after blink is converted, so things like frame metadata has the new behavior. But browser sending things down to renderer have not been converted afaik (which is unforunate..)",
      "parentUuid": "3545ee48_0ad8239c",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1a74e3ae_d1295f33",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 708,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2017-10-13T18:54:24Z",
      "side": 1,
      "message": "Thanks for explanation. It would be nice to see this being cleaned up. I remember more changes like this one when it was introduced for ChromeOS, and this makes it really hard to reason about different scales anywhere, unfortunately. Are there any plans?\n\nMeanwhile, does it make sense to introduce helper methods on CompositorFrameMetadata and/or similar ones to not make every single client do a conditional conversion?",
      "parentUuid": "8abf6c15_8ddfea2f",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1edf2fe_9acc646c",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 708,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-13T19:15:31Z",
      "side": 1,
      "message": "\u003e Thanks for explanation. It would be nice to see this being cleaned up. I remember more changes like this one when it was introduced for ChromeOS, and this makes it really hard to reason about different scales anywhere, unfortunately. Are there any plans?\n\nThis is that chrome os feature. I *think* it\u0027s enabled on desktop already, or at least behind experiments, but not enabled on android yet. This is just trying to turn it on for android as well, so fixing android-only things that are broken.\n\n\u003e Meanwhile, does it make sense to introduce helper methods on CompositorFrameMetadata and/or similar ones to not make every single client do a conditional conversion?\n\nI don\u0027t know if there\u0027s any plan to convert the remaining bits of \"page scale\". Ideally I would like to see at least everything content and below converted, and just get rid of the DIP concept entirely, but not sure that actually works with all features, and if it\u0027s worth the effort..\n\nRegarding helper methods on Metadata. grepping around for existing IsUseZoomForDSFEnabled uses, there aren\u0027t that many that actually applies to Metadata. A lot of it has to do with scroll and whatnot. So that doesn\u0027t actually help much with anything",
      "parentUuid": "1a74e3ae_d1295f33",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "be5b22e0_693ba5e1",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 791,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2017-10-13T18:29:19Z",
      "side": 1,
      "message": "Here is a page scale factor we send to the client. Does it differ with a flag? Should we instead send a different number here?",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b3ca3ef_63958e15",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 791,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-13T18:42:39Z",
      "side": 1,
      "message": "\u003e Here is a page scale factor we send to the client. Does it differ with a flag? Should we instead send a different number here?\n\nHmm, you are right. This looks like everything is scaled to physical pixels.",
      "parentUuid": "be5b22e0_693ba5e1",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "73b53175_5ad0ee0b",
        "filename": "content/browser/devtools/protocol/page_handler.cc",
        "patchSetId": 5
      },
      "lineNbr": 791,
      "author": {
        "id": 1000379
      },
      "writtenOn": "2017-10-13T18:54:24Z",
      "side": 1,
      "message": "Then we should adjust here and undo the input_handler change.",
      "parentUuid": "4b3ca3ef_63958e15",
      "revId": "0a08f37ede794fe7196976a5966b2fee2946ba13",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}