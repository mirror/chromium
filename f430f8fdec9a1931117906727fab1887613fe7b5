{
  "comments": [
    {
      "key": {
        "uuid": "7bb27d7a_96a5bb03",
        "filename": "components/offline_pages/core/offline_page_metadata_store_sql.cc",
        "patchSetId": 3
      },
      "lineNbr": 663,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-11-30T19:51:16Z",
      "side": 1,
      "message": "The comment above means `db_.reset()` goes here right?\n\nAlso here would be where we would store a timestamp for the \"time until reopen\" UMA.",
      "revId": "f430f8fdec9a1931117906727fab1887613fe7b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "500c52c1_3a77136b",
        "filename": "components/offline_pages/core/offline_page_metadata_store_sql.cc",
        "patchSetId": 3
      },
      "lineNbr": 663,
      "author": {
        "id": 1002911
      },
      "writtenOn": "2017-12-01T06:06:29Z",
      "side": 1,
      "message": "You see, by the magic of unique_ptr I don\u0027t have to do anything, hence the comment.\n\nAlso look at line 657, specifically std::move(db_), which I believe should dispose of db_.",
      "parentUuid": "7bb27d7a_96a5bb03",
      "revId": "f430f8fdec9a1931117906727fab1887613fe7b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9d71d9fb_34a15664",
        "filename": "components/offline_pages/core/offline_page_metadata_store_sql.cc",
        "patchSetId": 3
      },
      "lineNbr": 663,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-12-01T07:00:55Z",
      "side": 1,
      "message": "That is neat but hard to follow. A call to reset() would make it easier to understand what\u0027s going on.\n\nAnd why moving the db_ pointer out of the instance member already at CloseInternal? Why not just leave it in place until this call happens and reset() it here?",
      "parentUuid": "500c52c1_3a77136b",
      "revId": "f430f8fdec9a1931117906727fab1887613fe7b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "81bfdab0_24744445",
        "filename": "components/offline_pages/core/offline_page_metadata_store_sql.cc",
        "patchSetId": 3
      },
      "lineNbr": 663,
      "author": {
        "id": 1002911
      },
      "writtenOn": "2017-12-01T19:22:10Z",
      "side": 1,
      "message": "I added an explicit reset of db.\nI want to clean the db_ pointer so that it is not reset accidentally when we are using *db on the IO thread. This could happen of we accidentally call Execute, or destroy the store.\nThis way is safer from memory management perspective.\nThe only problem we might have here is tearing down the threads starting from UI.",
      "parentUuid": "9d71d9fb_34a15664",
      "revId": "f430f8fdec9a1931117906727fab1887613fe7b5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}