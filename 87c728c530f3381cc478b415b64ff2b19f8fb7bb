{
  "comments": [
    {
      "key": {
        "uuid": "8bcee9b1_cfc3e357",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-07-06T22:44:09Z",
      "side": 1,
      "message": "Destroy it in TearDown() then like https://chromium-review.googlesource.com/c/562216/17/components/viz/test/viz_test_suite.cc",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a556f3ea_dc638897",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1000111
      },
      "writtenOn": "2017-07-07T02:31:11Z",
      "side": 1,
      "message": "Quick check: can you use a base::test::ScopedTaskEnvironment instead?",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "40b0fdb3_533dd4a4",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1146978
      },
      "writtenOn": "2017-07-07T13:59:18Z",
      "side": 1,
      "message": "danakj: Sure I can destroy it explicitly. The reason I changed it to unique_ptr\u003c\u003e is because in component builds (static builds work fine) it complains !base::MessageLoop::current() after the test process forks. Something to do with how the thread local storage of the singleton is copied between processes I guess? I don\u0027t think the parent process gets far enough to call Initialize() so this doesn\u0027t cause problems.\n\nsadrul: I don\u0027t think that would work? At least, it would be the same as a MessageLoop, since the test would have no way of accessing the ScopedTaskEnvironment?",
      "parentUuid": "a556f3ea_dc638897",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50d51a0c_057d791b",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1146978
      },
      "writtenOn": "2017-07-07T14:43:21Z",
      "side": 1,
      "message": "Hmm, on second thought, maybe this part of the change should be deferred to a follow up CL. I\u0027ll just add the tests to viz_unittests and not have the TestSuite touch a MessageLoop. That will make this change more mechanical.",
      "parentUuid": "40b0fdb3_533dd4a4",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6deae419_f231cbdf",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-07-07T15:29:56Z",
      "side": 1,
      "message": "That\u0027s fine too. I had copied your changes into my CL so they\u0027d disappear. Then can just stay then.",
      "parentUuid": "50d51a0c_057d791b",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e56a359a_fca87d0d",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-07-07T15:31:00Z",
      "side": 1,
      "message": "Maybe use components/test/\u0027s TestSuite for now then if you do that?",
      "parentUuid": "6deae419_f231cbdf",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b6b1ce94_deaaaeb0",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1146978
      },
      "writtenOn": "2017-07-07T15:34:29Z",
      "side": 1,
      "message": "If you\u0027re going to make the change to add MessageLoop in a follow up then I\u0027ll leave this? Otherwise I could use it.",
      "parentUuid": "e56a359a_fca87d0d",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "81af3074_52025044",
        "filename": "components/viz/run_all_unittests.cc",
        "patchSetId": 7
      },
      "lineNbr": 28,
      "author": {
        "id": 1000887
      },
      "writtenOn": "2017-07-07T15:45:46Z",
      "side": 1,
      "message": "TBH it\u0027s easier for me if you remove it here, cuz I put it in viz/test so I\u0027d have to delete code. I mean it\u0027s trivial either way just this isn\u0027t helping me out I guess.",
      "parentUuid": "b6b1ce94_deaaaeb0",
      "revId": "87c728c530f3381cc478b415b64ff2b19f8fb7bb",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}