{
  "comments": [
    {
      "key": {
        "uuid": "57c60454_fb78e6de",
        "filename": "components/offline_pages/core/prefetch/prefetch_types.h",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-25T21:41:03Z",
      "side": 1,
      "message": "I wouldn\u0027t assume the user did it.",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "78c39122_38f3d605",
        "filename": "components/offline_pages/core/prefetch/prefetch_types.h",
        "patchSetId": 2
      },
      "lineNbr": 144,
      "author": {
        "id": 1002546
      },
      "writtenOn": "2017-08-26T01:06:37Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "57c60454_fb78e6de",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b5f32bc3_3becbc49",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-25T21:41:03Z",
      "side": 1,
      "message": "These two statements could be consolidated like this:\nUPDATE prefetch_items\nSET state \u003d ?,\n    error_code \u003d CASE WHEN freshness_time \u003e ? THEN ?\n                      WHEN freshness_time \u003c ? THEN ?\n                      ELSE ? END\n    WHERE state \u003d ? AND freshness_time NOT BETWEEN ? AND ?\n\nThis would decrease our table scans by 1. WDYT? (+carlosk for opinion)",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "21582311_d4453bc8",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 63,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-26T00:01:00Z",
      "side": 1,
      "message": "These queries\u0027 executions are indeed multiplied by the number of expirable states. But given the added complexity and that this task will run at most every 15 minutes I don\u0027t the cost/benefit is worth it.\n\nI talked with dewittj@ offline: let\u0027s keep them separate.",
      "parentUuid": "b5f32bc3_3becbc49",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b2223dc5_5f50f6f4",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-25T21:41:03Z",
      "side": 1,
      "message": "How did you decide to use this?",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5c625f3b_79ba0caf",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-26T00:01:00Z",
      "side": 1,
      "message": "My initial thought was that we\u0027d use a fixed period of a day more or less.",
      "parentUuid": "b2223dc5_5f50f6f4",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "91c8e2fc_87bf19a2",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1002546
      },
      "writtenOn": "2017-08-26T01:06:37Z",
      "side": 1,
      "message": "My initial thought was also to use a day, but when I saw this, it seemed better.  It would give something in the downloading state a bit more grace to compensate for the fact that we normally give downloads two days to complete.",
      "parentUuid": "5c625f3b_79ba0caf",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "54a176b3_6d9ba464",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-29T20:28:13Z",
      "side": 1,
      "message": "I think the simpler, fixed value would make this code easier to reason about. Also by using that method there\u0027s a mix of two concerns that seem separate to me: regular pipeline expiration versus dealing with extraordinary clock changes.",
      "parentUuid": "91c8e2fc_87bf19a2",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "899c2204_820fa6d6",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-29T20:34:56Z",
      "side": 1,
      "message": "I agree, let\u0027s just use a value that would make sense for any state (this is only repair code, doesn\u0027t need to be hyper-optimized).  3d?",
      "parentUuid": "54a176b3_6d9ba464",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c49e52f3_c57d0357",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-29T20:45:17Z",
      "side": 1,
      "message": "Setting it to 3 days would mean that entries are allowed to live for 3 days + normal expiration period \u003d 4 to 5 days (depending on bucket). That seems like a lot to me, especially as we\u0027re not doing this only for entries in the DOWNLOADING state.\n\nI\u0027d still vouch for a shorter time, like 1 day (which gives a max entry lifetime of 2 to 3 days).",
      "parentUuid": "899c2204_820fa6d6",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b9a0abb_9d190193",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 84,
      "author": {
        "id": 1002546
      },
      "writtenOn": "2017-08-29T23:40:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c49e52f3_c57d0357",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f75b80c3_0b68ffb8",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 88,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-25T21:41:03Z",
      "side": 1,
      "message": "To me, \u0027clock skew\u0027 means tracking error more than arbitrary clock changes.  So perhaps a code like CLOCK_ADJUSTMENT_DETECTED ?",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a13498a0_e37cebb1",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 88,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-26T00:01:00Z",
      "side": 1,
      "message": "Any name is fine but I\u0027d suggest the name should somehow indicate the clock was _significantly_ adjusted _back_ in time.",
      "parentUuid": "f75b80c3_0b68ffb8",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc764e91_edf34db4",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task.cc",
        "patchSetId": 2
      },
      "lineNbr": 88,
      "author": {
        "id": 1002546
      },
      "writtenOn": "2017-08-26T01:06:37Z",
      "side": 1,
      "message": "Accepted Carlos\u0027s suggestion of adding the word \"BACKWARDS\"",
      "parentUuid": "a13498a0_e37cebb1",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d08e27bf_80cc6e86",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1002700
      },
      "writtenOn": "2017-08-25T21:41:03Z",
      "side": 1,
      "message": "I\u0027d prefer to change the previous method to accept a TimeDelta instead of int.  Then you can provide whatever delta you prefer.",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "71deb96f_1fe28830",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1134722
      },
      "writtenOn": "2017-08-26T00:01:00Z",
      "side": 1,
      "message": "The previous method can reused as is because TimeDelta::From* calls do accept negative numbers. I\u0027d suggest renaming the parameter to |time_delta_in_hours| switching - to + and updating existing code as needed.\n\nAlso, having to create a new TimeDelta for every call adds a lot of cruft to this test file.",
      "parentUuid": "d08e27bf_80cc6e86",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fe3116e4_cf38a583",
        "filename": "components/offline_pages/core/prefetch/stale_entry_finalizer_task_unittest.cc",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1002546
      },
      "writtenOn": "2017-08-26T01:06:37Z",
      "side": 1,
      "message": "Took Carlos\u0027s suggestion.",
      "parentUuid": "71deb96f_1fe28830",
      "revId": "e243d05b20bb80db21ae93fd44ce1e72560e321f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}