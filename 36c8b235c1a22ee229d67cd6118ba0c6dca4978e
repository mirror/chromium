{
  "comments": [
    {
      "key": {
        "uuid": "196fba08_0aae9882",
        "filename": "components/arc/video_accelerator/gpu_arc_video_decode_accelerator.h",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T04:18:07Z",
      "side": 1,
      "message": "If shared_ptr is here, doesn\u0027t it mean PBM still exist even PBA is destroyed? so DeallocateAllProctectedBuffers() is not called.\n\nBut all protected buffers should be released when PBA is destroyed. (GAVDA already decoupled buffer (de)allocation)",
      "range": {
        "startLine": 147,
        "startChar": 2,
        "endLine": 147,
        "endChar": 17
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8742ab8e_659ef5de",
        "filename": "components/arc/video_accelerator/gpu_arc_video_decode_accelerator.h",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1196199
      },
      "writtenOn": "2018-01-29T04:48:54Z",
      "side": 1,
      "message": "I get rid of this pointer.\nInstead, GAVDA tries to get PBM shared_pointer by using GetInstance() all the time PBM is needed.",
      "parentUuid": "196fba08_0aae9882",
      "range": {
        "startLine": 147,
        "startChar": 2,
        "endLine": 147,
        "endChar": 17
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "65c7ce6d_494194fe",
        "filename": "components/arc/video_accelerator/gpu_arc_video_decode_accelerator.h",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T07:12:42Z",
      "side": 1,
      "message": "sgtm",
      "parentUuid": "8742ab8e_659ef5de",
      "range": {
        "startLine": 147,
        "startChar": 2,
        "endLine": 147,
        "endChar": 17
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9091c292_ffc4c1af",
        "filename": "components/arc/video_accelerator/gpu_arc_video_decode_accelerator.h",
        "patchSetId": 1
      },
      "lineNbr": 147,
      "author": {
        "id": 1196199
      },
      "writtenOn": "2018-01-29T07:34:03Z",
      "side": 1,
      "message": "\u003e Instead, GAVDA tries to get PBM shared_pointer by using GetInstance() all the time PBM is needed.\n\ns/shared_pointer/raw pointer/ in the patch 2.",
      "parentUuid": "65c7ce6d_494194fe",
      "range": {
        "startLine": 147,
        "startChar": 2,
        "endLine": 147,
        "endChar": 17
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8c6224c2_224d1cde",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T04:18:07Z",
      "side": 1,
      "message": "This is reasonable, but I\u0027m afraid you may need to change much more GPU side codes in addition of this.\n\nAFAIK, PBM right now is created by chrome_content_gpu_client, and which is already a single instance of chrome_content_gpu_client. You will need to change chrome_content_gpu_client a lot as well.\nhttps://cs.chromium.org/chromium/src/chrome/gpu/chrome_content_gpu_client.cc\n\nAnother issue is, we could not guarantee the order of GPU side creating GAVDA or PBA or PBMProxy, but all of them needs the reference of PBM (so right now in chrome_content_gpu_client, PBM is first created and live until chrome_content_gpu_client is destroyed)",
      "range": {
        "startLine": 21,
        "startChar": 3,
        "endLine": 21,
        "endChar": 66
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2c0ba3d_999fbd10",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1196199
      },
      "writtenOn": "2018-01-29T04:48:54Z",
      "side": 1,
      "message": "Yes. We need to change the codes a lot.\nIn the new design, PBM will never created by its constructor, and instead created by Create().\n\nCreate() must be called by PBA.\nGetInstance() must be called by GAVDA and PBMProxy all the time PBM is required.\nGetInstance() returns nullptr if there is an active PBM, which is created by Create().\nThese guarantee that one PBM which is created by PBA exists if it is needed in GAVDA and PBMProxy.",
      "parentUuid": "8c6224c2_224d1cde",
      "range": {
        "startLine": 21,
        "startChar": 3,
        "endLine": 21,
        "endChar": 66
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8e5197a_f84f5f8e",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T07:12:42Z",
      "side": 1,
      "message": "Ack, sgtm",
      "parentUuid": "e2c0ba3d_999fbd10",
      "range": {
        "startLine": 21,
        "startChar": 3,
        "endLine": 21,
        "endChar": 66
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0795f6cb_cfc98e75",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T04:18:07Z",
      "side": 1,
      "message": "As above, there may be the case GAVDA is created earlier than PBA.",
      "range": {
        "startLine": 35,
        "startChar": 2,
        "endLine": 35,
        "endChar": 64
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7b3f5174_93c36150",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1196199
      },
      "writtenOn": "2018-01-29T04:48:54Z",
      "side": 1,
      "message": "Returns nullptr if there is no active PBM.",
      "parentUuid": "0795f6cb_cfc98e75",
      "range": {
        "startLine": 35,
        "startChar": 2,
        "endLine": 35,
        "endChar": 64
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "77dabf92_1ee4223c",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1112716
      },
      "writtenOn": "2018-01-29T07:12:42Z",
      "side": 1,
      "message": "So it should not return shared_ptr because no one should own PBM except PBA, maybe just return ProtectedtBufferManager*",
      "parentUuid": "7b3f5174_93c36150",
      "range": {
        "startLine": 35,
        "startChar": 2,
        "endLine": 35,
        "endChar": 64
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c3e57e6e_534bc5b8",
        "filename": "components/arc/video_accelerator/protected_buffer_manager.h",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1196199
      },
      "writtenOn": "2018-01-29T07:32:05Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "77dabf92_1ee4223c",
      "range": {
        "startLine": 35,
        "startChar": 2,
        "endLine": 35,
        "endChar": 64
      },
      "revId": "36c8b235c1a22ee229d67cd6118ba0c6dca4978e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}