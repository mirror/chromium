{
  "comments": [
    {
      "key": {
        "uuid": "bab8d1ce_0ab0f853",
        "filename": "content/common/media/renderer_audio_input_stream_factory.mojom",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "It\u0027s a bit awkward that there\u0027s |shared_memory_count| when creating the stream and also a |segment_count| in the response. I\u0027ll have a look at if it\u0027s really needed later.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9311c923_08a0ac31",
        "filename": "content/common/media/renderer_audio_input_stream_factory.mojom",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:49:46Z",
      "side": 1,
      "message": "Looks like it\u0027s just echoed, so it\u0027s probably possible to get rid of segment_count in the response.",
      "parentUuid": "bab8d1ce_0ab0f853",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7cea632b_3e6028cc",
        "filename": "content/common/media/renderer_audio_input_stream_factory.mojom",
        "patchSetId": 1
      },
      "lineNbr": 21,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9311c923_08a0ac31",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "efcf8650_14f508d1",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "nit: Move the callback.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a99abac0_5ae5c110",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "Sure thing!",
      "parentUuid": "efcf8650_14f508d1",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb277938_14f0a2c5",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 15,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a99abac0_5ae5c110",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7f02e48f_1b6c9f98",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "I\u0027m not a fan of the FactoryAccessor since it requires the factory to already exist. Instead, I\u0027d take a frame_id in the constructor, and post a task to the main thread from here. On the main thread, you could call something like RenderFrame::FromRoutingId(frame_id)-\u003eGetAudioInputStreamFactory(), which returns a lazily initialized factory*, and use that.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "844e5eac_39f7d189",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "That\u0027s not _strictly_ true though, is it? Couldn\u0027t the accessor create the factory for the frame if it didn\u0027t already exist? Regardless, I\u0027ll do as you suggest instead. It\u0027s a bit neater than having to send around a callback.",
      "parentUuid": "7f02e48f_1b6c9f98",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b614d63_62c25c4c",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T14:12:05Z",
      "side": 1,
      "message": "The accessor could create the factory, but to do it synchronously it would have to be called on the main thread, and we probably don\u0027t want this class to live completely on the main thread. On the other hand, I guess the callback makes it easier to inject a factory for testing.\n\nMaybe this class could have a CreateStream callback, and post that to the main thread. That way, it doesn\u0027t have to care about factories or RenderFrames, which will make it easier to test.",
      "parentUuid": "844e5eac_39f7d189",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9e4b9792_1e9d32f0",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 30,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "I went with the last proposal. It\u0027s a bit messy but, as you say, it\u0027ll make testing easier than having to mock a bunch of surrounding classes.",
      "parentUuid": "2b614d63_62c25c4c",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43ab5628_bfa958ae",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "This Unretained doesn\u0027t look safe to me, since |factory| may outlive |this|. Should also be BindOnce.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25603e4c_2aadaa88",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "Should I use a WeakPtr to this instead (like for the authorization callback for the output) or have it somehow hold on to this while there\u0027s a CreateStream request in flight?",
      "parentUuid": "43ab5628_bfa958ae",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c2375d9c_aad5465d",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T14:12:05Z",
      "side": 1,
      "message": "WeakPtr seems like the simplest, unless you have a better idea.",
      "parentUuid": "25603e4c_2aadaa88",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "246ad94f_27a3a30e",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 43,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c2375d9c_aad5465d",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b1afc47b_8404ff83",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "I\u0027d also set this error handler for |client_binding_|.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbb391d0_b5290abc",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "Alright!",
      "parentUuid": "b1afc47b_8404ff83",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b9150f76_1f39df2a",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cbb391d0_b5290abc",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ea6081de_a44b2e10",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 83,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T09:36:04Z",
      "side": 1,
      "message": "I\u0027m going to take a guess and say length should just not be its own parameter.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca65e6b9_e6508863",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 83,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "It would be great if |length| could be eliminated. Just make sure there aren\u0027t any differences (e.g. requested length vs actual length), or that the users of this AudioInputIPC can deal with any differences.",
      "parentUuid": "ea6081de_a44b2e10",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2189e351_23ffde81",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 83,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "I think the audio backend code is written to adjust for any discrepancies between the requested buffer size and the actual hardware buffer size. So is memory_length here expected to be length * segment_count?)",
      "parentUuid": "ca65e6b9_e6508863",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "25604a19_aca16785",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 83,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T14:12:05Z",
      "side": 1,
      "message": "length is expected to be memory_length, the reason length is a separate parameter is that the old IPC system didn\u0027t bundle the handle and the length. The only thing I\u0027m worried about is that base::SharedMemory (https://cs.chromium.org/chromium/src/base/memory/shared_memory.h?l\u003d178) has both requested_size and mapped_size, so I guess it\u0027s possible for memory_length to be greater then length, at least in theory. I think the best thing to do is to just make sure that AudioInputDevice and friends can handle if the length is larger than expected.",
      "parentUuid": "2189e351_23ffde81",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "70b9de7f_074fede7",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 83,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "With your latest changes to IPC parameters, I\u0027ve just removed length _and_ memory_length.",
      "parentUuid": "25604a19_aca16785",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1feb52ab_25ae48b9",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 97,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T09:36:04Z",
      "side": 1,
      "message": "I expect this will happen on the correct thread - AudioMessageFilter needs an explicit io_task_runner while MojoAudioOutputIPC doesn\u0027t - but I\u0027m not 100% sure.",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "402247a3_f59e2b76",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 97,
      "author": {
        "id": 1201454
      },
      "writtenOn": "2017-07-21T11:03:39Z",
      "side": 1,
      "message": "This will be called on the thread on which you bound |client_binding_|, so this is fine.",
      "parentUuid": "1feb52ab_25ae48b9",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2df87c14_8e82069f",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 97,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-07-21T13:20:58Z",
      "side": 1,
      "message": "Hooray! \\o/",
      "parentUuid": "402247a3_f59e2b76",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c6ee8291_7aa3edb2",
        "filename": "content/renderer/media/mojo_audio_input_ipc.cc",
        "patchSetId": 1
      },
      "lineNbr": 97,
      "author": {
        "id": 1210379
      },
      "writtenOn": "2017-09-04T15:02:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "2df87c14_8e82069f",
      "revId": "5bb301d13b796bbfde8d8e82fa1e3cdbaac81b3b",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}