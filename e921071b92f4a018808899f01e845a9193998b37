{
  "comments": [
    {
      "key": {
        "uuid": "e87e6887_1e351fb0",
        "filename": "media/gpu/android/codec_wrapper.h",
        "patchSetId": 2
      },
      "lineNbr": 106,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "fairly easy unit test for \"this calls the bridge\" and \"SurfaceBundle() returns new surface bundle after it returns\".",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e0788bc4_b58e83bb",
        "filename": "media/gpu/android/codec_wrapper.h",
        "patchSetId": 2
      },
      "lineNbr": 109,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "easy unit test for \u003d\u003d constructor arg.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36438861_1928018f",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 266,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "you might want to add a comment that we might have codec allocation in-flight using |overlay|, since it\u0027s not obvious that it\u0027s handled elsewhere unless one is familiar with the whole thing already.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "861b5185_f4e67d48",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 293,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-08T08:13:10Z",
      "side": 1,
      "message": "I\u0027m not a fan of the shared, mutable, CodeConfig so in this CL it\u0027s no longer shared.",
      "range": {
        "startLine": 293,
        "startChar": 42,
        "endLine": 293,
        "endChar": 53
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2545193c_7b281971",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 293,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "861b5185_f4e67d48",
      "range": {
        "startLine": 293,
        "startChar": 42,
        "endLine": 293,
        "endChar": 53
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e360b2f_8839974d",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 361,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "the old one would still get a codec if the release never completes, while the new one won\u0027t.  no idea which one is better.  the case i\u0027m wondering about is if the hw thread hangs after |codec_| is created, and the hang is detected by now.  then, CreateCodec() would magically switch to SW, though risk re-using the surface concurrently.  i think either choice is as good as the other given what we know.\n\nperhaps all we need are some uma stats for \"# times started codec release\" and \"# times finished codec release\", and maybe \"# times started codec release and we detected a thread hang already on the thread we\u0027re posting to\".  then, at least, we can verify if we\u0027ve chosen the heuristic that fails more often.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b0a216d9_7314c7de",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 361,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-11T07:49:43Z",
      "side": 1,
      "message": "True. Well if we haven\u0027t been getting crashes due to doing it the old way I\u0027m fine to leave it that way.\n\nTested on my device: second codec fails with an error. This is probably preferable because the user can click play and retry. If we wait for the release to complete, the playback will hang but not error.",
      "parentUuid": "0e360b2f_8839974d",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b8b11ef3_34b23a00",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 403,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-08T08:13:10Z",
      "side": 1,
      "message": "Having a codec_ is the only thing we really care about. The terminal states now imply that codec_ is null and stays null. kInitializing is before we create a codec.",
      "range": {
        "startLine": 403,
        "startChar": 7,
        "endLine": 403,
        "endChar": 13
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6b973763_109b0613",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 403,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "yeah, that makes sense.",
      "parentUuid": "b8b11ef3_34b23a00",
      "range": {
        "startLine": 403,
        "startChar": 7,
        "endLine": 403,
        "endChar": 13
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b28a338b_2543f28a",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 613,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-08T08:13:10Z",
      "side": 1,
      "message": "I should add a DCHECK that if codec_ is null, then released_cb is also null.",
      "range": {
        "startLine": 613,
        "startChar": 62,
        "endLine": 613,
        "endChar": 73
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22b064ea_79c155c5",
        "filename": "media/gpu/android/media_codec_video_decoder.cc",
        "patchSetId": 2
      },
      "lineNbr": 613,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "yes!  :)",
      "parentUuid": "b28a338b_2543f28a",
      "range": {
        "startLine": 613,
        "startChar": 62,
        "endLine": 613,
        "endChar": 73
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9fb0f38e_caba03eb",
        "filename": "media/gpu/android/media_codec_video_decoder.h",
        "patchSetId": 2
      },
      "lineNbr": 116,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "this comment and the name are a little ambiguous about whether it\u0027s \"is\" or \"we should switch to\".  \"should be\" doesn\u0027t quite make it clear that there\u0027s a difference unless one already knows that.\n\nthe name is also somewhat ambiguous, but i don\u0027t have a better idea.  \"incoming\" doesn\u0027t make sense now that it\u0027s potentially \"current\" as well.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "893f0d17_f69a7b01",
        "filename": "media/gpu/android/media_codec_video_decoder.h",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-08T08:13:10Z",
      "side": 1,
      "message": "Threading the surface_bundle all the way through lets us check whether the target surface has changed since we called CreateCodec.",
      "range": {
        "startLine": 132,
        "startChar": 39,
        "endLine": 132,
        "endChar": 53
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a6dc4371_f6b3cc40",
        "filename": "media/gpu/android/media_codec_video_decoder.h",
        "patchSetId": 2
      },
      "lineNbr": 132,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "true, though i\u0027m unsure if that helps the \"SurfaceDestroyed while codec allocation is pending\" case.  it might, now that we\u0027re not using CVV and holding the overlay is enough to keep surfaceDestroyed from returning in java.",
      "parentUuid": "893f0d17_f69a7b01",
      "range": {
        "startLine": 132,
        "startChar": 39,
        "endLine": 132,
        "endChar": 53
      },
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33694016_4abb224d",
        "filename": "media/gpu/android/media_codec_video_decoder.h",
        "patchSetId": 2
      },
      "lineNbr": 214,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "not sure that this shouldn\u0027t be called |target_bundle_| and sometimes \u003d\u003d |surface_texture_bundle_|.  seems like it\u0027s used in that fashion everywhere.  however, it does means aliasing between them when using a surface texture, which i realize you tend to dislike.  :)\n\nhowever, |surface_texture_bundle_| is pretty much a hack.  |target_bundle_| seems like the state we\u0027d really want to keep if we could just make new ST\u0027s any time we like.  this would isolate use of |surface_texture_bundle_| to OnSurfaceChosen().  nobody else would have to remember that we keep one of these things around, including the release cases, since we\u0027d still have a ref to it.\n\npractically, that would remove all the null checks, and the conditional in TargetSurface().  you\u0027d have to initialize |target_bundle_| to |surface_texture_bundle_| before OnSurfaceChosen, maybe, to avoid all the null checks.  maybe not.  might actually not call anything then.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "58186875_e9dd42f0",
        "filename": "media/gpu/android/media_codec_video_decoder.h",
        "patchSetId": 2
      },
      "lineNbr": 214,
      "author": {
        "id": 1119171
      },
      "writtenOn": "2017-09-11T07:49:43Z",
      "side": 1,
      "message": "Ok, yeah, that sounds good! Will do.",
      "parentUuid": "33694016_4abb224d",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42436c27_e9581cae",
        "filename": "media/gpu/avda_codec_allocator.cc",
        "patchSetId": 2
      },
      "lineNbr": 299,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "might want to comment that it\u0027s okay if |pending_codec_releases_| does not contain the overlay.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0675d306_3a1a38cc",
        "filename": "media/gpu/avda_codec_allocator.h",
        "patchSetId": 2
      },
      "lineNbr": 140,
      "author": {
        "id": 1130490
      },
      "writtenOn": "2017-09-08T14:41:50Z",
      "side": 1,
      "message": "this seems like a thing for a unit test.",
      "revId": "e921071b92f4a018808899f01e845a9193998b37",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}