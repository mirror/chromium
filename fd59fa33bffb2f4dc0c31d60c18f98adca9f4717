{
  "comments": [
    {
      "key": {
        "uuid": "08d1977f_5b2c0640",
        "filename": "third_party/WebKit/Source/core/paint/PaintLayerPainter.cpp",
        "patchSetId": 12
      },
      "lineNbr": 612,
      "author": {
        "id": 1110037
      },
      "writtenOn": "2017-11-09T19:10:39Z",
      "side": 1,
      "message": "This is complicated and it would be nice to avoid it if possible.\n\nIsn\u0027t this a general problem when trying to slice up a display list into chunks?\n[display item bg][display item child][display item fg]\n-\u003e\n[chunk A.1][chunk B][chunk A.2]\n\nCurrently, ScopedPaintChunkProperties resets the chunk id to null after chunk B. What if we changed the chunk id to be: {display item id, chunk index} and just incremented the index after chunk B goes out of scope?\n\nAlternatively, is it possible to just introduce different chunks? One for the foreground and a different one for the own contents?\n\nWhy don\u0027t we need another \"scoped_paint_chunk_properties-\u003eContinue();\" after the should_paint_normal_flow_and_pos_z_order_lists block?",
      "revId": "fd59fa33bffb2f4dc0c31d60c18f98adca9f4717",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3fc6b605_87974ed4",
        "filename": "third_party/WebKit/Source/core/paint/PaintLayerPainter.cpp",
        "patchSetId": 12
      },
      "lineNbr": 612,
      "author": {
        "id": 1002481
      },
      "writtenOn": "2017-11-09T22:20:11Z",
      "side": 1,
      "message": "\u003e This is complicated and it would be nice to avoid it if possible.\n\u003e\n\nAgreed.\n\n\u003e Isn\u0027t this a general problem when trying to slice up a display list into chunks?\n\u003e [display item bg][display item child][display item fg]\n\u003e -\u003e\n\u003e [chunk A.1][chunk B][chunk A.2]\n\u003e \n\u003e Currently, ScopedPaintChunkProperties resets the chunk id to null after chunk B. What if we changed the chunk id to be: {display item id, chunk index} and just incremented the index after chunk B goes out of scope?\n\u003e\n\nYes this is a general problem. Using chunk index in chunk id won\u0027t make it better because chunk index is not less volatile (or even more) than using the id of first display item. When it changes we must fully invalidate the chunks.\n\nBased on the current layout tests, the general problem seems mostly to occur for layer background/foreground chunks.\n \n\u003e Alternatively, is it possible to just introduce different chunks? One for the foreground and a different one for the own contents?\n\u003e\n\nDone. Previously I wanted to combine the background and foreground chunks if there was no negative-z-order children to save a chunk. Always introducing different chunks seems much clearer, and avoids Continue().\n \n\u003e Why don\u0027t we need another \"scoped_paint_chunk_properties-\u003eContinue();\" after the should_paint_normal_flow_and_pos_z_order_lists block?\n\nThe blocks after that block all create their own ScopedPaintChunkProperties.",
      "parentUuid": "08d1977f_5b2c0640",
      "revId": "fd59fa33bffb2f4dc0c31d60c18f98adca9f4717",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}