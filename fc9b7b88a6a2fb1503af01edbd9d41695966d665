{
  "comments": [
    {
      "key": {
        "uuid": "c4a72f56_4dd001f1",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 236,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2018-01-11T13:23:25Z",
      "side": 1,
      "message": "Doesn\u0027t the subscript notation work?",
      "range": {
        "startLine": 236,
        "startChar": 2,
        "endLine": 236,
        "endChar": 16
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ab3f102_202a018f",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 236,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T13:50:09Z",
      "side": 1,
      "message": "Yes, it didn\u0027t. I got compilation errors.",
      "parentUuid": "c4a72f56_4dd001f1",
      "range": {
        "startLine": 236,
        "startChar": 2,
        "endLine": 236,
        "endChar": 16
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d81a2d2d_02cffa9c",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 236,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T14:19:21Z",
      "side": 1,
      "message": "Can we use emplace instead? This would look cleaner.",
      "parentUuid": "3ab3f102_202a018f",
      "range": {
        "startLine": 236,
        "startChar": 2,
        "endLine": 236,
        "endChar": 16
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fcea8440_f082f1d5",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 236,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2018-01-11T14:24:05Z",
      "side": 1,
      "message": "Yes, you can use emplace.\nTo use the subscript notation you need to add a default constructor (with no args).",
      "parentUuid": "d81a2d2d_02cffa9c",
      "range": {
        "startLine": 236,
        "startChar": 2,
        "endLine": 236,
        "endChar": 16
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a4713d9_d8c8a35b",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 236,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T15:22:29Z",
      "side": 1,
      "message": "Replaced with emplace.",
      "parentUuid": "fcea8440_f082f1d5",
      "range": {
        "startLine": 236,
        "startChar": 2,
        "endLine": 236,
        "endChar": 16
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2bdef995_e65992ab",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 547,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2018-01-11T14:01:48Z",
      "side": 1,
      "message": "After looking at the other CL, I realized that before notifying the subscribers, you must perform the work MDDH does in MDDH::NotifyDeviceChangeOnUIThread().\n\nThis work consists on checking permission and translating the snapshot. For this you need the render_process_id and the render_frame_id, which you should add to the SubscriptionRequest struct so that the checks can be performed.",
      "range": {
        "startLine": 547,
        "startChar": 1,
        "endLine": 547,
        "endChar": 2
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50f1f797_bd336f15",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 547,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T14:19:21Z",
      "side": 1,
      "message": "\u003e After looking at the other CL, I realized that before notifying the subscribers, you must perform the work MDDH does in MDDH::NotifyDeviceChangeOnUIThread().\n\nRight. I was aware of this but didn\u0027t consider it in this CL as snapshot was never sent to MediaDevices. Please see https://cs.chromium.org/chromium/src/content/renderer/media/user_media_client_impl.cc?type\u003dcs\u0026q\u003duser_media_client_impl.cc\u0026l\u003d289.\nSo, should we take up the below in this CL or the other CL?\n\n\u003e This work consists on checking permission and translating the snapshot. For this you need the render_process_id and the render_frame_id, which you should add to the SubscriptionRequest struct so that the checks can be performed.\n\nThis check has to be performed through MediaDevicesPermissionChecker, right? In that case, MDPC has to be moved to MDD? Currently, it resides in MDDH.",
      "parentUuid": "2bdef995_e65992ab",
      "range": {
        "startLine": 547,
        "startChar": 1,
        "endLine": 547,
        "endChar": 2
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6a31adad_144c4757",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 547,
      "author": {
        "id": 1143639
      },
      "writtenOn": "2018-01-11T14:37:03Z",
      "side": 1,
      "message": "\u003e \u003e After looking at the other CL, I realized that before notifying the subscribers, you must perform the work MDDH does in MDDH::NotifyDeviceChangeOnUIThread().\n\u003e \n\u003e Right. I was aware of this but didn\u0027t consider it in this CL as snapshot was never sent to MediaDevices. Please see https://cs.chromium.org/chromium/src/content/renderer/media/user_media_client_impl.cc?type\u003dcs\u0026q\u003duser_media_client_impl.cc\u0026l\u003d289.\n\u003e So, should we take up the below in this CL or the other CL?\n\u003e \n\nYou can do it in this one or in the other CL.\nIf you prefer to do it in the next CL, you should send an empty snapshot in this one (and add a TODO). The browser should never send an untranslated snapshot to the renderer, even if the renderer is supposedly not going to use it.\n\n\u003e \u003e This work consists on checking permission and translating the snapshot. For this you need the render_process_id and the render_frame_id, which you should add to the SubscriptionRequest struct so that the checks can be performed.\n\u003e \n\u003e This check has to be performed through MediaDevicesPermissionChecker, right? In that case, MDPC has to be moved to MDD? Currently, it resides in MDDH.\n\nYou need to have a MDPC in MDD to perform the check, but you can remove it from MDDH only if it is not used for anything else.",
      "parentUuid": "50f1f797_bd336f15",
      "range": {
        "startLine": 547,
        "startChar": 1,
        "endLine": 547,
        "endChar": 2
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "875d949e_cb47addc",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 547,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T14:51:10Z",
      "side": 1,
      "message": "MDPC seems to be used for EnumerateDevices as well. May be we can make MDDH access MDPC from MDD through a getter? This will also result in only one MDPC in browser instead of one for every frame. WDYT?",
      "parentUuid": "6a31adad_144c4757",
      "range": {
        "startLine": 547,
        "startChar": 1,
        "endLine": 547,
        "endChar": 2
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "481e4442_d2849c1d",
        "filename": "content/browser/renderer_host/media/media_devices_manager.cc",
        "patchSetId": 7
      },
      "lineNbr": 547,
      "author": {
        "id": 1120018
      },
      "writtenOn": "2018-01-11T15:22:29Z",
      "side": 1,
      "message": "Added a TODO and an empty snapshot. Shall take up this work in the other CL.",
      "parentUuid": "875d949e_cb47addc",
      "range": {
        "startLine": 547,
        "startChar": 1,
        "endLine": 547,
        "endChar": 2
      },
      "revId": "fc9b7b88a6a2fb1503af01edbd9d41695966d665",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}