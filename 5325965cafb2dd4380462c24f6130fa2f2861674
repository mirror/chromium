{
  "comments": [
    {
      "key": {
        "uuid": "7b91023b_7d20fe43",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-09-22T15:31:08Z",
      "side": 0,
      "message": "I wonder - what are the cases when from_webstore() is different than UpdatesFromGallery()?  I can think of a few potential cases:\n- pref corruption (the \"from_webstore\" bit gets set in the preferences file incorrectly)\n- an extension that updates from the webstore being installed from a source other than the webstore\n\nAre there any other cases that you\u0027ve run across?",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0d30c46c_04079818",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1223356
      },
      "writtenOn": "2017-09-22T20:55:44Z",
      "side": 0,
      "message": "I can\u0027t think of other cases (which worries me, since I don\u0027t think this statement would have been written with the || just to cover the pref corruption).",
      "parentUuid": "7b91023b_7d20fe43",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "60abe181_2174aeb8",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1001727
      },
      "writtenOn": "2017-09-26T01:44:13Z",
      "side": 0,
      "message": "AFAIK, #2 above isn\u0027t possible (without tampering stuff) through external registry at least: we allow either a crx file or allow specifying an update url.\n\nFrom content verifier code\u0027s perspective, relying (only) on update_url \u003d\u003d webstore url to decide webstore-ness (and not looking at from_webstore() or other source) sounds good to me. I\u0027m not very familiar with this InstallVerifier though: I\u0027m curious as to how this change affects content verification... Can you explain?\ni.e. how does this fix the scenario from the bug comment #6 below?\n3. Fake update URL, from_webstore in creation flag",
      "parentUuid": "0d30c46c_04079818",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f28ed843_c2dc48ad",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1223356
      },
      "writtenOn": "2017-09-26T14:48:35Z",
      "side": 0,
      "message": "From what I understand, there\u0027s two different systems preventing bad extensions from being sideloaded.\n1. Install Verification enforces (on Win and OSX) that installed extensions are from the CWS. This includes extensions force-installed through external registry, external preference or external policy: we allow them as long as they are from the CWS. \n2. Content verification enforces that installed extensions were not modified on disk to change their behavior. For example, a binary could install an extension from the store then modify its content to inject ads.\n\nThis InstallVerifier change should disable more extensions (as it considers them as off-store). Content verification shouldn\u0027t trigger for these disabled extensions.\n\nFor #3 Fake update URL, from_webstore in creation flag:\nManifestURL::UpdatesFromGallery(\u0026extension) should return false for a fake update URL. The extension is disabled by the InstallVerifier.",
      "parentUuid": "60abe181_2174aeb8",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cdeed4ed_c2934aef",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1001727
      },
      "writtenOn": "2017-09-26T18:23:52Z",
      "side": 0,
      "message": "Great, thanks. (I wanted to double check that this is not content verification related and sounds like we\u0027re on the same page here).\n\nAs to the change here to remove migration support, Devlin is more knowledgeable here to continue the review. Q for Devlin: could sync result in the discrepancy between from_webstore() and UpdatesFromGallery?",
      "parentUuid": "f28ed843_c2dc48ad",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8c84a2a1_78a92109",
        "filename": "chrome/browser/extensions/install_verifier.cc",
        "patchSetId": 3
      },
      "lineNbr": 217,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-09-27T21:27:41Z",
      "side": 0,
      "message": "\u003e Q for Devlin: could sync result in the discrepancy between from_webstore() and UpdatesFromGallery?\n\nGood question!  I *think* we\u0027re okay on this, because of this line here:\nhttps://chromium.googlesource.com/chromium/src/+/8e84efbaca5b521546d346a596719d8527e1cfd8/chrome/browser/extensions/extension_service.cc#610\n\nEven if not, I think in this case using UpdatesFromGallery() would still be an accurate source of truth for \"should we verify this\".  So I think we\u0027re okay.",
      "parentUuid": "cdeed4ed_c2934aef",
      "revId": "5325965cafb2dd4380462c24f6130fa2f2861674",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}