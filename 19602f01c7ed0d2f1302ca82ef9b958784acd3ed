{
  "comments": [
    {
      "key": {
        "uuid": "220da54e_0c66c8f4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-09T05:05:15Z",
      "side": 1,
      "message": "I\u0027m not sure this is helpful. GetData explicitly documents that the callback might not be invoked in a timely manner and this might be for reasons other than the service worker - e.g. we download multiple items off the network. It also feels a bit ugly that an option is specified outside of the params object which has everything else in it.\n\nInstead, WDYT about changing the default so that you have to explicitly set wait_for_worker \u003d true and the default is false?",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 19,
        "endChar": 30
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "29010b33_3f9abac9",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-10T07:21:46Z",
      "side": 1,
      "message": "There\u0027s a strong difference between waiting for an icon to download vs waiting for a service worker which might never be added. If I have CHECK_IMMEDIATELY set, I can reasonably expect my callback to be called.\n\nMaking wait_for_worker false by default is probably fine, but I think that such a large divergence of behavior is best signalled by a mandatory parameter, rather than a comment. e.g. I didn\u0027t set this in https://chromium-review.googlesource.com/c/chromium/src/+/700137 and on pages with a manifest and no serviceworker, the dialog would never show.\n\nHaving to make a decision at every call site makes the semantics of the wait behavior clear and explicit. It\u0027s something that a client should have to think about every time, and it shouldn\u0027t be something that can be missed (like a comment).\n\nIt also feels out of place in params which is otherwise a set of bools that determines what gets filled out in InstallableData.",
      "parentUuid": "220da54e_0c66c8f4",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 19,
        "endChar": 30
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14c02f46_ef09e6a5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-11T03:00:57Z",
      "side": 1,
      "message": "I disagree that the difference in behaviour is that strong. There are plenty of cases where GetData() could be waiting a lengthy period of time on the network and I think these are not uncommon:\n\n - slow/flaky connection\n - network congestion (parallel downloads / concurrent local usage / streaming / computer downloading updates)\n - site is down / under heavy load / CDN is down\n\nOn Android, we show the dialog immediately with a spinner for the icon while we GetData() in the background. I\u0027d argue that something like this should be eventually implemented on desktop so that the UI responds immediately to the user, and they get a visual indication that we\u0027re doing work in the background.\n\nThe params are documented as the work to be done by InstallableManager so I think it\u0027s natural to have the waiting behaviour specified in there.",
      "parentUuid": "29010b33_3f9abac9",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 19,
        "endChar": 30
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a9811cb0_f5312423",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 19,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-12T07:20:03Z",
      "side": 1,
      "message": "Setting the default to false is good enough for me. I still think callers should be forced to think about whether they care if a service worker will ever be installed at a later time, because it\u0027s nonobvious that this case exists. I guess that can be thought about by OWNERs during review?",
      "parentUuid": "14c02f46_ef09e6a5",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 19,
        "endChar": 30
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a1142338_fcf3e8f1",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 245,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-09T05:05:15Z",
      "side": 1,
      "message": "Nit: possibly neater as:\n\nif (params.valid_manifest \u0026\u0026 valid_manifest_-\u003eerror !\u003d NO_ERROR_DETECTED\n  return valid_manifest_-\u003eerror;\n\nif (params.has_worker \u0026\u0026 worker_-\u003eerror !\u003d NO_ERROR_DETECTED)\n  return worker_-\u003eerror;\n\nThis also solves a race condition where you have task A requesting both and failing because the manifest is valid but there isn\u0027t a worker, and then task B request just the valid manifest failing because it\u0027s also picking up the lack of worker (but task B didn\u0027t ask for that).",
      "range": {
        "startLine": 239,
        "startChar": 1,
        "endLine": 245,
        "endChar": 0
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cbd25f06_625a4ba2",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 245,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-10T07:21:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a1142338_fcf3e8f1",
      "range": {
        "startLine": 239,
        "startChar": 1,
        "endLine": 245,
        "endChar": 0
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ddc8e21b_ac0e3157",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 245,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-11T03:00:57Z",
      "side": 1,
      "message": "Was this done?",
      "parentUuid": "cbd25f06_625a4ba2",
      "range": {
        "startLine": 239,
        "startChar": 1,
        "endLine": 245,
        "endChar": 0
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d12f2956_4c1cd632",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 245,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-12T07:20:03Z",
      "side": 1,
      "message": "Wups, bad rebase against eligibility.",
      "parentUuid": "ddc8e21b_ac0e3157",
      "range": {
        "startLine": 239,
        "startChar": 1,
        "endLine": 245,
        "endChar": 0
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "694fc5b3_35a999e3",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-09T05:05:15Z",
      "side": 1,
      "message": "Remove this bit so this is more logical",
      "range": {
        "startLine": 307,
        "startChar": 34,
        "endLine": 307,
        "endChar": 56
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8786bc39_11f1949b",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-10T07:21:46Z",
      "side": 1,
      "message": "Done.\n\nDo you think it\u0027s worth DCHECKing for !params.has_worker || params.valid_manifest in GetData? I think it never makes sense to have has_worker without valid_manifest, right?",
      "parentUuid": "694fc5b3_35a999e3",
      "range": {
        "startLine": 307,
        "startChar": 34,
        "endLine": 307,
        "endChar": 56
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b5918af3_da2aa8bb",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-11T03:00:57Z",
      "side": 1,
      "message": "Given they\u0027re separate params now, I don\u0027t think we should add the DCHECK. We could have a future client that only cares about the presence of a service worker, and it chooses to query InstallableManager because of the waiting behaviour that\u0027s already implemented.",
      "parentUuid": "8786bc39_11f1949b",
      "range": {
        "startLine": 307,
        "startChar": 34,
        "endLine": 307,
        "endChar": 56
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "87fc1c33_6879a16d",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 307,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-12T07:20:03Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "b5918af3_da2aa8bb",
      "range": {
        "startLine": 307,
        "startChar": 34,
        "endLine": 307,
        "endChar": 56
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "04aec6f4_a6e19f5d",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 405,
      "author": {
        "id": 1186534
      },
      "writtenOn": "2017-10-09T05:05:15Z",
      "side": 1,
      "message": "Remove this bit",
      "range": {
        "startLine": 405,
        "startChar": 35,
        "endLine": 405,
        "endChar": 57
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a14c40af_72faea1e",
        "filename": "chrome/browser/installable/installable_manager.cc",
        "patchSetId": 2
      },
      "lineNbr": 405,
      "author": {
        "id": 1002603
      },
      "writtenOn": "2017-10-10T07:21:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "04aec6f4_a6e19f5d",
      "range": {
        "startLine": 405,
        "startChar": 35,
        "endLine": 405,
        "endChar": 57
      },
      "revId": "19602f01c7ed0d2f1302ca82ef9b958784acd3ed",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}