{
  "comments": [
    {
      "key": {
        "uuid": "d1555be7_834b3042",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-14T23:33:25Z",
      "side": 1,
      "message": "Instead of replicating the functionality from the app info dialog, let\u0027s pull it into a common location.  extensions/common/path_util isn\u0027t quite the right place, but it\u0027s probably close enough.\n\nAlso, let\u0027s use GetExtensionFileTaskRunner() here.",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8078fc98_838b88dc",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:48:57Z",
      "side": 1,
      "message": "I was expecting that the app info dialog would be eventually deleted as part of migrating to MD Extensions. Is it used anywhere else?\nOtherwise pulling out the code to re-use it in both places seems unnecessary.",
      "parentUuid": "d1555be7_834b3042",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8886f1a8_4c18e411",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-15T02:24:15Z",
      "side": 1,
      "message": "Ideally, we will deprecate the app info dialog, but I think it\u0027s also currently used for CrOS from the launcher panel.  Until we fully migrate things over (or something else) I think both might be in use.  So I think it\u0027s worth moving to a shared place.",
      "parentUuid": "8078fc98_838b88dc",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d64fe002_5e2f19ce",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-15T20:28:22Z",
      "side": 1,
      "message": "Ok. Trying to move this line to a shared location (specifically extensions/browser/path_util.cc).\n\nNeed a bit of help understanding though your initial suggestion. Were you suggesting to put lines 679-684 to a re-usable method, and keep having separate callbacks, for the AppINfoSummaryPanel and here? If so, would DeveloperPrivateGetExtensionSizeFunction::OnSizeCalculated and AppInfoSummaryPanel::OnAppSizeCalculated be passed as a parameter to the new utility method?\n\nHaving said that, could we punt this for a follow up CL, to increase the chances of getting this CL landed and merged to M64?",
      "parentUuid": "8886f1a8_4c18e411",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "98317084_f1762818",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-15T22:38:23Z",
      "side": 1,
      "message": "What I\u0027m envisioning:\n\nnamespace {\n\nvoid OnDirectorySizeCalculated(\n    base::OnceCallback\u003cvoid(const base::string16\u0026)\u003e callback,\n    int64_t size_in_bytes) {\n  base::string16 response;\n\n  const int one_mebibyte_in_bytes \u003d 1024 * 1024;\n  if (size_in_bytes \u003c one_mebibyte_in_bytes) {\n    response \u003d l10n_util::GetStringUTF16(IDS_APPLICATION_INFO_SIZE_SMALL_LABEL);\n  } else {\n    response \u003d\n        ui::FormatBytesWithUnits(size_in_bytes, ui::DATA_UNITS_MEBIBYTE, true);\n  }\n  std::move(callback).Run(response);\n}\n\n}  // namespace\n\nvoid CalculateExtensionDirectorySize(\n    const base::FilePath\u0026 extension_path,\n    base::OnceCallback\u003cvoid(const base::string16\u0026)\u003e callback) {\n  GetExtensionFileTaskRunner()-\u003ePostTask(\n      base::BindOnce(\u0026base::ComputeDirectorySize, extension_path),\n      base::BindOnce(\u0026OnDirectorySizeCalculated, std::move(callback));\n}\n\n\nand then here:\n\nExtensionFunction::ResponseAction\nDeveloperPrivateGetExtensionSizeFunction::Run() {\n  std::unique_ptr\u003cdeveloper::GetExtensionSize::Params\u003e params(\n      developer::GetExtensionSize::Params::Create(*args_));\n  EXTENSION_FUNCTION_VALIDATE(params);\n\n  const Extension* extension \u003d GetExtensionById(params-\u003eid);\n  if (!extension)\n    return RespondNow(Error(kNoSuchExtensionError));\n\n  CalculateExtensionDirectorySize(\n      extension-\u003epath(),\n      base::BindOnce(\n          \u0026DeveloperPrivateGetExtensionSizeFunction::OnSizeCalculated,\n          this /* refcounted */));\n  return RespondLater();\n}\n\nvoid DeveloperPrivateGetExtensionSizeFunction::OnSizeCalculated(\n    const base::string16\u0026 size) {\n  Respond(OneArgument(std::make_unique\u003cbase::Value\u003e(size)));\n}\n\nWe can leave this for a followup.",
      "parentUuid": "d64fe002_5e2f19ce",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f28b0f20_fdd0ce68",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-15T23:01:29Z",
      "side": 1,
      "message": "Ok. Thanks. I\u0027ll give it a shot as a follow up (added a TODO for now).",
      "parentUuid": "98317084_f1762818",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b1bd54d0_6980fd94",
        "filename": "chrome/browser/extensions/api/developer_private/developer_private_api.cc",
        "patchSetId": 4
      },
      "lineNbr": 680,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-19T23:40:32Z",
      "side": 1,
      "message": "FYI, I am addressing this TODO at https://chromium-review.googlesource.com/c/chromium/src/+/835001.",
      "parentUuid": "f28b0f20_fdd0ce68",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "da4fbded_4f21e181",
        "filename": "chrome/browser/resources/md_extensions/detail_view.html",
        "patchSetId": 4
      },
      "lineNbr": 270,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-14T23:33:25Z",
      "side": 1,
      "message": "Do we need any kind of placeholder here?  A spinner, a \"calculating...\"-type string, etc?\n\nIn particular, this might be useful if going from extension a -\u003e extension b, since the same detail view element will be reused, right?",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "555f9721_2f456a15",
        "filename": "chrome/browser/resources/md_extensions/detail_view.html",
        "patchSetId": 4
      },
      "lineNbr": 270,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:48:57Z",
      "side": 1,
      "message": "The old UI did not seem to use any spinner. Also when I tried locally (granted not with a very large extension) it seemed instant. I am leaning towards a simpler no-spinner solution first (especially since this will be merge-requested), and only add a spinner later, if it proves to be an issue.\n\nRegarding reusing the same view for different extensions, yes we reuse it. How about clearing the number when the view exits. This way, when the user navigates to a different extension\u0027s detail page, and if  size calculation takes a while, an empty size would be shown, instead of an obsolete one?",
      "parentUuid": "da4fbded_4f21e181",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "242a03c2_090bfd2f",
        "filename": "chrome/browser/resources/md_extensions/detail_view.html",
        "patchSetId": 4
      },
      "lineNbr": 270,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:55:36Z",
      "side": 1,
      "message": "See patchset 6, for clearing the size approach.",
      "parentUuid": "555f9721_2f456a15",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "20a211b0_17557a0e",
        "filename": "chrome/browser/resources/md_extensions/detail_view.html",
        "patchSetId": 4
      },
      "lineNbr": 270,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-15T02:24:15Z",
      "side": 1,
      "message": "The old UI did show a loading label:\n\nhttps://chromium.googlesource.com/chromium/src/+/9d325a95db69918d2ee248758bee677a5d470ae8/chrome/browser/ui/views/apps/app_info_dialog/app_info_summary_panel.cc#214\n\nIf it\u0027s not too much effort, I\u0027d rather prefer that.  We have simple UI elements for spinners, right?  WDYT?",
      "parentUuid": "242a03c2_090bfd2f",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "244e947d_396c6556",
        "filename": "chrome/browser/resources/md_extensions/detail_view.html",
        "patchSetId": 4
      },
      "lineNbr": 270,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-15T20:28:22Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "20a211b0_17557a0e",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dea1ad48_9d60f120",
        "filename": "chrome/common/extensions/api/developer_private.idl",
        "patchSetId": 4
      },
      "lineNbr": 493,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-14T23:33:25Z",
      "side": 1,
      "message": "s/path/string",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a070ed63_d85fdeae",
        "filename": "chrome/common/extensions/api/developer_private.idl",
        "patchSetId": 4
      },
      "lineNbr": 493,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:48:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dea1ad48_9d60f120",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7e496957_d2343f3d",
        "filename": "chrome/common/extensions/api/developer_private.idl",
        "patchSetId": 4
      },
      "lineNbr": 493,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:48:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "dea1ad48_9d60f120",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ab642cf5_9e6b07a7",
        "filename": "chrome/common/extensions/api/developer_private.idl",
        "patchSetId": 4
      },
      "lineNbr": 517,
      "author": {
        "id": 1115745
      },
      "writtenOn": "2017-12-14T23:33:25Z",
      "side": 1,
      "message": "nit: add comments",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c78ee7f8_c0f9f89b",
        "filename": "chrome/common/extensions/api/developer_private.idl",
        "patchSetId": 4
      },
      "lineNbr": 517,
      "author": {
        "id": 1115893
      },
      "writtenOn": "2017-12-14T23:48:57Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ab642cf5_9e6b07a7",
      "revId": "046c1303f4749bfdeb1a10c0c1c1f5166600af26",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}