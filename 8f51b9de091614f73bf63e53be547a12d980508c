{
  "comments": [
    {
      "key": {
        "uuid": "cb555a25_d0502b91",
        "filename": "chrome/browser/permissions/permission_request_manager_browsertest.cc",
        "patchSetId": 2
      },
      "lineNbr": 414,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-08T12:20:50Z",
      "side": 0,
      "message": "This call clears all params including necessary params for ResourceLoadScheduiler.\nThat results in crashing inside base::FieldTrialList::GetParamsFromSharedMemory() when ResourceLoadScheduler checks params in Blink.\n\nhttps://luci-logdog.appspot.com/v/?s\u003dchromium%2Fbb%2Ftryserver.chromium.linux%2Flinux_chromium_rel_ng%2F519784%2F%2B%2Frecipes%2Fsteps%2Fbrowser_tests__with_patch_%2F0%2Flogs%2FPermissionRequestManagerBrowserTest.KillSwitchGeolocation%2F0\n\nSo, I swapped testing order so that we do not need to load another page after calling ClearAllVariationParams.",
      "revId": "8f51b9de091614f73bf63e53be547a12d980508c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9c577c39_f0417e81",
        "filename": "chrome/browser/permissions/permission_request_manager_browsertest.cc",
        "patchSetId": 2
      },
      "lineNbr": 414,
      "author": {
        "id": 1003044
      },
      "writtenOn": "2017-08-09T04:01:32Z",
      "side": 0,
      "message": "I don\u0027t fully understand the problem here (I haven\u0027t really used finch before). Is the issue that the ResourceLoadScheduler gets confused as we previously had an experiment but it gets disabled, and this is the only test that happens to run into it? The test change looks OK but it doesn\u0027t seem like we\u0027re currently doing anything that shouldn\u0027t work.",
      "parentUuid": "cb555a25_d0502b91",
      "revId": "8f51b9de091614f73bf63e53be547a12d980508c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f29fca01_c4957915",
        "filename": "chrome/browser/permissions/permission_request_manager_browsertest.cc",
        "patchSetId": 2
      },
      "lineNbr": 414,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-09T05:16:53Z",
      "side": 0,
      "message": "Yes, only parameters are cleared by ClearAllVariationParams(), but field study is still activated even after that. That makes ResourceLoadScheduler confused.\n\nResourceLoadScheduler is configured on each frame creation, and check finch parameters only when the field study is activated. But if parameters are cleared here, base::FieldTrialList::GetParamsFromSharedMemory() crashes.\n\nThere are other field studies in Blink that use finch parameters, and potentially they all could crash due to the same reason. But probably just no other study is enabled by variations/fieldtrial_testing_config.json today. This is a configuration file that enables a field study in the waterfall to make sure that the configuration works and is ready to enable on Beta channel.",
      "parentUuid": "9c577c39_f0417e81",
      "revId": "8f51b9de091614f73bf63e53be547a12d980508c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "258e599b_1369c81b",
        "filename": "chrome/browser/permissions/permission_request_manager_browsertest.cc",
        "patchSetId": 2
      },
      "lineNbr": 414,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-09T05:30:01Z",
      "side": 0,
      "message": "Also, my understanding is that ClearAllVariationParams() is useful for unit tests, but we should be careful to use it in browser tests. Everyone assumes the finch configuration is not changed dynamically, but this test function changes it. Maybe it would be better to allow using this only in TearDown?",
      "parentUuid": "f29fca01_c4957915",
      "revId": "8f51b9de091614f73bf63e53be547a12d980508c",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}