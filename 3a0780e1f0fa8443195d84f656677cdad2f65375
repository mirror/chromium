{
  "comments": [
    {
      "key": {
        "uuid": "f1d9a77d_c6e9a857",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 88,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-29T09:17:11Z",
      "side": 1,
      "message": "is it slightly better to get the factory via RenderFrameImpl::GetDefaultURLLoaderFactoryGetter()-\u003eGetNetworkLoaderFactory()?\n\nAfter this change, we may want to expose the ChildURLLoaderFactoryGetter and RenderFrame(Impl)::GetDefaultURLLoaderFactoryGetter() to content public so that chrome/ can call.\n\nEventually, we will refactor ThrottlingURLLoader to be mojom::URLLoaderFactory inheritance that composite another factory, then ChildURLLoaderFactoryGetter would return it.",
      "range": {
        "startLine": 88,
        "startChar": 4,
        "endLine": 88,
        "endChar": 19
      },
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "98dda4e5_bf13867e",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 88,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-29T09:49:18Z",
      "side": 1,
      "message": "Also, it looks NetworkLoaderFactory is not a right factory for the mojo_context_state. That would be the reason of layout test failures.",
      "parentUuid": "f1d9a77d_c6e9a857",
      "range": {
        "startLine": 88,
        "startChar": 4,
        "endLine": 88,
        "endChar": 19
      },
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "57bc31e7_3e77e415",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 88,
      "author": {
        "id": 1104639
      },
      "writtenOn": "2017-08-29T20:09:19Z",
      "side": 1,
      "message": "\"Eventually, we will refactor ThrottlingURLLoader to be mojom::URLLoaderFactory inheritance that composite another factory, then ChildURLLoaderFactoryGetter would return it.\"\n\nWould you please point me to any discussion thread/bug about this, if any? I would like to learn more about it.\n\nI feel that it may not be correct to make ThrottlingURLLoader a mojom::URLLoaderFactory. For example, ThrottlingURLLoader cannot start multiple URL requests. Instead, it is more close to a mojom::URLLoader.",
      "parentUuid": "98dda4e5_bf13867e",
      "range": {
        "startLine": 88,
        "startChar": 4,
        "endLine": 88,
        "endChar": 19
      },
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8b7cf44d_a4a86395",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 88,
      "author": {
        "id": 1001472
      },
      "writtenOn": "2017-08-30T04:14:11Z",
      "side": 1,
      "message": "I will file a bug about this, these are all still rough ideas with some whiteboard discussion, but we\u0027ll need to converge on a concrete plan.  What we talked in the gist is that basically we want to have a common, a little more portable way to get the right URLLoader, while currently the path to achieve it is a little getting complex-- we do this in two-steps:\n\n1) when CreateURLLoader() is called we first determines which URLLoaderFactory to use, attaches necessary layered URLLoaderFactory\u0027s if necessary, and creates WebURLLoaderImpl that encapsulates the URLLoaderFactory.  (We don\u0027t create URLLoader yet here)\n2) and then when WebURLLoader::Load() is called. We internally calls ResourceDispatcher\u0027s Start*ync() method (which should go away soonish if we completely migrate over mojo), and that\u0027s where we attach ThrottlingURLLoader.\n\nI want to make this happen at once in either one of these is called, and want to hide all the details around URLLoaderFactory from the callsites.  Wrapping all these set-up code into a custom URLLoaderFactory is one of the things that is discussed.  So it\u0027s not really about making ThrottlingURLLoader a mojom::URLLoaderFactory, but about making the code that sets up ThrottlingURLLoader a mojom::URLLoaderFactory.  In either way we\u0027re still just discussing this, and your comments are much appreciated.",
      "parentUuid": "57bc31e7_3e77e415",
      "range": {
        "startLine": 88,
        "startChar": 4,
        "endLine": 88,
        "endChar": 19
      },
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b505f525_9d9fa1c9",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 98,
      "author": {
        "id": 1104639
      },
      "writtenOn": "2017-08-29T20:17:25Z",
      "side": 1,
      "message": "please use content::mojom::kURLLoadOptionNone instead.",
      "range": {
        "startLine": 98,
        "startChar": 45,
        "endLine": 98,
        "endChar": 57
      },
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c72198f_770f9fdd",
        "filename": "content/renderer/fetchers/resource_fetcher_impl.cc",
        "patchSetId": 3
      },
      "lineNbr": 105,
      "author": {
        "id": 1002172
      },
      "writtenOn": "2017-08-29T09:49:18Z",
      "side": 1,
      "message": "will change this not to set completed_ because OnComplete() will be eventually called and DCHECK fails if a test does not finish immediately. This was a reason of ResourceFetcherTimeout test falkiness.\n\nOn the other hand, if completed_ is not set here, loader_ won\u0027t be reset immediately. it results in unexpected callback invocations, e.g. OnReceiveResponse may be called when status_ is kClosed. So, I will explicitly reset loader_ here.",
      "revId": "3a0780e1f0fa8443195d84f656677cdad2f65375",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}