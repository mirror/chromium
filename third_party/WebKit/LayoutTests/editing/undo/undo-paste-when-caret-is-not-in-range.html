<!DOCTYPE html>
<script src="../../resources/testharness.js"></script>
<script src="../../resources/testharnessreport.js"></script>
<script src="../assert_selection.js"></script>
<script>
// The below test undo paste, when the caret is not in range.
selection_test(
  '<div contenteditable>^abc| </div>',
  selection => {
    const document  = selection.document;
    const edit = document.querySelector('div');
    // Copy the current selection.
    document.execCommand('copy');
    // Insert on a selection.
    document.execCommand('insertText', false, 'def');
    // Mark a selection
    selection.setBaseAndExtent(edit.firstChild, 0 , edit.firstChild, 3);
    // Execute paste
    document.execCommand('paste');
    selection.collapse(edit, edit.childNodes.length);
    // Execute undo
    document.execCommand('undo');
  },
  '<div contenteditable>^def| </div>',
  'Undo pastshould work when caret not in range'
);
</script>