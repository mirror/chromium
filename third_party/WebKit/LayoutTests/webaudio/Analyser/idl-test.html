<!DOCTYPE html>
<html>
  <head>
    <title>
      Test AnalyserNode IDL
    </title>
    <script src="/resources/testharness.js"></script>
    <script src="/resources/testharnessreport.js"></script>
    <script src="/resources/idlharness.js"></script>
    <script src="/resources/WebIDLParser.js"></script>
  </head>
  <body>
   <pre id="event-target-idl">interface EventTarget {
  void addEventListener(DOMString type, EventListener? callback, optional boolean capture = false);
  void removeEventListener(DOMString type, EventListener? callback, optional boolean capture = false);
  boolean dispatchEvent(Event event);
};

/*
callback interface EventListener {
  void handleEvent(Event event);
};
*/
// Callback interfaces are not supported yet, but that's ok
interface EventListener {};
</pre>
    <pre id="audio-param-idl">
interface AudioParam {
                    attribute float value;
    readonly        attribute float defaultValue;
    readonly        attribute float minValue;
    readonly        attribute float maxValue;
    AudioParam setValueAtTime (float value, double startTime);
    AudioParam linearRampToValueAtTime (float value, double endTime);
    AudioParam exponentialRampToValueAtTime (float value, double endTime);
    AudioParam setTargetAtTime (float target, double startTime, float timeConstant);
    AudioParam setValueCurveAtTime (sequence<float> values, double startTime, double duration);
    AudioParam cancelScheduledValues (double cancelTime);
    AudioParam cancelAndHoldAtTime (double cancelTime);
};
    </pre>
    <pre id="audio-node-idl">
interface AudioNode : EventTarget {
    AudioNode connect (AudioNode destination, optional unsigned long output = 0
              , optional unsigned long input = 0
              );
    void      connect (AudioParam destination, optional unsigned long output = 0
              );
    void      disconnect ();
    void      disconnect (unsigned long output);
    void      disconnect (AudioNode destination);
    void      disconnect (AudioNode destination, unsigned long output);
    void      disconnect (AudioNode destination, unsigned long output, unsigned long input);
    void      disconnect (AudioParam destination);
    void      disconnect (AudioParam destination, unsigned long output);
    readonly        attribute BaseAudioContext      context;
    readonly        attribute unsigned long         numberOfInputs;
    readonly        attribute unsigned long         numberOfOutputs;
                    attribute unsigned long         channelCount;
                    attribute ChannelCountMode      channelCountMode;
                    attribute ChannelInterpretation channelInterpretation;
};
    </pre>
    <pre id="analyser-node-idl">
[ Constructor (BaseAudioContext context, optional AnalyserOptions options)]
interface AnalyserNode : AudioNode {
    void getFloatFrequencyData (Float32Array array);
    void getByteFrequencyData (Uint8Array array);
    void getFloatTimeDomainData (Float32Array array);
    void getByteTimeDomainData (Uint8Array array);
                    attribute unsigned long fftSize;
    readonly        attribute unsigned long frequencyBinCount;
                    attribute double        minDecibels;
                    attribute double        maxDecibels;
                    attribute double        smoothingTimeConstant;
};
    </pre>
    <script>
      var node;
      function testIDL () {
	let idl_array = new IdlArray();
	idl_array.add_untested_idls(document.getElementById("event-target-idl").textContent);
//	idl_array.add_untested_idls(document.getElementById("base-audio-context-idl").textContent);
	idl_array.add_untested_idls(document.getElementById("audio-node-idl").textContent);
//	idl_array.add_untested_idls(document.getElementById("audio-param-idl").textContent);
	idl_array.add_idls(document.getElementById("analyser-node-idl").textContent);

        let context = new AudioContext();
	node = new AnalyserNode(context);

	idl_array.add_objects({AnalyserNode: ["node"]});
	idl_array.test();
      }
      testIDL();
    </script>
  </body>
</html>
