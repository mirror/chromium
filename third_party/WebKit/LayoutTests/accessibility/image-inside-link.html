<!DOCTYPE html>
<script src="../resources/testharness.js"></script>
<script src="../resources/testharnessreport.js"></script>

<div id="wrapper1">
    <a href="#"><img id="img1" alt="Delicious cake" src="resources/cake.png"></a>
</div>

<script>
async_test(function(t)
{
    var axImg = accessibilityController.accessibleElementById("img1");
    axImg.addNotificationListener(function(notification) {
        if (notification == 'Clicked') {
            document.getElementById("wrapper1").style.display = "none";
            t.done();
        }
    });

    var img = document.getElementById("img1");
    img.addEventListener("click", function(e)
    {
        img.title = "clicked";
    });
    img.click();
}, "clicking an image via javascript sends an accessible click event");
</script>

<div id="wrapper2">
    <a href="#"><img id="img2" alt="Delicious cake" src="resources/cake.png"></a>
</div>

<script>
async_test(function(t)
{
    var axImg = accessibilityController.accessibleElementById("img2");
    axImg.addNotificationListener(function(notification) {
        if (notification == 'Clicked') {
            document.getElementById("wrapper2").style.display = "none";
            t.done();
        }
    });

    var img = document.getElementById("img2");
    img.addEventListener("click", function(e)
    {
        img.title = "clicked";
    });
    eventSender.mouseMoveTo(axImg.x + 10, axImg.y + 10);
    eventSender.mouseDown();
    eventSender.mouseUp();
}, "clicking an image via mouse events sends an accessible click event");
</script>

<div id="wrapper4">
    <a href="#"><img id="img4" alt="Delicious cake" src="resources/cake.png"></a>
</div>

<script>
async_test(function(t)
{
    var axEvent = false;
    var domEvent = false;
    var axImg = accessibilityController.accessibleElementById("img4");
    axImg.addNotificationListener(function(notification) {
        if (notification == 'Clicked') {
            axEvent = true;
        }
    });

    var img = document.getElementById("img4");
    img.addEventListener("click", function(e)
    {
        img.title = "clicked";
        domEvent = true;
    });
    axImg.press();

    setTimeout(function()
    {
        if (axEvent && domEvent) {
            document.getElementById("wrapper4").style.display = "none";
            t.done();
        }
    });
}, "clicking an image via accessibility sends both an accessible and a DOM click event");
</script>
