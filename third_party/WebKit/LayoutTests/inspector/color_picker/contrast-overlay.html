<html>
  <head>
    <script src="../../http/tests/inspector/inspector-test.js"></script>
    <script type="text/javascript">
      async function test() {
        await self.runtime.loadModulePromise("color_picker");
        var colorElement = document.createElement('div')
        var contentElement = document.createElement('div');
        var overlay = new ColorPicker.ContrastOverlay(colorElement, contentElement);
        var svg = colorElement.firstChild;
        InspectorTest.assertTrue(svg != null);
        InspectorTest.assertEquals(svg.tagName, 'svg');
        var path = svg.firstChild;
        InspectorTest.assertTrue(path != null);
        InspectorTest.assertEquals(path.tagName, 'path');
        overlay._width = 100;
        overlay._height = 100;
        var contrastInfo = { backgroundColors: ['rgba(157, 83, 95, 255)'],
                             computedFontSize: '16px',
                             computedFontWeight: '400',
                             computedBodyFontSize: '16px' };
        overlay.setContrastInfo(contrastInfo);
        overlay.setColor([0, 0, 1, 1], 'rgba(255, 255, 255, 1)');
        overlay._drawContrastRatioLine();
        // Check that the code didn't early out without drawing a line at all.
        InspectorTest.assertTrue(path.getAttribute('d') !== '');
        InspectorTest.addResult('Contrast ratio line completed.');
        InspectorTest.completeTest();
      }
    </script>
  </head>
  <body onload="runTest()">
    Tests that the contrast line algorithm doesn't go into an infinite loop with a
    known bad foreground/background color combination.
  </body>
</html>
