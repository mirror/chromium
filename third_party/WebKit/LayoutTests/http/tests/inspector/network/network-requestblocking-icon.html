<html>
<head>
<script src="/inspector/inspector-test.js"></script>
<script>

async function test()
{
    var pane = null;
    dumpIconResult();

    InspectorTest.addResult("Loading Network Module");
    await self.runtime.loadModulePromise('network');
    InspectorTest.addResult("Network Module Loaded");

    pane = new Network.BlockedURLsPane();
    await setBlockedPatterns([]);
    dumpIconResult();
    pane._toggleEnabled();
    dumpIconResult();
    await setBlockedPatterns([{pattern: '*', enabled: true, blockedCount: 0}]);
    dumpIconResult();
    pane._toggleEnabled();
    dumpIconResult();
    InspectorTest.completeTest();

    function dumpIconResult() {
        var enabled = !!(pane && pane._requestBlockingEnabled);
        var hasIcon = !!UI.inspectorView._tabbedPane._tabsElement.getElementsByClassName("smallicon-warning").length;
        InspectorTest.addResult("Is blocking: " + enabled);
        InspectorTest.addResult("Has Entries: " + !!(pane && pane._patternEntries.length))
        InspectorTest.addResult(hasIcon ? "Has Icon" : "Does Not Have Icon");
        InspectorTest.addResult("");
    }

    /**
     * @param {!Array<!{pattern: string, blockedCount: 0, enabled: boolean}}
     * @return {!Promise}
     */
    function setBlockedPatterns(patternDatas) {
        pane._patternEntries = patternDatas;
        return pane._update();
    }
}
</script>
</head>
<body onload="runTest()">
<p>Ensures the icon is properly displayed when network request blocking setting is enabled/disabled.</p>
</body>
</html>
