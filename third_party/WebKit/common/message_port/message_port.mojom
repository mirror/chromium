// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

module blink.mojom;

import "storage/public/interfaces/blobs.mojom";

// This struct represents a message as it is sent across a MessagePort. A
// MessagePort itself is represented as a raw mojo message pipe, and messages
// on it are (in both directions) serialized versions of this struct.
struct MessagePortMessage {
  // The actual message data, as encoded by blink::SerializedScriptValue.
  array<uint8> encoded_message;
  // Any ports being transfered as part of this message.
  array<handle<message_pipe>> ports;
  // Blob handles for any blobs being send in this message.
  array<SerializedBlob> blobs;
};

// Struct wrapping a Blob interface pointer.
// TODO(mek): Once https://crbug.com/696107 is implemented all usage of this
// struct can be replaced with a simple Blob interface pointer with handle
// properties for the other attributes.
struct SerializedBlob {
  string uuid;
  string content_type;
  uint64 size;
  storage.mojom.Blob blob;
};
