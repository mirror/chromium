// Copyright 2017 The Chromium Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

module blink.mojom;

import "third_party/WebKit/public/platform/content_security_policy.mojom";
import "url/mojo/origin.mojom";

// Origin Manifest structures
struct OriginManifest {
  url.mojom.Origin origin;
  string version;
  string json;
  array<ContentSecurityPolicy> csps;
  CORSPreflight? corspreflights;
  //int64 creationdate;
  //int64 expirydate;
};

struct ContentSecurityPolicy {
  string policy = "";
  ContentSecurityPolicyType disposition = ContentSecurityPolicyType.kEnforce;
  bool allowOverride = false;
};

struct CORSPreflight {
  CORSOrigins? nocredentials;
  CORSOrigins? withcredentials;
};

struct CORSOrigins {
  bool allowAll = false;
  array<url.mojom.Origin> origins;
};
