{
  "comments": [
    {
      "key": {
        "uuid": "eac327dc_071139bd",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 10
      },
      "lineNbr": 162,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "This is not related to your CL, but could you consider renaming it to something like params.selection_start_offset, in a separate CL?",
      "range": {
        "startLine": 162,
        "startChar": 40,
        "endLine": 162,
        "endChar": 63
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5f8ae39_f9df7a68",
        "filename": "content/browser/android/selection_popup_controller.cc",
        "patchSetId": 10
      },
      "lineNbr": 162,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "eac327dc_071139bd",
      "range": {
        "startLine": 162,
        "startChar": 40,
        "endLine": 162,
        "endChar": 63
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "66628d7b_4615b23d",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 10
      },
      "lineNbr": 806,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "style nit: switch?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "20f6830a_1d788f72",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SelectionPopupController.java",
        "patchSetId": 10
      },
      "lineNbr": 806,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "I have tried switch before, R.id.* are not constants, it won\u0027t compile.",
      "parentUuid": "66628d7b_4615b23d",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0ee0ccda_870737fc",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 37,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "The current class is quite hard to read.\n\nHow about structurizing this as:\n\nclass SmartSelectionMetricsLogger {\n  static interface Adapter {\n    void logSelectionStarted(int start);\n    void logSelectionModified(int lastStartOffset, int lastEndOffset, SelectionClient.Result result);\n    void logSelectionAction(int lastStartOffset, int lastEndOffset, int action);\n    void ...;\n  }\n\n  private static class AdapterImpl implements Adapter { // all the reflection logic goes in here\n    \n  }\n\n  public static SmartSelectionMetricsLogger create(Context context) { return create(context, new AdapterImpl(); }\n  public static SmartSelectionMetricsLogger create(Context context, Adapter adapter) {...}\n}\n\nAnd have test mock out Adapter.",
      "range": {
        "startLine": 37,
        "startChar": 13,
        "endLine": 37,
        "endChar": 40
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea95fe16_e1e96d3d",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 52,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "definitely needs comments here what all these values are. looks like some of these are char indices, some of these are word indices?\n\nand then some things are adjusted to the start of the original selection, and some are not?\n\nI\u0027m having a really hard time grokking this class..",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5903d20f_1b07a242",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 54,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "mBreakIterator?",
      "range": {
        "startLine": 54,
        "startChar": 32,
        "endLine": 54,
        "endChar": 45
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3483b7d7_7bb20661",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 56,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "Could you just pass Context here?",
      "range": {
        "startLine": 56,
        "startChar": 53,
        "endLine": 56,
        "endChar": 76
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6cb5b975_36aece13",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 59,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "null check getContext as well",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7f6fc0be_baeb296e",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 98,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "how about renaming this as hasSelectionStarted()?",
      "range": {
        "startLine": 98,
        "startChar": 13,
        "endLine": 98,
        "endChar": 30
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "665913be_48dba06b",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 103,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "Could you guard all of these with DEBUG constant? We probably don\u0027t want to spam developers with these logs.",
      "range": {
        "startLine": 103,
        "startChar": 8,
        "endLine": 103,
        "endChar": 13
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a529e22e_740ab943",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 103,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "665913be_48dba06b",
      "range": {
        "startLine": 103,
        "startChar": 8,
        "endLine": 103,
        "endChar": 13
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8d035dd0_2a172042",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 156,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "initialize default values?",
      "range": {
        "startLine": 156,
        "startChar": 38,
        "endLine": 156,
        "endChar": 48
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cfbe3ec5_0fa0390c",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 156,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:27:36Z",
      "side": 1,
      "message": "nvm about this.",
      "parentUuid": "8d035dd0_2a172042",
      "range": {
        "startLine": 156,
        "startChar": 38,
        "endLine": 156,
        "endChar": 48
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1e81bd95_69c8a9f5",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 196,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "I\u0027m confused why does a \"logger\" contain any business logic state at all? Why is it that we don\u0027t want to shrink the logged selection here? I guess I\u0027m echoing changwan\u0027s point that actual logging, and business logic should be kept separate, and need a comment explaining the business logic, because code is very difficult to understand\n\nalso does all these index tracking make sense when the selection text could change?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0e4f11b7_18522a8b",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 196,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "Yeah, separating them is a better idea. I only realized the hierarchy in the middle of implementing and didn\u0027t write the code explicitly, I probably will forget it in the future myself :P\n\nI can see three layers here:\n1. logger(character indices, used by SelectionPopupController)\n2. character indices to word indices converter\n3. logger(word indices, reflection wrapper))\n\nOn the other hand, a logging session flow will be like this:\n1. a logSelectionStarted() called, it will start a new logging session and end the last logging session if necessary.\n2. one or more logSelectionModified() are called.\n3. one or more logSelectionAction() are called.\nSome of the actions are termination actions, logging session will be stopped in that case.\n\nI gradually combine selections from logSelectionModified() and logSelectionAction() to the original selection here, so I could use it for calculating word indices from character indices. The basic idea is if the current selection is not overlapping with the previous selection, it must be a new selection.\n\nI will think of a way to make this more obvious by combining the idea from Changwan\u0027s comment.",
      "parentUuid": "1e81bd95_69c8a9f5",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e98a23ca_48641d22",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 227,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "this doesn\u0027t \"get\" anything",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9760457b_9a2b105d",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 233,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "is this really a special case? shouldn\u0027t countWordsForward be returning 0 anyway?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a39741d8_1e382025",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 243,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "what if these return BreakIterator.DONE?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7dd4f405_d4402afe",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 244,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "what is this? not understanding..",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ba89a769_c742cfc8",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 266,
      "author": {
        "id": 1116193
      },
      "writtenOn": "2017-10-20T19:23:40Z",
      "side": 1,
      "message": "Do you just want to avoid counting a non-word?\nHow about punctuations?\nCould you add unit tests around this?\nOr can you just copy whatever Android is doing?",
      "range": {
        "startLine": 266,
        "startChar": 17,
        "endLine": 266,
        "endChar": 29
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1c276bdc_b9cd5791",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 266,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "Just to ignore white spaces.\nPunctuation is considered as a word.\nCovered few cases in the current unit tests, adding more tests.\nThis is copying what Android is doing.",
      "parentUuid": "ba89a769_c742cfc8",
      "range": {
        "startLine": 266,
        "startChar": 17,
        "endLine": 266,
        "endChar": 29
      },
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "384d7f4f_783ecdaa",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 330,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "why are we doing reflection upstream? is this class going to be added in omr1? in which case need to move this code downstream so it can compile against omr1.",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2205a0f9_628e7c4c",
        "filename": "content/public/android/java/src/org/chromium/content/browser/SmartSelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 330,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "This is in OMR1 but it\u0027s a @hide class.",
      "parentUuid": "384d7f4f_783ecdaa",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5923d89a_11393e8b",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionClient.java",
        "patchSetId": 10
      },
      "lineNbr": 161,
      "author": {
        "id": 1115852
      },
      "writtenOn": "2017-10-20T22:55:13Z",
      "side": 1,
      "message": "Any reason this was moved?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3438edb3_015ff2ca",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionClient.java",
        "patchSetId": 10
      },
      "lineNbr": 161,
      "author": {
        "id": 1001168
      },
      "writtenOn": "2017-10-23T10:31:07Z",
      "side": 1,
      "message": "I suppose it\u0027s related to the comment for why this was added:\nThe clang-format tool is confused by the java 8 usage of default in an interface.",
      "parentUuid": "5923d89a_11393e8b",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5d933f1f_3ddd2a1a",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionClient.java",
        "patchSetId": 10
      },
      "lineNbr": 161,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "clang-format was only confused by \"default\" keyword. It works fine with the method below.",
      "parentUuid": "5923d89a_11393e8b",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c8f16c74_65dfda8b",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 17,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "don\u0027t put things into the public interface unless it\u0027s used by a content embedder. and from the look of things, the entire body of this interface is not required, and embedder only really needs to know this opaque type exists?",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a44a2eb8_4a0d08e5",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 19,
      "author": {
        "id": 1002725
      },
      "writtenOn": "2017-10-23T15:08:18Z",
      "side": 1,
      "message": "are these names/values copied from somewhere? If so, write so in a comment",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b1e97986_59a9c97f",
        "filename": "content/public/android/java/src/org/chromium/content_public/browser/SelectionMetricsLogger.java",
        "patchSetId": 10
      },
      "lineNbr": 19,
      "author": {
        "id": 1186107
      },
      "writtenOn": "2017-10-23T19:27:20Z",
      "side": 1,
      "message": "Yes, they are copied from Android.",
      "parentUuid": "a44a2eb8_4a0d08e5",
      "revId": "b63710b714641705d71854e2dd1395446d3c4373",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}