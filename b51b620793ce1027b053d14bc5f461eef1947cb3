{
  "comments": [
    {
      "key": {
        "uuid": "4ab47f74_1427b8c4",
        "filename": "ios/web/navigation/crw_session_controller_unittest.mm",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-07-20T21:43:38Z",
      "side": 1,
      "message": "I would expect from SetNavigationManager to take NavigationManager as an argument. Would it be better to move this code to SetUp?\n\nNot super important, because session_controller will be killed eventually.",
      "range": {
        "startLine": 65,
        "startChar": 7,
        "endLine": 65,
        "endChar": 27
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6d7f026_9cc59247",
        "filename": "ios/web/navigation/crw_session_controller_unittest.mm",
        "patchSetId": 1
      },
      "lineNbr": 65,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-07-20T22:30:12Z",
      "side": 1,
      "message": "A few of the tests set up 2 session controllers to test copy-state so this can\u0027t be inlined in SetUp(). I had tried a couple of alternatives, but didn\u0027t like any of them very much:\n\n1) create navigation manager in each test and pass that to SetNavigationManager() to configure\nThis requires 2 extra lines per test (instead of 1). Also these tests don\u0027t need navigation manager directly, so I didn\u0027t like adding more clutter there.\n\n2) reuse the navigation_manager_ for all session controller instances.\nThis would work for the tests, but is wrong conceptually because navigation manager and session manager should be 1:1. For example, creating NavigationItem destroys the transient URL rewriters. If someone creates a test in the future that has 2 session controllers and exercises the transient URL logic, it may fail mysteriously.\n\nThe practical harm of (2) is probably small (especially that CRWSessionController will be killed eventually). I wouldn\u0027t mind changing to it. WDYT?",
      "parentUuid": "4ab47f74_1427b8c4",
      "range": {
        "startLine": 65,
        "startChar": 7,
        "endLine": 65,
        "endChar": 27
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f35ce63_c6e48171",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-07-20T21:43:38Z",
      "side": 1,
      "message": "nit: s/include/import",
      "range": {
        "startLine": 9,
        "startChar": 1,
        "endLine": 9,
        "endChar": 8
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43dbe694_b9046a02",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-07-20T22:30:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6f35ce63_c6e48171",
      "range": {
        "startLine": 9,
        "startChar": 1,
        "endLine": 9,
        "endChar": 8
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0601ef1c_be9d7cbc",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 76,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-07-20T21:43:38Z",
      "side": 1,
      "message": "Would it be better to make this a class method and pass transient_url_rewriters_ and browser_state_ in the arguments? This will make memory management in tests less challenging.",
      "range": {
        "startLine": 76,
        "startChar": 36,
        "endLine": 76,
        "endChar": 57
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0cce78bd_1363252e",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 76,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-07-20T22:30:12Z",
      "side": 1,
      "message": "If we do that, we\u0027d need to reinstate GetTransientURLRewriters() to expose the transient rewriters to session controller. I feel the memory management in tests is the lesser evil. WDYT?",
      "parentUuid": "0601ef1c_be9d7cbc",
      "range": {
        "startLine": 76,
        "startChar": 36,
        "endLine": 76,
        "endChar": 57
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "33ffb666_3a64c8e6",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 1123009
      },
      "writtenOn": "2017-07-20T21:43:38Z",
      "side": 1,
      "message": "This looks like a change in the logic. Is there a reason for removing all rewriters?",
      "range": {
        "startLine": 109,
        "startChar": 2,
        "endLine": 109,
        "endChar": 29
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "aa3f3202_99380f02",
        "filename": "ios/web/navigation/navigation_manager_impl.mm",
        "patchSetId": 1
      },
      "lineNbr": 109,
      "author": {
        "id": 1190590
      },
      "writtenOn": "2017-07-20T22:30:12Z",
      "side": 1,
      "message": "This is not a change in logic. Before, the session controller calls GetTransientURLRewriters(), in |itemWithURL:|, which transfers ownership of the transient URL rewriters from nav manager to a local variable. This is equivalent to calling RemoveTransientURLRewriters(). See https://cs.chromium.org/chromium/src/ios/web/navigation/crw_session_controller.mm?l\u003d650",
      "parentUuid": "33ffb666_3a64c8e6",
      "range": {
        "startLine": 109,
        "startChar": 2,
        "endLine": 109,
        "endChar": 29
      },
      "revId": "b51b620793ce1027b053d14bc5f461eef1947cb3",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}