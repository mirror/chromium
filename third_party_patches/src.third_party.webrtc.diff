diff --git a/modules/desktop_capture/x11/x_server_pixel_buffer.cc b/modules/desktop_capture/x11/x_server_pixel_buffer.cc
index 26c334eaf..10e208fee 100644
--- a/modules/desktop_capture/x11/x_server_pixel_buffer.cc
+++ b/modules/desktop_capture/x11/x_server_pixel_buffer.cc
@@ -136,6 +136,7 @@ XServerPixelBuffer::~XServerPixelBuffer() {
   Release();
 }
 
+__attribute__((no_sanitize("cfi-icall")))
 void XServerPixelBuffer::Release() {
   if (x_image_) {
     XDestroyImage(x_image_);
diff --git a/pc/externalhmac.cc b/pc/externalhmac.cc
index 34cab08be..25f2fa381 100644
--- a/pc/externalhmac.cc
+++ b/pc/externalhmac.cc
@@ -51,10 +51,10 @@ static const char kExternalHmacDescription[] =
 static const srtp_auth_type_t external_hmac  = {
   external_hmac_alloc,
   external_hmac_dealloc,
-  (srtp_auth_init_func)    external_hmac_init,
-  (srtp_auth_compute_func) external_hmac_compute,
-  (srtp_auth_update_func)  external_hmac_update,
-  (srtp_auth_start_func)   external_hmac_start,
+  external_hmac_init,
+  external_hmac_compute,
+  external_hmac_update,
+  external_hmac_start,
   const_cast<char*>(kExternalHmacDescription),
   const_cast<srtp_auth_test_case_t*>(&kExternalHmacTestCase0),
   EXTERNAL_HMAC_SHA1
@@ -103,30 +103,31 @@ srtp_err_status_t external_hmac_dealloc(srtp_auth_t* a) {
   return srtp_err_status_ok;
 }
 
-srtp_err_status_t external_hmac_init(ExternalHmacContext* state,
+srtp_err_status_t external_hmac_init(void* state_ptr,
                                      const uint8_t* key,
                                      int key_len) {
   if (key_len > HMAC_KEY_LENGTH)
     return srtp_err_status_bad_param;
 
+  auto* state = (ExternalHmacContext *)state_ptr;
   memset(state->key, 0, key_len);
   memcpy(state->key, key, key_len);
   state->key_length = key_len;
   return srtp_err_status_ok;
 }
 
-srtp_err_status_t external_hmac_start(ExternalHmacContext* state) {
+srtp_err_status_t external_hmac_start(void* state) {
   return srtp_err_status_ok;
 }
 
-srtp_err_status_t external_hmac_update(ExternalHmacContext* state,
+srtp_err_status_t external_hmac_update(void* state,
                                        const uint8_t* message,
                                        int msg_octets) {
   return srtp_err_status_ok;
 }
 
-srtp_err_status_t external_hmac_compute(ExternalHmacContext* state,
-                                       const void* message,
+srtp_err_status_t external_hmac_compute(void* state,
+                                       const uint8_t* message,
                                        int msg_octets,
                                        int tag_len,
                                        uint8_t* result) {
diff --git a/pc/externalhmac.h b/pc/externalhmac.h
index 4a6e817af..bf4980bfe 100644
--- a/pc/externalhmac.h
+++ b/pc/externalhmac.h
@@ -49,18 +49,18 @@ srtp_err_status_t external_hmac_alloc(srtp_auth_t** a,
 
 srtp_err_status_t external_hmac_dealloc(srtp_auth_t* a);
 
-srtp_err_status_t external_hmac_init(ExternalHmacContext* state,
+srtp_err_status_t external_hmac_init(void* state,
                                      const uint8_t* key,
                                      int key_len);
 
-srtp_err_status_t external_hmac_start(ExternalHmacContext* state);
+srtp_err_status_t external_hmac_start(void* state);
 
-srtp_err_status_t external_hmac_update(ExternalHmacContext* state,
+srtp_err_status_t external_hmac_update(void* state,
                                        const uint8_t* message,
                                        int msg_octets);
 
-srtp_err_status_t external_hmac_compute(ExternalHmacContext* state,
-                                        const void* message,
+srtp_err_status_t external_hmac_compute(void* state,
+                                        const uint8_t* message,
                                         int msg_octets,
                                         int tag_len,
                                         uint8_t* result);
