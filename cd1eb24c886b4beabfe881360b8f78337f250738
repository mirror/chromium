{
  "comments": [
    {
      "key": {
        "uuid": "a7551cf9_90a81f2c",
        "filename": "components/password_manager/core/browser/export/password_manager_exporter.h",
        "patchSetId": 12
      },
      "lineNbr": 34,
      "author": {
        "id": 1002541
      },
      "writtenOn": "2017-11-29T13:07:19Z",
      "side": 1,
      "message": "The idea expressed in the design doc [1] was to pass the callback with each call of PreparePasswordsForExport rather than on construction. It would then be a OnceCallback which would either get called once and thrown away, or just thrown away (on user cancelling).\n\n\n[1] https://docs.google.com/document/d/1miKr2x0PTNIKgt3RQeur51ICQ66uszlYAmFXJONbG_0/edit#heading\u003dh.mnnwhrv1qaak",
      "range": {
        "startLine": 34,
        "startChar": 6,
        "endLine": 34,
        "endChar": 76
      },
      "revId": "cd1eb24c886b4beabfe881360b8f78337f250738",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1e223e47_a99d049f",
        "filename": "components/password_manager/core/browser/export/password_manager_exporter.h",
        "patchSetId": 12
      },
      "lineNbr": 34,
      "author": {
        "id": 1168044
      },
      "writtenOn": "2017-11-29T13:18:47Z",
      "side": 1,
      "message": "Thanks! I hadn\u0027t noticed that detail in the DD.\n\nI don\u0027t agree with the design. It clearly implies that the callback is for when serialisation is completed, but on desktop we use it for export completion.\n\nI think the callback should be set either on construction or with a third setter SetOnExportCompleted(...). I prefer the constructor.",
      "parentUuid": "a7551cf9_90a81f2c",
      "range": {
        "startLine": 34,
        "startChar": 6,
        "endLine": 34,
        "endChar": 76
      },
      "revId": "cd1eb24c886b4beabfe881360b8f78337f250738",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "166e0a5b_f76db417",
        "filename": "components/password_manager/core/browser/export/password_manager_exporter.h",
        "patchSetId": 12
      },
      "lineNbr": 34,
      "author": {
        "id": 1002541
      },
      "writtenOn": "2017-11-29T13:27:27Z",
      "side": 1,
      "message": "Thanks for bringing this up, we need to clarify this.\n\nMy idea with the design was that actually the callback would become the same on all platforms -- sending the serialised data back to the platform-dependent code. That code would then always take care of writing the data.\n\nThis would mean that PasswordManagerExporter would no longer get a Destination, and there would be no Write call in PasswordManagerExporter::OnPasswordsSerialised. There would also be no Destination interface. PasswordsPrivateDelegateImpl::OnCompletedWritingToDestination would do the writing instead.\n\nThis departure from the original design seemed necessary to me once I realised that the mobile platforms need to postpone writing after the user chose the destination. The callback in its current form is not useful to mobile platforms.",
      "parentUuid": "1e223e47_a99d049f",
      "range": {
        "startLine": 34,
        "startChar": 6,
        "endLine": 34,
        "endChar": 76
      },
      "revId": "cd1eb24c886b4beabfe881360b8f78337f250738",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7edb1f08_79a5109c",
        "filename": "components/password_manager/core/browser/export/password_manager_exporter.h",
        "patchSetId": 12
      },
      "lineNbr": 34,
      "author": {
        "id": 1002541
      },
      "writtenOn": "2017-11-29T13:44:10Z",
      "side": 1,
      "message": "As clarified with Christos offline, what I was after already exists and is called PasswordCSVWriter.\n\nThat means that PasswordManagerExporter is not needed for mobile platforms.\nI don\u0027t see any issues with the current CL, it is a reasonable state of things after the recent design changes.",
      "parentUuid": "166e0a5b_f76db417",
      "range": {
        "startLine": 34,
        "startChar": 6,
        "endLine": 34,
        "endChar": 76
      },
      "revId": "cd1eb24c886b4beabfe881360b8f78337f250738",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}