{
  "comments": [
    {
      "key": {
        "uuid": "8f0efd19_fa5ba6e0",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 243,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "Do we need to check here that |content_type| \u003d\u003d notifications?",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95f8b261_3c2bbf68",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 243,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Yes (oops!). Thanks. Have added a test too.",
      "parentUuid": "8f0efd19_fa5ba6e0",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ef6f0d64_a0e80f7c",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 246,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "nit: drop {}",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f23ff0e3_c0f3e837",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 246,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "ef6f0d64_a0e80f7c",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "64c94b08_2195b3fa",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 256,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "You should verify that it returns TRUE. It\u0027s theoretically possible for outside actors to modify the preferences that belong to a profile, in which case we\u0027d be dealing with invalid data and/or an unparseable string.",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7c757442_ec58cae2",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 256,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "OK, \u0026 just return base::Time() if it\u0027s FALSE? \n\nI copied this from GetTimeStamp in ContentSettingsPref, which doesn\u0027t check the return value: https://cs.chromium.org/chromium/src/components/content_settings/core/browser/content_settings_pref.cc?l\u003d65 So if what you say is true, shouldn\u0027t we should be checking it there too?",
      "parentUuid": "64c94b08_2195b3fa",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3cd725f7_2acffd71",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 256,
      "author": {
        "id": 1183839
      },
      "writtenOn": "2017-06-30T08:24:57Z",
      "side": 1,
      "message": "I didn\u0027t check the return values because I expected that GetStringWithoutPathExpansion will either return a valid number or leave timestamp_str empty if the key doesn\u0027t exist. The second case would result in timestamp\u003d0, so doing a check on GetStringWithoutPathExpansion or StringToInt64 and return base::Time() or not doing the check and returning base::Time(0) would have the same result. Maybe we should create a util function somewhere that properly does all checks and can be used here and in ContentSettingsPref?",
      "parentUuid": "7c757442_ec58cae2",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee916784_b898a6bd",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 256,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-30T13:22:08Z",
      "side": 1,
      "message": "I think the worry is that GetStringWithoutPathExpansion could return an invalid number if something has messed with the preferences.\n\nI\u0027ve put in a check so it returns a null Time if StringToInt64 returns false.",
      "parentUuid": "3cd725f7_2acffd71",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5df275b5_31eb3a57",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 263,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "NULL -\u003e nullptr",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "188b48ee_e25ea785",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 263,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "5df275b5_31eb3a57",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2db2a74c_8029b4b1",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 295,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "nit: DCHECK(prefs_);\n\nThat\u0027d allow us to more easily catch cases where this (somehow) gets called after ShutdownOnUIThread.",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "daf2aa2f_6ea43acd",
        "filename": "chrome/browser/notifications/notification_channels_provider_android.cc",
        "patchSetId": 4
      },
      "lineNbr": 295,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Done. Also added one at the beginning of GetWebsiteSettingLastModified, like in the PrefProvider.",
      "parentUuid": "2db2a74c_8029b4b1",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7da4c831_57de245b",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "This should be part of the test fixture to make sure it continues to be alive for the lifetime of the test (like profile_).",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2f6e2a3f_75d77caa",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 56,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7da4c831_57de245b",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "42e23253_502cbd9d",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "Hmm we don\u0027t usually override methods like this. Can we just always explicitly pass in the clock we need? Is it even significant for the other tests? If it isn\u0027t you could always pass in a SimpleTestClock.",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea241f9f_a157e0d6",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "I was hoping to avoid having to modifying all the pre-existing tests, which the clock is insignificant for, and this seemed to be the cleanest way. But I could change it and have them all pass in a SimpleTestClock if that\u0027s better?",
      "parentUuid": "42e23253_502cbd9d",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "702d9e9a_7622d75a",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 1183839
      },
      "writtenOn": "2017-06-30T08:24:57Z",
      "side": 1,
      "message": "I added a SetClockForTesting() method to ContentSettingsPrefProvider. This way I have a proper clock unless it is explicitly changed",
      "parentUuid": "ea241f9f_a157e0d6",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "08cf856d_273965dc",
        "filename": "chrome/browser/notifications/notification_channels_provider_android_unittest.cc",
        "patchSetId": 4
      },
      "lineNbr": 68,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-30T13:22:08Z",
      "side": 1,
      "message": "I prefer not to add *ForTesting methods to production code if I can help it. Injecting dependencies is one way to avoid it, although I admit here I am only injecting them in the private  constructor only used by tests, which isn\u0027t a lot better.. \n\nMy feeling is that the non-time-sensitive tests read more clearly if they don\u0027t pass in a clock to this method - only initializing it here reduces duplication too. If method overloading is frowned upon Peter I could rename the methods to something more explicit, e.g. InitChannelsProvider \u0026 InitChannelsProviderWithClock ?",
      "parentUuid": "702d9e9a_7622d75a",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bcbc8eef_ab4f50b6",
        "filename": "chrome/browser/prefs/browser_prefs.cc",
        "patchSetId": 4
      },
      "lineNbr": 654,
      "author": {
        "id": 1002032
      },
      "writtenOn": "2017-06-28T17:26:48Z",
      "side": 1,
      "message": "You should check the base::Feature to only register the prefs if it\u0027s necessary. The lifetime of the ScopedFeatureList was probably causing that to fail.",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "cc27f9f1_615810b9",
        "filename": "chrome/browser/prefs/browser_prefs.cc",
        "patchSetId": 4
      },
      "lineNbr": 654,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-29T16:22:03Z",
      "side": 1,
      "message": "Did this but still fails, even with the feature list as a member of the test class :( ???",
      "parentUuid": "bcbc8eef_ab4f50b6",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d3d18335_19b805d2",
        "filename": "chrome/browser/prefs/browser_prefs.cc",
        "patchSetId": 4
      },
      "lineNbr": 654,
      "author": {
        "id": 1183839
      },
      "writtenOn": "2017-06-30T08:24:57Z",
      "side": 1,
      "message": "the featurelist is initialized after the testingprofile. I had the same issue already :D You have to create the profile on the heap \nhttps://cs.chromium.org/chromium/src/chrome/browser/browsing_data/site_settings_counter_unittest.cc?l\u003d25\nA better solution would probably be to add a constructor to scopedfeaturelist that directly takes a list of features that should be enabled.",
      "parentUuid": "cc27f9f1_615810b9",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02db1342_3fac73c8",
        "filename": "chrome/browser/prefs/browser_prefs.cc",
        "patchSetId": 4
      },
      "lineNbr": 654,
      "author": {
        "id": 1187649
      },
      "writtenOn": "2017-06-30T13:22:08Z",
      "side": 1,
      "message": "Initializing it in the test constructor before the profile, rather than in SetUp, seemed to do the trick. Thanks for the example!",
      "parentUuid": "d3d18335_19b805d2",
      "revId": "3b8bbd68a0adfd8efd1c78061c2697165590868e",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}