{
  "comments": [
    {
      "key": {
        "uuid": "8367763a_e10e2d5c",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/ChromeActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1717,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-09-15T00:42:37Z",
      "side": 1,
      "message": "what happens if you have a density change while in VR and then exit VR?  Don\u0027t we need to recreate then as well?",
      "range": {
        "startLine": 1717,
        "startChar": 45,
        "endLine": 1717,
        "endChar": 46
      },
      "revId": "2549b3a8b4f93a8c8fb24e99cffcaef8cf340f23",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c389ba8_5c95863d",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/ChromeActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1717,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-09-15T14:21:45Z",
      "side": 1,
      "message": "I don\u0027t think that\u0027s currently possible, but we could do something like make sure the density is restored to what it was before entering VR when we exit VR. However, onConfigurationChanged will be called asynchronously after we exit VR mode, so we would have to do something gross like a timeout.\n\nI was really hoping you knew of a way to get the java UI to update to the correct density though, so we don\u0027t have to recreate :/",
      "parentUuid": "8367763a_e10e2d5c",
      "range": {
        "startLine": 1717,
        "startChar": 45,
        "endLine": 1717,
        "endChar": 46
      },
      "revId": "2549b3a8b4f93a8c8fb24e99cffcaef8cf340f23",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2aed2957_dc3ba209",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/ChromeActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1717,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-09-16T02:31:54Z",
      "side": 1,
      "message": "Talking with Bo, most vanilla Android widgets might actually handle this ok.  The problem is all of our custom logic that caches DP -\u003e pixel values and assume that doesn\u0027t change would likely break very badly.\n\nI think the case I was worried about isn\u0027t actually likely.  Since we would avoid recreating if we are in VR mode, but when we exit vr mode, the above check would say we\u0027re not in VR and it would recreate.\n\nThe \"hypothetical\" problem would be you enter VR and the density changes, but exiting VR wouldn\u0027t revert to the previous density.  In that case, the java components would be using the original density and be broken.  But in reality, it will change density when entering and exiting so we are ok.",
      "parentUuid": "0c389ba8_5c95863d",
      "range": {
        "startLine": 1717,
        "startChar": 45,
        "endLine": 1717,
        "endChar": 46
      },
      "revId": "2549b3a8b4f93a8c8fb24e99cffcaef8cf340f23",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1db9cc65_b230811e",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/ChromeActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1717,
      "author": {
        "id": 1002411
      },
      "writtenOn": "2017-09-18T20:50:42Z",
      "side": 1,
      "message": "So some of the things that are definitely broken by density changes are the omnibox, New Tab Page, tab switcher, and more. Are you saying this is because of our custom logic somehow?\n\nIf we were to go down the path in the future of properly handling density changes without recreating, what would we actually have to do? Destroy the existing UI and reinflate it?",
      "parentUuid": "2aed2957_dc3ba209",
      "range": {
        "startLine": 1717,
        "startChar": 45,
        "endLine": 1717,
        "endChar": 46
      },
      "revId": "2549b3a8b4f93a8c8fb24e99cffcaef8cf340f23",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fe8ad98d_f4b3de0b",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/ChromeActivity.java",
        "patchSetId": 1
      },
      "lineNbr": 1717,
      "author": {
        "id": 1116043
      },
      "writtenOn": "2017-09-18T21:54:34Z",
      "side": 1,
      "message": "I think any of our custom views would need to override:\nhttps://developer.android.com/reference/android/view/View.html#onConfigurationChanged(android.content.res.Configuration)\n\nWhile I don\u0027t know exactly why things are broken, I could imagine that anything that caches drawables, dimensions, etc... would be broken:\n\nhttps://cs.chromium.org/chromium/src/chrome/android/java/src/org/chromium/chrome/browser/omnibox/LocationBarLayout.java?q\u003dgetDimensionPixelOffset+LocationBarLay\u0026sq\u003dpackage:chromium\u0026l\u003d466\n\nSo I think we\u0027d need to override onConfigurationChange and recalculate all those.",
      "parentUuid": "1db9cc65_b230811e",
      "range": {
        "startLine": 1717,
        "startChar": 45,
        "endLine": 1717,
        "endChar": 46
      },
      "revId": "2549b3a8b4f93a8c8fb24e99cffcaef8cf340f23",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}