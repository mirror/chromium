{
  "comments": [
    {
      "key": {
        "uuid": "b78b5b1e_a1083af8",
        "filename": "chrome/browser/android/vr_shell/vr_shell_gl.cc",
        "patchSetId": 4
      },
      "lineNbr": 1056,
      "author": {
        "id": 1111944
      },
      "writtenOn": "2017-05-24T20:39:35Z",
      "side": 1,
      "message": "I\u0027m probably misreading this, but it seems like this fence should be created up in SubmitWebVRFrame where the finish once was? That more tightly bounds the work that we\u0027re waiting on and gives it a bit of time to complete first, which may also enable you to do the direct call without waiting on the first pass that Bill suggested?",
      "revId": "74c509c3879ec85dfd2b65413a7498fbdfb953e5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c5be4997_02a021f4",
        "filename": "chrome/browser/android/vr_shell/vr_shell_gl.cc",
        "patchSetId": 4
      },
      "lineNbr": 1056,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-05-24T22:48:38Z",
      "side": 1,
      "message": "Moving the fence was intentional - there\u0027s a substantial amount of extra work within DrawFrame inside the current GL context, specifically the extra copy done in DrawWebVR, and this should count as part of the frame\u0027s render time. Running that as unaccounted extra work in parallel with the next frame is part of the problem leading to stale poses / overstuffed buffers, there\u0027s only so much rendering resources to go around. Note that this still excludes GVR\u0027s async work, but that mostly shows as background overhead that\u0027s fairly constant, so it doesn\u0027t seem to interfere too much with timing estimates.\n\nIn the more complex version of this patch I had an additional fence near SubmitWebVRFrame so that it could delay acquiring the GVR frame in DrawFrame until the earlier work was done, to avoid getting blocked in acquire, but that no longer seemed necessary since the new version is less aggressive about submitting frames.",
      "parentUuid": "b78b5b1e_a1083af8",
      "revId": "74c509c3879ec85dfd2b65413a7498fbdfb953e5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "543ebad5_6a07923f",
        "filename": "chrome/browser/android/vr_shell/vr_shell_gl.cc",
        "patchSetId": 4
      },
      "lineNbr": 1074,
      "author": {
        "id": 1000158
      },
      "writtenOn": "2017-05-25T04:12:37Z",
      "side": 1,
      "message": "Why is vrshell_submit_fence_ a member rather than being passed with the bind?",
      "range": {
        "startLine": 1074,
        "startChar": 6,
        "endLine": 1074,
        "endChar": 27
      },
      "revId": "74c509c3879ec85dfd2b65413a7498fbdfb953e5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22eb0fc8_ed9d2724",
        "filename": "chrome/browser/android/vr_shell/vr_shell_gl.cc",
        "patchSetId": 4
      },
      "lineNbr": 1084,
      "author": {
        "id": 1189473
      },
      "writtenOn": "2017-05-25T01:23:06Z",
      "side": 1,
      "message": "is this used?",
      "range": {
        "startLine": 1084,
        "startChar": 18,
        "endLine": 1084,
        "endChar": 30
      },
      "revId": "74c509c3879ec85dfd2b65413a7498fbdfb953e5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ab177606_89a24bd7",
        "filename": "chrome/browser/android/vr_shell/vr_shell_gl.cc",
        "patchSetId": 4
      },
      "lineNbr": 1084,
      "author": {
        "id": 1187745
      },
      "writtenOn": "2017-05-25T01:35:23Z",
      "side": 1,
      "message": "yes, it\u0027s used a few lines below for FPS metrics, it used to get that from DrawFrame above.. I assigned it a bit early to reduce conflicts between the multiple open changes.",
      "parentUuid": "22eb0fc8_ed9d2724",
      "range": {
        "startLine": 1084,
        "startChar": 18,
        "endLine": 1084,
        "endChar": 30
      },
      "revId": "74c509c3879ec85dfd2b65413a7498fbdfb953e5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}