{
  "comments": [
    {
      "key": {
        "uuid": "d1950e61_dccc49ca",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 40,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "Do these two text views ever get set to visible?",
      "range": {
        "startLine": 16,
        "startChar": 0,
        "endLine": 40,
        "endChar": 0
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "91b665e4_c2f31a94",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 40,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "I don\u0027t think so. I removed them.",
      "parentUuid": "d1950e61_dccc49ca",
      "range": {
        "startLine": 16,
        "startChar": 0,
        "endLine": 40,
        "endChar": 0
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "103e4b28_f6b11e29",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 45,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "I don\u0027t think this line is necessary",
      "range": {
        "startLine": 45,
        "startChar": 8,
        "endLine": 45,
        "endChar": 39
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "82ae8d7e_de74b2c3",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 45,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "103e4b28_f6b11e29",
      "range": {
        "startLine": 45,
        "startChar": 8,
        "endLine": 45,
        "endChar": 39
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b6d62434_653b66d0",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 48,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "This should use one of the text styles defined in ui/android/java/res/values-v17/styles.xml. This matches \"WhiteBody\", which can be set with android:textAppearance\u003d\"@style/WhiteBody\"",
      "range": {
        "startLine": 47,
        "startChar": 8,
        "endLine": 48,
        "endChar": 31
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35263a26_c9e9b80a",
        "filename": "chrome/android/java/res/layout/contextual_search_bar_banner_text_view.xml",
        "patchSetId": 9
      },
      "lineNbr": 48,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b6d62434_653b66d0",
      "range": {
        "startLine": 47,
        "startChar": 8,
        "endLine": 48,
        "endChar": 31
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b34bf95d_4a46acbc",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 225,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "I think we can do this in ContextualSearchPanelMetrics using existing functions rather than adding new #isEntityDataShown and #wasTriggedByTap methods to the management delegate interface.\n\nIn ContextualSearchPanelMetrics#onPanelStateChanged() there is a if (isEndingSearch) block we can hook into that knows how the panel was activated, whether it was opened, and whethedr entity data was shown.\n\nMaybe we should move all of the feature engagement notification over to the metrics class...\n\ndonnd@ - what do you think?",
      "range": {
        "startLine": 221,
        "startChar": 12,
        "endLine": 225,
        "endChar": 13
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db5d76ab_6ac05ce8",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 225,
      "author": {
        "id": 1107894
      },
      "writtenOn": "2017-10-26T23:27:52Z",
      "side": 1,
      "message": "That makes sense to me too -- thanks for suggesting that.   Mehran, please give this a try and let us know if you run in to unforeseen issues.",
      "parentUuid": "b34bf95d_4a46acbc",
      "range": {
        "startLine": 221,
        "startChar": 12,
        "endLine": 225,
        "endChar": 13
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "de84f027_8722558f",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 225,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "db5d76ab_6ac05ce8",
      "range": {
        "startLine": 221,
        "startChar": 12,
        "endLine": 225,
        "endChar": 13
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4fd51d4b_d2573683",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 642,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "Since contextual search code uses both DP and PX, let\u0027s document that this is using PX",
      "range": {
        "startLine": 642,
        "startChar": 66,
        "endLine": 642,
        "endChar": 77
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "543e8427_80c9f177",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 642,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4fd51d4b_d2573683",
      "range": {
        "startLine": 642,
        "startChar": 66,
        "endLine": 642,
        "endChar": 77
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "03e28e07_8c4649f6",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 644,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "I think what we really want is the \"bar\" rect, rather than the entire panel since the panel height is dependent on the current panel state. Check out OverlayPanelBase#getBarHeight().",
      "range": {
        "startLine": 644,
        "startChar": 16,
        "endLine": 644,
        "endChar": 28
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "857e809a_d42dc8aa",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/compositor/bottombar/contextualsearch/ContextualSearchPanel.java",
        "patchSetId": 9
      },
      "lineNbr": 644,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "03e28e07_8c4649f6",
      "range": {
        "startLine": 644,
        "startChar": 16,
        "endLine": 644,
        "endChar": 28
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "24444cc7_4acc2e3f",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 71,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "Should we do this check in maybeShow() so that it applies to the bar banner as well?",
      "range": {
        "startLine": 71,
        "startChar": 8,
        "endLine": 71,
        "endChar": 90
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2143a146_3ed181b1",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 71,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "24444cc7_4acc2e3f",
      "range": {
        "startLine": 71,
        "startChar": 8,
        "endLine": 71,
        "endChar": 90
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "78a3454a_37a115b7",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 81,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "Since both bubbles are controlled by the feature engagement backend, it shouldn\u0027t be possible to a help bubble to be showing at this point. I think this block can be removed. If we want to ensure that a CS help bubble isn\u0027t showing, let\u0027s set mHelpBubble \u003d null in the onDismissListener below then assert mHelpBubble \u003d\u003d null here.",
      "range": {
        "startLine": 79,
        "startChar": 8,
        "endLine": 81,
        "endChar": 9
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ac65b58_4bf49862",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 81,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "78a3454a_37a115b7",
      "range": {
        "startLine": 79,
        "startChar": 8,
        "endLine": 81,
        "endChar": 9
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "10d1a115_9786e869",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 85,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "In the C++ code, we draw the panel shadow using negative positioning, and start drawing the bar at position \"0\": https://cs.chromium.org/chromium/src/chrome/browser/android/compositor/layer/overlay_panel_layer.cc?q\u003doverlay_panel_layer\u0026sq\u003dpackage:chromium\u0026dr\u003dC\u0026l\u003d97\n\nI think it\u0027s okay to use an inset for UX purposes, but just wanted to point this out. If the goal is align the bubble with the top edge of the bar, we should be able to figure it out programatically.",
      "range": {
        "startLine": 85,
        "startChar": 24,
        "endLine": 85,
        "endChar": 55
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "247d26cb_d0662db2",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchIPH.java",
        "patchSetId": 9
      },
      "lineNbr": 85,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Thanks for the reference to the C++ code. I think my problem was not the shadow after all. I think ContextualSearchPanel#getPanelRect() is returning the right Rect: It only includes the panel and not its shadow. It seems to me that the bubble will not appear exactly at the top edge of a given Rect, it has some padding.\nDo you know if this is true?",
      "parentUuid": "10d1a115_9786e869",
      "range": {
        "startLine": 85,
        "startChar": 24,
        "endLine": 85,
        "endChar": 55
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3078e850_827b0ca3",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchManager.java",
        "patchSetId": 9
      },
      "lineNbr": 1261,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "I think adding this new method is a bit confusing because this class already knows about and manages panel shows in other methods. Can we hook into #showContextualSearch()?\n\nWe should also figure out the ordering of CONTEXTUAL_SEARCH_FEATURE and CONTEXTUAL_SEARCH_TAP_FEATURE since they both occur after a long-press triggers contextual search. One idea is to let ContextualSearchIPH handle determining which in-product help to show. Instead of simply creating the UI in response to a request, the ContextualSearchIPH class could control which IPH is showing based on some parameters.\n\nAll of the IPH\u0027s are triggered when the panel is showing, so maybe when the panel is shown, we can call ContextualSearchIPH#onPanelShown(boolean wasTriggeredByTap, boolean hasEntityData, ...). Similarly, when the panel is opened/dismissed we could call ContextualSearchIPH methods. We could have 1 ContextualSearchIPH object that lives for the lifetime of the application. Or we could destroy and recreate it every time contextual search is shown/hidden.",
      "range": {
        "startLine": 1256,
        "startChar": 3,
        "endLine": 1261,
        "endChar": 5
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "36fc912a_1c7e52f3",
        "filename": "chrome/android/java/src/org/chromium/chrome/browser/contextualsearch/ContextualSearchManager.java",
        "patchSetId": 9
      },
      "lineNbr": 1261,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "The bubble for CONTEXTUAL_SEARCH_FEATURE should be shown after the panel\u0027s animation is finished and it is shown, so #showContextualSearch() is not the best place for invoking it. Also if ContextualSearchPanel#getPanelRect() is called before it is drawn, OverlayBasePanel#getOffsetY() returns 0 and the bubble is drawn on the top of the page.\nSo the bubble for CONTEXTUAL_SEARCH_FEATURE should be called after the panel is drawn.\n\nAs for CONTEXTUAL_SEARCH_TAP_FEATURE, the decision for showing it should be made before ContextualSearchPanel#requestPanelShow() is called, because the UI for this feature is the Bar Banner and it\u0027s part of the panel.\n\nAnd CONTEXTUAL_SEARCH_PANEL_FEATURE should be shown only after entity data is received, which could take a while after the panel is shown.\n\nI like the idea of moving these to ContextualSearchIPH, but I think I should create other methods as well as ContextualSearchIPH#onPanelShow, like ContextualSearchIPH#beforePanelShow (for Bar Banner) and ContextualSearchIPH#onEntityDataReceived. Does that make sense?",
      "parentUuid": "3078e850_827b0ca3",
      "range": {
        "startLine": 1256,
        "startChar": 3,
        "endLine": 1261,
        "endChar": 5
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f9e0f80_acf2b87d",
        "filename": "chrome/android/java/strings/android_chrome_strings.grd",
        "patchSetId": 9
      },
      "lineNbr": 2853,
      "author": {
        "id": 1122966
      },
      "writtenOn": "2017-10-26T23:20:23Z",
      "side": 1,
      "message": "Since these strings aren\u0027t final yet, please add a note to the end of the description saying something like \"This is a placeholder while the string is being finalized. Do not translate for now.\"",
      "range": {
        "startLine": 2853,
        "startChar": 61,
        "endLine": 2853,
        "endChar": 201
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2ccf810a_cc2ea667",
        "filename": "chrome/android/java/strings/android_chrome_strings.grd",
        "patchSetId": 9
      },
      "lineNbr": 2853,
      "author": {
        "id": 1244576
      },
      "writtenOn": "2017-10-28T00:09:18Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "6f9e0f80_acf2b87d",
      "range": {
        "startLine": 2853,
        "startChar": 61,
        "endLine": 2853,
        "endChar": 201
      },
      "revId": "9c845157680f65ed9f2fedb834080d0852a852a5",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}