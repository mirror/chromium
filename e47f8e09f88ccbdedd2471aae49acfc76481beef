{
  "comments": [
    {
      "key": {
        "uuid": "84ac2d20_43d21c14",
        "filename": "content/browser/download/download_item_impl.cc",
        "patchSetId": 1
      },
      "lineNbr": 1509,
      "author": {
        "id": 1002532
      },
      "writtenOn": "2017-11-10T19:17:38Z",
      "side": 1,
      "message": "this change was needed because in DownloadViaHTML5FileApiWithUserGesture and DownloadViaHTML5FileApiWithoutUserGesture tests, the object is cancelled in the test suite teardown and then this callback is run after. i.e. specifically:\n\n\u003e\tcontent.dll!content::DownloadItemImpl::InterruptWithPartialState(__int64 bytes_so_far, std::unique_ptr\u003ccrypto::SecureHash,std::default_delete\u003ccrypto::SecureHash\u003e \u003e hash_state, content::DownloadInterruptReason reason) Line 1937\n \tcontent.dll!content::DownloadItemImpl::InterruptAndDiscardPartialState(content::DownloadInterruptReason reason) Line 1807\n \tcontent.dll!content::DownloadItemImpl::Cancel(bool user_cancel) Line 589\n \tbrowser_tests.exe!safe_browsing::SBNavigationObserverBrowserTest::CancelDownloads() Line 232\n \tbrowser_tests.exe!safe_browsing::SBNavigationObserverBrowserTest::TearDownOnMainThread() Line 219",
      "revId": "e47f8e09f88ccbdedd2471aae49acfc76481beef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7d2aa2de_17dfee89",
        "filename": "content/browser/download/download_item_impl.cc",
        "patchSetId": 1
      },
      "lineNbr": 1509,
      "author": {
        "id": 1116010
      },
      "writtenOn": "2017-11-10T22:28:32Z",
      "side": 1,
      "message": "This is against the current DownloadItemImpl state machine.\nThis callback is scheduled when state_ \u003d\u003d TARGET_PENDING_INTERNAL || state_ \u003d\u003d INTERRUPTED_TARGET_PENDING_INTERNAL.\nAnd in DownloadItemImpl::InterruptWithPartialState(), if the state_ is the above 2 conditions, we set the state_ to INTERRUPTED_TARGET_PENDING_INTERNAL.  So it is wierd that the state_ will be CANCELLED_INTERNAL here",
      "parentUuid": "84ac2d20_43d21c14",
      "revId": "e47f8e09f88ccbdedd2471aae49acfc76481beef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1f1145c6_8ca5056c",
        "filename": "content/browser/download/download_item_impl.cc",
        "patchSetId": 1
      },
      "lineNbr": 1509,
      "author": {
        "id": 1116010
      },
      "writtenOn": "2017-11-10T22:32:11Z",
      "side": 1,
      "message": "\"If the download is cancelled while the state_ is the above 2 conditions\"",
      "parentUuid": "7d2aa2de_17dfee89",
      "revId": "e47f8e09f88ccbdedd2471aae49acfc76481beef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "afe80d07_62c57504",
        "filename": "content/browser/download/download_item_impl.cc",
        "patchSetId": 1
      },
      "lineNbr": 1509,
      "author": {
        "id": 1002532
      },
      "writtenOn": "2017-11-10T22:43:22Z",
      "side": 1,
      "message": "The TransitionTo(INTERRUPTED_TARGET_PENDING_INTERNAL) call you mention is only taken in the \"if (!IsCancellation(reason))\" case. However in the callstack above, reason\u003dDOWNLOAD_INTERRUPT_REASON_USER_CANCELED so it\u0027s not taken. Instead \"TransitionTo(CANCELLED_INTERNAL)\" is called.",
      "parentUuid": "7d2aa2de_17dfee89",
      "revId": "e47f8e09f88ccbdedd2471aae49acfc76481beef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "88d7e1e1_a9a19474",
        "filename": "content/browser/download/download_item_impl.cc",
        "patchSetId": 1
      },
      "lineNbr": 1509,
      "author": {
        "id": 1116010
      },
      "writtenOn": "2017-11-10T22:49:10Z",
      "side": 1,
      "message": "Ah, i see. interestingly we never hit this case in the past on all bots and builds",
      "parentUuid": "afe80d07_62c57504",
      "revId": "e47f8e09f88ccbdedd2471aae49acfc76481beef",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}