{
  "comments": [
    {
      "key": {
        "uuid": "661ed611_940c2e0d",
        "filename": "content/browser/frame_host/render_frame_host_impl_browsertest.cc",
        "patchSetId": 14
      },
      "lineNbr": 1057,
      "author": {
        "id": 1003152
      },
      "writtenOn": "2017-10-27T21:02:29Z",
      "side": 1,
      "message": "Will this accurately synthesize the real world situation where GetInterface would as close as possible after DidCommitProvisionalLoad? \n\nI wonder if we are still sending the GetInterface message too late, and maybe we should have it posted to the MessageLoop just before we synchronously invoke DidCommitProvisionalLoad?",
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "85c2022f_2a6f1b88",
        "filename": "content/browser/frame_host/render_frame_host_impl_browsertest.cc",
        "patchSetId": 14
      },
      "lineNbr": 1057,
      "author": {
        "id": 1001500
      },
      "writtenOn": "2017-10-31T23:10:02Z",
      "side": 1,
      "message": "Posting it to the message loop will allow potentially other messages to be processed before the GetInterface one, right? I think that is less desirable as we want to simulate it coming as the first possible message after commit. Given that DidFinishNavigation is called on the same event loop with DidCommitProvisionalLoad, but after it has been processed, it does seem closer to what we want than using a PostTask, doesn\u0027t it?",
      "parentUuid": "661ed611_940c2e0d",
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4572b982_2264cb9b",
        "filename": "content/browser/frame_host/render_frame_host_impl_browsertest.cc",
        "patchSetId": 14
      },
      "lineNbr": 1057,
      "author": {
        "id": 1003152
      },
      "writtenOn": "2017-11-01T12:49:50Z",
      "side": 1,
      "message": "Correct.\n\nStill, I\u0027m not a big fan of having to rely on such lengthy explanations to ensure the test actually verifies that no race conditions exist.\n\nOne thing I can think of to make this test more bulletproof is to actually invoke the closure below, synchronously, just before DCPL, instead of Post\u0027ing it.\n\nI think old_interface_provider-\u003eGetInterface() always PostTasks some Watcher task to do the actual dispatch. If that\u0027s true, having a pending dispatch of an interface request in the message loop when DCPL is executed is probably the closest it can get.",
      "parentUuid": "85c2022f_2a6f1b88",
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "79eef553_ebed2c88",
        "filename": "content/browser/frame_host/render_frame_host_impl_browsertest.cc",
        "patchSetId": 14
      },
      "lineNbr": 1057,
      "author": {
        "id": 1001500
      },
      "writtenOn": "2017-11-01T20:34:28Z",
      "side": 1,
      "message": "Relying on the implementation of GetInterface being done through PostTask seems like recipe for problems if it changes. WebContentsObserver::DidFinishNavigation is called in the same event loop as DCPL right after we have processed it, so this IMHO is the closest we can get to simulating GetInterface arriving as early as possible without relying on the internal implementation of GetInterface.",
      "parentUuid": "4572b982_2264cb9b",
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b2d7a930_0400e271",
        "filename": "content/browser/frame_host/render_frame_host_impl_browsertest.cc",
        "patchSetId": 14
      },
      "lineNbr": 1057,
      "author": {
        "id": 1003152
      },
      "writtenOn": "2017-11-06T19:03:35Z",
      "side": 1,
      "message": "Agreed, and offline discussion on chromium-mojo@ confirms that.",
      "parentUuid": "79eef553_ebed2c88",
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bbd970e6_ff37c8a1",
        "filename": "content/browser/frame_host/render_frame_host_interface_provider_unittest.cc",
        "patchSetId": 14
      },
      "lineNbr": 199,
      "author": {
        "id": 1003152
      },
      "writtenOn": "2017-10-27T21:05:18Z",
      "side": 1,
      "message": "Note that these are basically the same as the browser tests, but uglier and probably provide fewer guarantees. I wonder if it makes sense to keep these?",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 199,
        "endChar": 1
      },
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4b5de15a_2ae29273",
        "filename": "content/browser/frame_host/render_frame_host_interface_provider_unittest.cc",
        "patchSetId": 14
      },
      "lineNbr": 199,
      "author": {
        "id": 1001500
      },
      "writtenOn": "2017-10-31T23:10:02Z",
      "side": 1,
      "message": "I always prefer browser tests, as they are much closer to reality than unit tests, even when we mess with ordering of messages :).",
      "parentUuid": "bbd970e6_ff37c8a1",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 199,
        "endChar": 1
      },
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "10caee20_05312871",
        "filename": "content/browser/frame_host/render_frame_host_interface_provider_unittest.cc",
        "patchSetId": 14
      },
      "lineNbr": 199,
      "author": {
        "id": 1003152
      },
      "writtenOn": "2017-11-01T12:49:50Z",
      "side": 1,
      "message": "Agreed, deleted the unit test.",
      "parentUuid": "4b5de15a_2ae29273",
      "range": {
        "startLine": 138,
        "startChar": 0,
        "endLine": 199,
        "endChar": 1
      },
      "revId": "967634b696d6edf815ad9356f638a400e6b972c4",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}